import v from"buffer";var p=typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:global;var y={};var S=v.Buffer;var E={};E.userAgent=false;var F={};var C="11.1.0";var B="jsrsasign(all) 11.1.0 (2024-02-01) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license";var D=D||function(v,y){var S={};var E=S.lib={};var F=E.Base=function(){function n(){}return{extend:function(v){n.prototype=this||p;var y=new n;v&&y.mixIn(v);y.hasOwnProperty("init")||(y.init=function(){y.$super.init.apply(this||p,arguments)});y.init.prototype=y;y.$super=this||p;return y},create:function(){var v=this.extend();v.init.apply(v,arguments);return v},init:function(){},mixIn:function(v){for(var y in v)v.hasOwnProperty(y)&&((this||p)[y]=v[y]);v.hasOwnProperty("toString")&&((this||p).toString=v.toString)},clone:function(){return(this||p).init.prototype.extend(this||p)}}}();var C=E.WordArray=F.extend({init:function(v,S){v=(this||p).words=v||[];(this||p).sigBytes=S!=y?S:v.length*4},toString:function(v){return(v||D).stringify(this||p)},concat:function(v){var y=(this||p).words;var S=v.words;var E=(this||p).sigBytes;var F=v.sigBytes;this.clamp();if(E%4)for(var C=0;C<F;C++){var B=S[C>>>2]>>>24-C%4*8&255;y[E+C>>>2]|=B<<24-(E+C)%4*8}else for(C=0;C<F;C+=4)y[E+C>>>2]=S[C>>>2];(this||p).sigBytes+=F;return this||p},clamp:function(){var y=(this||p).words;var S=(this||p).sigBytes;y[S>>>2]&=4294967295<<32-S%4*8;y.length=v.ceil(S/4)},clone:function(){var v=F.clone.call(this||p);v.words=(this||p).words.slice(0);return v},random:function(p){var y=[];for(var S=0;S<p;S+=4)y.push(v.random()*4294967296|0);return new C.init(y,p)}});var B=S.enc={};var D=B.Hex={stringify:function(v){var p=v.words;var y=v.sigBytes;var S=[];for(var E=0;E<y;E++){var F=p[E>>>2]>>>24-E%4*8&255;S.push((F>>>4).toString(16));S.push((F&15).toString(16))}return S.join("")},parse:function(v){var p=v.length;var y=[];for(var S=0;S<p;S+=2)y[S>>>3]|=parseInt(v.substr(S,2),16)<<24-S%8*4;return new C.init(y,p/2)}};var P=B.Latin1={stringify:function(v){var p=v.words;var y=v.sigBytes;var S=[];for(var E=0;E<y;E++){var F=p[E>>>2]>>>24-E%4*8&255;S.push(String.fromCharCode(F))}return S.join("")},parse:function(v){var p=v.length;var y=[];for(var S=0;S<p;S++)y[S>>>2]|=(v.charCodeAt(S)&255)<<24-S%4*8;return new C.init(y,p)}};var R=B.Utf8={stringify:function(v){try{return decodeURIComponent(escape(P.stringify(v)))}catch(v){throw new Error("Malformed UTF-8 data")}},parse:function(v){return P.parse(unescape(encodeURIComponent(v)))}};var T=E.BufferedBlockAlgorithm=F.extend({reset:function(){(this||p)._data=new C.init;(this||p)._nDataBytes=0},_append:function(v){typeof v=="string"&&(v=R.parse(v));(this||p)._data.concat(v);(this||p)._nDataBytes+=v.sigBytes},_process:function(y){var S=(this||p)._data;var E=S.words;var F=S.sigBytes;var B=(this||p).blockSize;var D=B*4;var P=F/D;P=y?v.ceil(P):v.max((P|0)-(this||p)._minBufferSize,0);var R=P*B;var T=v.min(R*4,F);if(R){for(var N=0;N<R;N+=B)this._doProcessBlock(E,N);var O=E.splice(0,R);S.sigBytes-=T}return new C.init(O,T)},clone:function(){var v=F.clone.call(this||p);v._data=(this||p)._data.clone();return v},_minBufferSize:0});E.Hasher=T.extend({cfg:F.extend(),init:function(v){(this||p).cfg=(this||p).cfg.extend(v);this.reset()},reset:function(){T.reset.call(this||p);this._doReset()},update:function(v){this._append(v);this._process();return this||p},finalize:function(v){v&&this._append(v);var p=this._doFinalize();return p},blockSize:16,_createHelper:function(v){return function(p,y){return new v.init(y).finalize(p)}},_createHmacHelper:function(v){return function(p,y){return new N.HMAC.init(v,y).finalize(p)}}});var N=S.algo={};return S}(Math);(function(v){var y=D,S=y.lib,E=S.Base,F=S.WordArray;y=y.x64={};y.Word=E.extend({init:function(v,y){(this||p).high=v;(this||p).low=y}});y.WordArray=E.extend({init:function(y,S){y=(this||p).words=y||[];(this||p).sigBytes=S!=v?S:8*y.length},toX32:function(){for(var v=(this||p).words,y=v.length,S=[],E=0;E<y;E++){var C=v[E];S.push(C.high);S.push(C.low)}return F.create(S,(this||p).sigBytes)},clone:function(){for(var v=E.clone.call(this||p),y=v.words=(this||p).words.slice(0),S=y.length,F=0;F<S;F++)y[F]=y[F].clone();return v}})})();D.lib.Cipher||function(v){var y=D,S=y.lib,E=S.Base,F=S.WordArray,C=S.BufferedBlockAlgorithm,B=y.enc.Base64,P=y.algo.EvpKDF,R=S.Cipher=C.extend({cfg:E.extend(),createEncryptor:function(v,y){return this.create((this||p)._ENC_XFORM_MODE,v,y)},createDecryptor:function(v,y){return this.create((this||p)._DEC_XFORM_MODE,v,y)},init:function(v,y,S){(this||p).cfg=(this||p).cfg.extend(S);(this||p)._xformMode=v;(this||p)._key=y;this.reset()},reset:function(){C.reset.call(this||p);this._doReset()},process:function(v){this._append(v);return this._process()},finalize:function(v){v&&this._append(v);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(v){return{encrypt:function(p,y,S){return("string"==typeof y?L:V).encrypt(v,p,y,S)},decrypt:function(p,y,S){return("string"==typeof y?L:V).decrypt(v,p,y,S)}}}});S.StreamCipher=R.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var T=y.mode={},t=function(y,S,E){var F=(this||p)._iv;F?(this||p)._iv=v:F=(this||p)._prevBlock;for(var C=0;C<E;C++)y[S+C]^=F[C]},N=(S.BlockCipherMode=E.extend({createEncryptor:function(v,y){return(this||p).Encryptor.create(v,y)},createDecryptor:function(v,y){return(this||p).Decryptor.create(v,y)},init:function(v,y){(this||p)._cipher=v;(this||p)._iv=y}})).extend();N.Encryptor=N.extend({processBlock:function(v,y){var S=(this||p)._cipher,E=S.blockSize;t.call(this||p,v,y,E);S.encryptBlock(v,y);(this||p)._prevBlock=v.slice(y,y+E)}});N.Decryptor=N.extend({processBlock:function(v,y){var S=(this||p)._cipher,E=S.blockSize,F=v.slice(y,y+E);S.decryptBlock(v,y);t.call(this||p,v,y,E);(this||p)._prevBlock=F}});T=T.CBC=N;N=(y.pad={}).Pkcs7={pad:function(v,p){for(var y=4*p,S=(y=y-v.sigBytes%y,y<<24|y<<16|y<<8|y),E=[],C=0;C<y;C+=4)E.push(S);y=F.create(E,y);v.concat(y)},unpad:function(v){v.sigBytes-=v.words[v.sigBytes-1>>>2]&255}};S.BlockCipher=R.extend({cfg:R.cfg.extend({mode:T,padding:N}),reset:function(){R.reset.call(this||p);var v=(this||p).cfg,y=v.iv;v=v.mode;if((this||p)._xformMode==(this||p)._ENC_XFORM_MODE)var S=v.createEncryptor;else S=v.createDecryptor,(this||p)._minBufferSize=1;(this||p)._mode=S.call(v,this||p,y&&y.words)},_doProcessBlock:function(v,y){(this||p)._mode.processBlock(v,y)},_doFinalize:function(){var v=(this||p).cfg.padding;if((this||p)._xformMode==(this||p)._ENC_XFORM_MODE){v.pad((this||p)._data,(this||p).blockSize);var y=this._process(!0)}else y=this._process(!0),v.unpad(y);return y},blockSize:4});var O=S.CipherParams=E.extend({init:function(v){this.mixIn(v)},toString:function(v){return(v||(this||p).formatter).stringify(this||p)}}),V=(T=(y.format={}).OpenSSL={stringify:function(v){var p=v.ciphertext;v=v.salt;return(v?F.create([1398893684,1701076831]).concat(v).concat(p):p).toString(B)},parse:function(v){v=B.parse(v);var p=v.words;if(1398893684==p[0]&&1701076831==p[1]){var y=F.create(p.slice(2,4));p.splice(0,4);v.sigBytes-=16}return O.create({ciphertext:v,salt:y})}},S.SerializableCipher=E.extend({cfg:E.extend({format:T}),encrypt:function(v,y,S,E){E=(this||p).cfg.extend(E);var F=v.createEncryptor(S,E);y=F.finalize(y);F=F.cfg;return O.create({ciphertext:y,key:S,iv:F.iv,algorithm:v,mode:F.mode,padding:F.padding,blockSize:v.blockSize,formatter:E.format})},decrypt:function(v,y,S,E){E=(this||p).cfg.extend(E);y=this._parse(y,E.format);return v.createDecryptor(S,E).finalize(y.ciphertext)},_parse:function(v,y){return"string"==typeof v?y.parse(v,this||p):v}})),L=(y=(y.kdf={}).OpenSSL={execute:function(v,p,y,S){S||(S=F.random(8));v=P.create({keySize:p+y}).compute(v,S);y=F.create(v.words.slice(p),4*y);v.sigBytes=4*p;return O.create({key:v,iv:y,salt:S})}},S.PasswordBasedCipher=V.extend({cfg:V.cfg.extend({kdf:y}),encrypt:function(v,y,S,E){E=(this||p).cfg.extend(E);S=E.kdf.execute(S,v.keySize,v.ivSize);E.iv=S.iv;v=V.encrypt.call(this||p,v,y,S.key,E);v.mixIn(S);return v},decrypt:function(v,y,S,E){E=(this||p).cfg.extend(E);y=this._parse(y,E.format);S=E.kdf.execute(S,v.keySize,v.ivSize,y.salt);E.iv=S.iv;return V.decrypt.call(this||p,v,y,S.key,E)}}))}();(function(){for(var v=D,y=v.lib.BlockCipher,S=v.algo,E=[],F=[],C=[],B=[],P=[],R=[],T=[],N=[],O=[],V=[],L=[],M=0;256>M;M++)L[M]=128>M?M<<1:M<<1^283;var _=0,U=0;for(M=0;256>M;M++){var G=U^U<<1^U<<2^U<<3^U<<4;G=G>>>8^G&255^99;E[_]=G;F[G]=_;var X=L[_],W=L[X],J=L[W],$=257*L[G]^16843008*G;C[_]=$<<24|$>>>8;B[_]=$<<16|$>>>16;P[_]=$<<8|$>>>24;R[_]=$;$=16843009*J^65537*W^257*X^16843008*_;T[G]=$<<24|$>>>8;N[G]=$<<16|$>>>16;O[G]=$<<8|$>>>24;V[G]=$;_?(_=X^L[L[L[J^X]]],U^=L[L[U]]):_=U=1}var Y=[0,1,2,4,8,16,32,64,128,27,54];S=S.AES=y.extend({_doReset:function(){for(var v=(this||p)._key,y=v.words,S=v.sigBytes/4,F=(v=4*(((this||p)._nRounds=S+6)+1),(this||p)._keySchedule=[]),C=0;C<v;C++)if(C<S)F[C]=y[C];else{var B=F[C-1];C%S?6<S&&4==C%S&&(B=E[B>>>24]<<24|E[B>>>16&255]<<16|E[B>>>8&255]<<8|E[B&255]):(B=B<<8|B>>>24,B=E[B>>>24]<<24|E[B>>>16&255]<<16|E[B>>>8&255]<<8|E[B&255],B^=Y[C/S|0]<<24);F[C]=F[C-S]^B}y=(this||p)._invKeySchedule=[];for(S=0;S<v;S++)C=v-S,B=S%4?F[C]:F[C-4],y[S]=4>S||4>=C?B:T[E[B>>>24]]^N[E[B>>>16&255]]^O[E[B>>>8&255]]^V[E[B&255]]},encryptBlock:function(v,y){this._doCryptBlock(v,y,(this||p)._keySchedule,C,B,P,R,E)},decryptBlock:function(v,y){var S=v[y+1];v[y+1]=v[y+3];v[y+3]=S;this._doCryptBlock(v,y,(this||p)._invKeySchedule,T,N,O,V,F);S=v[y+1];v[y+1]=v[y+3];v[y+3]=S},_doCryptBlock:function(v,y,S,E,F,C,B,D){for(var P=(this||p)._nRounds,R=v[y]^S[0],T=v[y+1]^S[1],N=v[y+2]^S[2],O=v[y+3]^S[3],V=4,L=1;L<P;L++){var M=E[R>>>24]^F[T>>>16&255]^C[N>>>8&255]^B[O&255]^S[V++],_=E[T>>>24]^F[N>>>16&255]^C[O>>>8&255]^B[R&255]^S[V++],U=E[N>>>24]^F[O>>>16&255]^C[R>>>8&255]^B[T&255]^S[V++];O=E[O>>>24]^F[R>>>16&255]^C[T>>>8&255]^B[N&255]^S[V++],R=M,T=_,N=U}M=(D[R>>>24]<<24|D[T>>>16&255]<<16|D[N>>>8&255]<<8|D[O&255])^S[V++];_=(D[T>>>24]<<24|D[N>>>16&255]<<16|D[O>>>8&255]<<8|D[R&255])^S[V++];U=(D[N>>>24]<<24|D[O>>>16&255]<<16|D[R>>>8&255]<<8|D[T&255])^S[V++];O=(D[O>>>24]<<24|D[R>>>16&255]<<16|D[T>>>8&255]<<8|D[N&255])^S[V++];v[y]=M;v[y+1]=_;v[y+2]=U;v[y+3]=O},keySize:8});v.AES=y._createHelper(S)})();(function(){function j(v,y){var S=((this||p)._lBlock>>>v^(this||p)._rBlock)&y;(this||p)._rBlock^=S;(this||p)._lBlock^=S<<v}function l(v,y){var S=((this||p)._rBlock>>>v^(this||p)._lBlock)&y;(this||p)._lBlock^=S;(this||p)._rBlock^=S<<v}var v=D,y=v.lib,S=y.WordArray,E=(y=y.BlockCipher,v.algo),F=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],C=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],B=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],P=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],R=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],T=E.DES=y.extend({_doReset:function(){for(var v=(this||p)._key.words,y=[],S=0;56>S;S++){var E=F[S]-1;y[S]=v[E>>>5]>>>31-E%32&1}v=(this||p)._subKeys=[];for(E=0;16>E;E++){var D=v[E]=[],P=B[E];for(S=0;24>S;S++)D[S/6|0]|=y[(C[S]-1+P)%28]<<31-S%6,D[4+(S/6|0)]|=y[28+(C[S+24]-1+P)%28]<<31-S%6;D[0]=D[0]<<1|D[0]>>>31;for(S=1;7>S;S++)D[S]>>>=4*(S-1)+3;D[7]=D[7]<<5|D[7]>>>27}y=(this||p)._invSubKeys=[];for(S=0;16>S;S++)y[S]=v[15-S]},encryptBlock:function(v,y){this._doCryptBlock(v,y,(this||p)._subKeys)},decryptBlock:function(v,y){this._doCryptBlock(v,y,(this||p)._invSubKeys)},_doCryptBlock:function(v,y,S){(this||p)._lBlock=v[y];(this||p)._rBlock=v[y+1];j.call(this||p,4,252645135);j.call(this||p,16,65535);l.call(this||p,2,858993459);l.call(this||p,8,16711935);j.call(this||p,1,1431655765);for(var E=0;16>E;E++){for(var F=S[E],C=(this||p)._lBlock,B=(this||p)._rBlock,D=0,T=0;8>T;T++)D|=P[T][((B^F[T])&R[T])>>>0];(this||p)._lBlock=B;(this||p)._rBlock=C^D}S=(this||p)._lBlock;(this||p)._lBlock=(this||p)._rBlock;(this||p)._rBlock=S;j.call(this||p,1,1431655765);l.call(this||p,8,16711935);l.call(this||p,2,858993459);j.call(this||p,16,65535);j.call(this||p,4,252645135);v[y]=(this||p)._lBlock;v[y+1]=(this||p)._rBlock},keySize:2,ivSize:2,blockSize:2});v.DES=y._createHelper(T);E=E.TripleDES=y.extend({_doReset:function(){var v=(this||p)._key.words;(this||p)._des1=T.createEncryptor(S.create(v.slice(0,2)));(this||p)._des2=T.createEncryptor(S.create(v.slice(2,4)));(this||p)._des3=T.createEncryptor(S.create(v.slice(4,6)))},encryptBlock:function(v,y){(this||p)._des1.encryptBlock(v,y);(this||p)._des2.decryptBlock(v,y);(this||p)._des3.encryptBlock(v,y)},decryptBlock:function(v,y){(this||p)._des3.decryptBlock(v,y);(this||p)._des2.encryptBlock(v,y);(this||p)._des1.decryptBlock(v,y)},keySize:6,ivSize:2,blockSize:2});v.TripleDES=y._createHelper(E)})();(function(){var v=D,y=v.lib.WordArray;v.enc.Base64={stringify:function(v){var y=v.words,S=v.sigBytes,E=(this||p)._map;v.clamp();v=[];for(var F=0;F<S;F+=3)for(var C=(y[F>>>2]>>>24-F%4*8&255)<<16|(y[F+1>>>2]>>>24-(F+1)%4*8&255)<<8|y[F+2>>>2]>>>24-(F+2)%4*8&255,B=0;4>B&&F+.75*B<S;B++)v.push(E.charAt(C>>>6*(3-B)&63));if(y=E.charAt(64))for(;v.length%4;)v.push(y);return v.join("")},parse:function(v){var S=v.length,E=(this||p)._map,F=E.charAt(64);F&&(F=v.indexOf(F),-1!=F&&(S=F));F=[];for(var C=0,B=0;B<S;B++)if(B%4){var D=E.indexOf(v.charAt(B-1))<<B%4*2,P=E.indexOf(v.charAt(B))>>>6-B%4*2;F[C>>>2]|=(D|P)<<24-C%4*8;C++}return y.create(F,C)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(v){function h(v,p,y,S,E,F,C){v=v+(p&y|~p&S)+E+C;return(v<<F|v>>>32-F)+p}function k(v,p,y,S,E,F,C){v=v+(p&S|y&~S)+E+C;return(v<<F|v>>>32-F)+p}function l(v,p,y,S,E,F,C){v=v+(p^y^S)+E+C;return(v<<F|v>>>32-F)+p}function n(v,p,y,S,E,F,C){v=v+(y^(p|~S))+E+C;return(v<<F|v>>>32-F)+p}for(var y=D,S=y.lib,E=S.WordArray,F=S.Hasher,C=(S=y.algo,[]),B=0;64>B;B++)C[B]=4294967296*v.abs(v.sin(B+1))|0;S=S.MD5=F.extend({_doReset:function(){(this||p)._hash=new E.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(v,y){for(var S=0;16>S;S++){var E=y+S,F=v[E];v[E]=16711935&(F<<8|F>>>24)|4278255360&(F<<24|F>>>8)}S=(this||p)._hash.words,E=v[y+0],F=v[y+1];var B=v[y+2],D=v[y+3],P=v[y+4],R=v[y+5],T=v[y+6],N=v[y+7],O=v[y+8],V=v[y+9],L=v[y+10],M=v[y+11],_=v[y+12],U=v[y+13],G=v[y+14],X=v[y+15],W=S[0],J=S[1],$=S[2],Y=S[3];W=h(W,J,$,Y,E,7,C[0]),Y=h(Y,W,J,$,F,12,C[1]),$=h($,Y,W,J,B,17,C[2]),J=h(J,$,Y,W,D,22,C[3]),W=h(W,J,$,Y,P,7,C[4]),Y=h(Y,W,J,$,R,12,C[5]),$=h($,Y,W,J,T,17,C[6]),J=h(J,$,Y,W,N,22,C[7]),W=h(W,J,$,Y,O,7,C[8]),Y=h(Y,W,J,$,V,12,C[9]),$=h($,Y,W,J,L,17,C[10]),J=h(J,$,Y,W,M,22,C[11]),W=h(W,J,$,Y,_,7,C[12]),Y=h(Y,W,J,$,U,12,C[13]),$=h($,Y,W,J,G,17,C[14]),J=h(J,$,Y,W,X,22,C[15]),W=k(W,J,$,Y,F,5,C[16]),Y=k(Y,W,J,$,T,9,C[17]),$=k($,Y,W,J,M,14,C[18]),J=k(J,$,Y,W,E,20,C[19]),W=k(W,J,$,Y,R,5,C[20]),Y=k(Y,W,J,$,L,9,C[21]),$=k($,Y,W,J,X,14,C[22]),J=k(J,$,Y,W,P,20,C[23]),W=k(W,J,$,Y,V,5,C[24]),Y=k(Y,W,J,$,G,9,C[25]),$=k($,Y,W,J,D,14,C[26]),J=k(J,$,Y,W,O,20,C[27]),W=k(W,J,$,Y,U,5,C[28]),Y=k(Y,W,J,$,B,9,C[29]),$=k($,Y,W,J,N,14,C[30]),J=k(J,$,Y,W,_,20,C[31]),W=l(W,J,$,Y,R,4,C[32]),Y=l(Y,W,J,$,O,11,C[33]),$=l($,Y,W,J,M,16,C[34]),J=l(J,$,Y,W,G,23,C[35]),W=l(W,J,$,Y,F,4,C[36]),Y=l(Y,W,J,$,P,11,C[37]),$=l($,Y,W,J,N,16,C[38]),J=l(J,$,Y,W,L,23,C[39]),W=l(W,J,$,Y,U,4,C[40]),Y=l(Y,W,J,$,E,11,C[41]),$=l($,Y,W,J,D,16,C[42]),J=l(J,$,Y,W,T,23,C[43]),W=l(W,J,$,Y,V,4,C[44]),Y=l(Y,W,J,$,_,11,C[45]),$=l($,Y,W,J,X,16,C[46]),J=l(J,$,Y,W,B,23,C[47]),W=n(W,J,$,Y,E,6,C[48]),Y=n(Y,W,J,$,N,10,C[49]),$=n($,Y,W,J,G,15,C[50]),J=n(J,$,Y,W,R,21,C[51]),W=n(W,J,$,Y,_,6,C[52]),Y=n(Y,W,J,$,D,10,C[53]),$=n($,Y,W,J,L,15,C[54]),J=n(J,$,Y,W,F,21,C[55]),W=n(W,J,$,Y,O,6,C[56]),Y=n(Y,W,J,$,X,10,C[57]),$=n($,Y,W,J,T,15,C[58]),J=n(J,$,Y,W,U,21,C[59]),W=n(W,J,$,Y,P,6,C[60]),Y=n(Y,W,J,$,M,10,C[61]),$=n($,Y,W,J,B,15,C[62]),J=n(J,$,Y,W,V,21,C[63]);S[0]=S[0]+W|0;S[1]=S[1]+J|0;S[2]=S[2]+$|0;S[3]=S[3]+Y|0},_doFinalize:function(){var y=(this||p)._data,S=y.words,E=8*(this||p)._nDataBytes,F=8*y.sigBytes;S[F>>>5]|=128<<24-F%32;var C=v.floor(E/4294967296);S[15+(F+64>>>9<<4)]=16711935&(C<<8|C>>>24)|4278255360&(C<<24|C>>>8);S[14+(F+64>>>9<<4)]=16711935&(E<<8|E>>>24)|4278255360&(E<<24|E>>>8);y.sigBytes=4*(S.length+1);this._process();y=(this||p)._hash;S=y.words;for(E=0;4>E;E++)F=S[E],S[E]=16711935&(F<<8|F>>>24)|4278255360&(F<<24|F>>>8);return y},clone:function(){var v=F.clone.call(this||p);v._hash=(this||p)._hash.clone();return v}});y.MD5=F._createHelper(S);y.HmacMD5=F._createHmacHelper(S)})(Math);(function(){var v=D,y=v.lib,S=y.WordArray,E=y.Hasher,F=[];y=v.algo.SHA1=E.extend({_doReset:function(){(this||p)._hash=new S.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(v,y){for(var S=(this||p)._hash.words,E=S[0],C=S[1],B=S[2],D=S[3],P=S[4],R=0;80>R;R++){if(16>R)F[R]=v[y+R]|0;else{var T=F[R-3]^F[R-8]^F[R-14]^F[R-16];F[R]=T<<1|T>>>31}T=(E<<5|E>>>27)+P+F[R];T=20>R?T+(1518500249+(C&B|~C&D)):40>R?T+(1859775393+(C^B^D)):60>R?T+((C&B|C&D|B&D)-1894007588):T+((C^B^D)-899497514);P=D;D=B;B=C<<30|C>>>2;C=E;E=T}S[0]=S[0]+E|0;S[1]=S[1]+C|0;S[2]=S[2]+B|0;S[3]=S[3]+D|0;S[4]=S[4]+P|0},_doFinalize:function(){var v=(this||p)._data,y=v.words,S=8*(this||p)._nDataBytes,E=8*v.sigBytes;y[E>>>5]|=128<<24-E%32;y[14+(E+64>>>9<<4)]=Math.floor(S/4294967296);y[15+(E+64>>>9<<4)]=S;v.sigBytes=4*y.length;this._process();return(this||p)._hash},clone:function(){var v=E.clone.call(this||p);v._hash=(this||p)._hash.clone();return v}});v.SHA1=E._createHelper(y);v.HmacSHA1=E._createHmacHelper(y)})();(function(v){for(var y=D,S=y.lib,E=S.WordArray,F=S.Hasher,C=(S=y.algo,[]),B=[],u=function(v){return 4294967296*(v-(v|0))|0},P=2,R=0;64>R;){var T;t:{T=P;for(var N=v.sqrt(T),O=2;O<=N;O++)if(!(T%O)){T=!1;break t}T=!0}T&&(8>R&&(C[R]=u(v.pow(P,.5))),B[R]=u(v.pow(P,1/3)),R++);P++}var V=[];S=S.SHA256=F.extend({_doReset:function(){(this||p)._hash=new E.init(C.slice(0))},_doProcessBlock:function(v,y){for(var S=(this||p)._hash.words,E=S[0],F=S[1],C=S[2],D=S[3],P=S[4],R=S[5],T=S[6],N=S[7],O=0;64>O;O++){if(16>O)V[O]=v[y+O]|0;else{var L=V[O-15],M=V[O-2];V[O]=((L<<25|L>>>7)^(L<<14|L>>>18)^L>>>3)+V[O-7]+((M<<15|M>>>17)^(M<<13|M>>>19)^M>>>10)+V[O-16]}L=N+((P<<26|P>>>6)^(P<<21|P>>>11)^(P<<7|P>>>25))+(P&R^~P&T)+B[O]+V[O];M=((E<<30|E>>>2)^(E<<19|E>>>13)^(E<<10|E>>>22))+(E&F^E&C^F&C);N=T;T=R;R=P;P=D+L|0;D=C;C=F;F=E;E=L+M|0}S[0]=S[0]+E|0;S[1]=S[1]+F|0;S[2]=S[2]+C|0;S[3]=S[3]+D|0;S[4]=S[4]+P|0;S[5]=S[5]+R|0;S[6]=S[6]+T|0;S[7]=S[7]+N|0},_doFinalize:function(){var y=(this||p)._data,S=y.words,E=8*(this||p)._nDataBytes,F=8*y.sigBytes;S[F>>>5]|=128<<24-F%32;S[14+(F+64>>>9<<4)]=v.floor(E/4294967296);S[15+(F+64>>>9<<4)]=E;y.sigBytes=4*S.length;this._process();return(this||p)._hash},clone:function(){var v=F.clone.call(this||p);v._hash=(this||p)._hash.clone();return v}});y.SHA256=F._createHelper(S);y.HmacSHA256=F._createHmacHelper(S)})(Math);(function(){var v=D,y=v.lib.WordArray,S=v.algo,E=S.SHA256;S=S.SHA224=E.extend({_doReset:function(){(this||p)._hash=new y.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var v=E._doFinalize.call(this||p);v.sigBytes-=4;return v}});v.SHA224=E._createHelper(S);v.HmacSHA224=E._createHmacHelper(S)})();(function(){function a(){return E.create.apply(E,arguments)}for(var v=D,y=v.lib.Hasher,S=v.x64,E=S.Word,F=S.WordArray,C=(S=v.algo,[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)]),B=[],P=0;80>P;P++)B[P]=a();S=S.SHA512=y.extend({_doReset:function(){(this||p)._hash=new F.init([new E.init(1779033703,4089235720),new E.init(3144134277,2227873595),new E.init(1013904242,4271175723),new E.init(2773480762,1595750129),new E.init(1359893119,2917565137),new E.init(2600822924,725511199),new E.init(528734635,4215389547),new E.init(1541459225,327033209)])},_doProcessBlock:function(v,y){for(var S=(this||p)._hash.words,E=S[0],F=S[1],D=S[2],P=S[3],R=S[4],T=S[5],N=S[6],O=(S=S[7],E.high),V=E.low,L=F.high,M=F.low,_=D.high,U=D.low,G=P.high,X=P.low,W=R.high,J=R.low,$=T.high,Y=T.low,Z=N.high,Q=N.low,tt=S.high,et=S.low,rt=O,it=V,nt=L,st=M,at=_,ot=U,ht=G,ut=X,ct=W,lt=J,ft=$,vt=Y,gt=Z,pt=Q,dt=tt,mt=et,yt=0;80>yt;yt++){var xt=B[yt];if(16>yt)var St=xt.high=v[y+2*yt]|0,bt=xt.low=v[y+2*yt+1]|0;else{St=B[yt-15],bt=St.high;var Et=St.low,wt=(St=(bt>>>1|Et<<31)^(bt>>>8|Et<<24)^bt>>>7,Et=(Et>>>1|bt<<31)^(Et>>>8|bt<<24)^(Et>>>7|bt<<25),B[yt-2]),Ft=(bt=wt.high,wt.low),At=(wt=(bt>>>19|Ft<<13)^(bt<<3|Ft>>>29)^bt>>>6,Ft=(Ft>>>19|bt<<13)^(Ft<<3|bt>>>29)^(Ft>>>6|bt<<26),bt=B[yt-7],bt.high),Ct=B[yt-16],It=Ct.high;Ct=Ct.low,bt=Et+bt.low,St=St+At+(bt>>>0<Et>>>0?1:0),bt=bt+Ft,St=St+wt+(bt>>>0<Ft>>>0?1:0),bt=bt+Ct,St=St+It+(bt>>>0<Ct>>>0?1:0);xt.high=St;xt.low=bt}At=ct&ft^~ct&gt,Ct=lt&vt^~lt&pt,xt=rt&nt^rt&at^nt&at;var Bt=it&st^it&ot^st&ot,Dt=(Et=(rt>>>28|it<<4)^(rt<<30|it>>>2)^(rt<<25|it>>>7),wt=(it>>>28|rt<<4)^(it<<30|rt>>>2)^(it<<25|rt>>>7),Ft=C[yt],Ft.high),Pt=Ft.low;Ft=mt+((lt>>>14|ct<<18)^(lt>>>18|ct<<14)^(lt<<23|ct>>>9)),It=dt+((ct>>>14|lt<<18)^(ct>>>18|lt<<14)^(ct<<23|lt>>>9))+(Ft>>>0<mt>>>0?1:0),Ft=Ft+Ct,It=It+At+(Ft>>>0<Ct>>>0?1:0),Ft=Ft+Pt,It=It+Dt+(Ft>>>0<Pt>>>0?1:0),Ft=Ft+bt,It=It+St+(Ft>>>0<bt>>>0?1:0),bt=wt+Bt,xt=Et+xt+(bt>>>0<wt>>>0?1:0),dt=gt,mt=pt,gt=ft,pt=vt,ft=ct,vt=lt,lt=ut+Ft|0,ct=ht+It+(lt>>>0<ut>>>0?1:0)|0,ht=at,ut=ot,at=nt,ot=st,nt=rt,st=it,it=Ft+bt|0,rt=It+xt+(it>>>0<Ft>>>0?1:0)|0}V=E.low=V+it;E.high=O+rt+(V>>>0<it>>>0?1:0);M=F.low=M+st;F.high=L+nt+(M>>>0<st>>>0?1:0);U=D.low=U+ot;D.high=_+at+(U>>>0<ot>>>0?1:0);X=P.low=X+ut;P.high=G+ht+(X>>>0<ut>>>0?1:0);J=R.low=J+lt;R.high=W+ct+(J>>>0<lt>>>0?1:0);Y=T.low=Y+vt;T.high=$+ft+(Y>>>0<vt>>>0?1:0);Q=N.low=Q+pt;N.high=Z+gt+(Q>>>0<pt>>>0?1:0);et=S.low=et+mt;S.high=tt+dt+(et>>>0<mt>>>0?1:0)},_doFinalize:function(){var v=(this||p)._data,y=v.words,S=8*(this||p)._nDataBytes,E=8*v.sigBytes;y[E>>>5]|=128<<24-E%32;y[30+(E+128>>>10<<5)]=Math.floor(S/4294967296);y[31+(E+128>>>10<<5)]=S;v.sigBytes=4*y.length;this._process();return(this||p)._hash.toX32()},clone:function(){var v=y.clone.call(this||p);v._hash=(this||p)._hash.clone();return v},blockSize:32});v.SHA512=y._createHelper(S);v.HmacSHA512=y._createHmacHelper(S)})();(function(){var v=D,y=v.x64,S=y.Word,E=y.WordArray,F=(y=v.algo,y.SHA512);y=y.SHA384=F.extend({_doReset:function(){(this||p)._hash=new E.init([new S.init(3418070365,3238371032),new S.init(1654270250,914150663),new S.init(2438529370,812702999),new S.init(355462360,4144912697),new S.init(1731405415,4290775857),new S.init(2394180231,1750603025),new S.init(3675008525,1694076839),new S.init(1203062813,3204075428)])},_doFinalize:function(){var v=F._doFinalize.call(this||p);v.sigBytes-=16;return v}});v.SHA384=F._createHelper(y);v.HmacSHA384=F._createHmacHelper(y)})();(function(){var v=D,y=v.lib,S=y.WordArray,E=y.Hasher,F=(y=v.algo,S.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13])),C=S.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),B=S.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),P=S.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),R=S.create([0,1518500249,1859775393,2400959708,2840853838]),T=S.create([1352829926,1548603684,1836072691,2053994217,0]);y=y.RIPEMD160=E.extend({_doReset:function(){(this||p)._hash=S.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(v,y){for(var S=0;16>S;S++){var E=y+S,D=v[E];v[E]=16711935&(D<<8|D>>>24)|4278255360&(D<<24|D>>>8)}E=(this||p)._hash.words,D=R.words;var N,O,V,L,M,_,U,G,X,W,J=T.words,$=F.words,Y=C.words,Z=B.words,Q=P.words;_=N=E[0];U=O=E[1];G=V=E[2];X=L=E[3];W=M=E[4];var tt;for(S=0;80>S;S+=1)tt=N+v[y+$[S]]|0,tt=16>S?tt+((O^V^L)+D[0]):32>S?tt+((O&V|~O&L)+D[1]):48>S?tt+(((O|~V)^L)+D[2]):64>S?tt+((O&L|V&~L)+D[3]):tt+((O^(V|~L))+D[4]),tt|=0,tt=tt<<Z[S]|tt>>>32-Z[S],tt=tt+M|0,N=M,M=L,L=V<<10|V>>>22,V=O,O=tt,tt=_+v[y+Y[S]]|0,tt=16>S?tt+((U^(G|~X))+J[0]):32>S?tt+((U&X|G&~X)+J[1]):48>S?tt+(((U|~G)^X)+J[2]):64>S?tt+((U&G|~U&X)+J[3]):tt+((U^G^X)+J[4]),tt|=0,tt=tt<<Q[S]|tt>>>32-Q[S],tt=tt+W|0,_=W,W=X,X=G<<10|G>>>22,G=U,U=tt;tt=E[1]+V+X|0;E[1]=E[2]+L+W|0;E[2]=E[3]+M+_|0;E[3]=E[4]+N+U|0;E[4]=E[0]+O+G|0;E[0]=tt},_doFinalize:function(){var v=(this||p)._data,y=v.words,S=8*(this||p)._nDataBytes,E=8*v.sigBytes;y[E>>>5]|=128<<24-E%32;y[14+(E+64>>>9<<4)]=16711935&(S<<8|S>>>24)|4278255360&(S<<24|S>>>8);v.sigBytes=4*(y.length+1);this._process();v=(this||p)._hash;y=v.words;for(S=0;5>S;S++)E=y[S],y[S]=16711935&(E<<8|E>>>24)|4278255360&(E<<24|E>>>8);return v},clone:function(){var v=E.clone.call(this||p);v._hash=(this||p)._hash.clone();return v}});v.RIPEMD160=E._createHelper(y);v.HmacRIPEMD160=E._createHmacHelper(y)})(Math);(function(){var v=D,y=v.enc.Utf8;v.algo.HMAC=v.lib.Base.extend({init:function(v,S){v=(this||p)._hasher=new v.init;"string"==typeof S&&(S=y.parse(S));var E=v.blockSize,F=4*E;S.sigBytes>F&&(S=v.finalize(S));S.clamp();for(var C=(this||p)._oKey=S.clone(),B=(this||p)._iKey=S.clone(),D=C.words,P=B.words,R=0;R<E;R++)D[R]^=1549556828,P[R]^=909522486;C.sigBytes=B.sigBytes=F;this.reset()},reset:function(){var v=(this||p)._hasher;v.reset();v.update((this||p)._iKey)},update:function(v){(this||p)._hasher.update(v);return this||p},finalize:function(v){var y=(this||p)._hasher;v=y.finalize(v);y.reset();return y.finalize((this||p)._oKey.clone().concat(v))}})})();(function(){var v=D,y=v.lib,S=y.Base,E=y.WordArray,F=(y=v.algo,y.HMAC),C=y.PBKDF2=S.extend({cfg:S.extend({keySize:4,hasher:y.SHA1,iterations:1}),init:function(v){(this||p).cfg=(this||p).cfg.extend(v)},compute:function(v,y){var S=(this||p).cfg,C=F.create(S.hasher,v),B=E.create(),D=E.create([1]),P=B.words,R=D.words,T=S.keySize;for(S=S.iterations;P.length<T;){var N=C.update(y).finalize(D);C.reset();for(var O=N.words,V=O.length,L=N,M=1;M<S;M++){L=C.finalize(L);C.reset();for(var _=L.words,U=0;U<V;U++)O[U]^=_[U]}B.concat(N);R[0]++}B.sigBytes=4*T;return B}});v.PBKDF2=function(v,p,y){return C.create(y).compute(v,p)}})();var P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var R="=";function hex2b64(v){var p;var y;var S="";for(p=0;p+3<=v.length;p+=3){y=parseInt(v.substring(p,p+3),16);S+=P.charAt(y>>6)+P.charAt(y&63)}if(p+1==v.length){y=parseInt(v.substring(p,p+1),16);S+=P.charAt(y<<2)}else if(p+2==v.length){y=parseInt(v.substring(p,p+2),16);S+=P.charAt(y>>2)+P.charAt((y&3)<<4)}if(R)while((S.length&3)>0)S+=R;return S}function b64tohex(v){var p="";var y;var S=0;var E;var F;for(y=0;y<v.length;++y){if(v.charAt(y)==R)break;F=P.indexOf(v.charAt(y));if(!(F<0))if(S==0){p+=int2char(F>>2);E=F&3;S=1}else if(S==1){p+=int2char(E<<2|F>>4);E=F&15;S=2}else if(S==2){p+=int2char(E);p+=int2char(F>>2);E=F&3;S=3}else{p+=int2char(E<<2|F>>4);p+=int2char(F&15);S=0}}S==1&&(p+=int2char(E<<2));return p}function b64toBA(v){var p=b64tohex(v);var y;var S=new Array;for(y=0;2*y<p.length;++y)S[y]=parseInt(p.substring(2*y,2*y+2),16);return S}var T;var N=0xdeadbeefcafe;var O=(N&16777215)==15715070;function BigInteger(v,p,y){v!=null&&("number"==typeof v?this.fromNumber(v,p,y):p==null&&"string"!=typeof v?this.fromString(v,256):this.fromString(v,p))}function nbi(){return new BigInteger(null)}function am1(v,y,S,E,F,C){while(--C>=0){var B=y*(this||p)[v++]+S[E]+F;F=Math.floor(B/67108864);S[E++]=B&67108863}return F}function am2(v,y,S,E,F,C){var B=y&32767,D=y>>15;while(--C>=0){var P=(this||p)[v]&32767;var R=(this||p)[v++]>>15;var T=D*P+R*B;P=B*P+((T&32767)<<15)+S[E]+(F&1073741823);F=(P>>>30)+(T>>>15)+D*R+(F>>>30);S[E++]=P&1073741823}return F}function am3(v,y,S,E,F,C){var B=y&16383,D=y>>14;while(--C>=0){var P=(this||p)[v]&16383;var R=(this||p)[v++]>>14;var T=D*P+R*B;P=B*P+((T&16383)<<14)+S[E]+F;F=(P>>28)+(T>>14)+D*R;S[E++]=P&268435455}return F}if(O&&E.appName=="Microsoft Internet Explorer"){BigInteger.prototype.am=am2;T=30}else if(O&&E.appName!="Netscape"){BigInteger.prototype.am=am1;T=26}else{BigInteger.prototype.am=am3;T=28}BigInteger.prototype.DB=T;BigInteger.prototype.DM=(1<<T)-1;BigInteger.prototype.DV=1<<T;var V=52;BigInteger.prototype.FV=Math.pow(2,V);BigInteger.prototype.F1=V-T;BigInteger.prototype.F2=2*T-V;var L="0123456789abcdefghijklmnopqrstuvwxyz";var M=new Array;var _,U;_="0".charCodeAt(0);for(U=0;U<=9;++U)M[_++]=U;_="a".charCodeAt(0);for(U=10;U<36;++U)M[_++]=U;_="A".charCodeAt(0);for(U=10;U<36;++U)M[_++]=U;function int2char(v){return L.charAt(v)}function intAt(v,p){var y=M[v.charCodeAt(p)];return y==null?-1:y}function bnpCopyTo(v){for(var y=(this||p).t-1;y>=0;--y)v[y]=(this||p)[y];v.t=(this||p).t;v.s=(this||p).s}function bnpFromInt(v){(this||p).t=1;(this||p).s=v<0?-1:0;v>0?(this||p)[0]=v:v<-1?(this||p)[0]=v+(this||p).DV:(this||p).t=0}function nbv(v){var p=nbi();p.fromInt(v);return p}function bnpFromString(v,y){var S;if(y==16)S=4;else if(y==8)S=3;else if(y==256)S=8;else if(y==2)S=1;else if(y==32)S=5;else{if(y!=4){this.fromRadix(v,y);return}S=2}(this||p).t=0;(this||p).s=0;var E=v.length,F=false,C=0;while(--E>=0){var B=S==8?v[E]&255:intAt(v,E);if(B<0)v.charAt(E)=="-"&&(F=true);else{F=false;if(C==0)(this||p)[(this||p).t++]=B;else if(C+S>(this||p).DB){(this||p)[(this||p).t-1]|=(B&(1<<(this||p).DB-C)-1)<<C;(this||p)[(this||p).t++]=B>>(this||p).DB-C}else(this||p)[(this||p).t-1]|=B<<C;C+=S;C>=(this||p).DB&&(C-=(this||p).DB)}}if(S==8&&(v[0]&128)!=0){(this||p).s=-1;C>0&&((this||p)[(this||p).t-1]|=(1<<(this||p).DB-C)-1<<C)}this.clamp();F&&BigInteger.ZERO.subTo(this||p,this||p)}function bnpClamp(){var v=(this||p).s&(this||p).DM;while((this||p).t>0&&(this||p)[(this||p).t-1]==v)--(this||p).t}function bnToString(v){if((this||p).s<0)return"-"+this.negate().toString(v);var y;if(v==16)y=4;else if(v==8)y=3;else if(v==2)y=1;else if(v==32)y=5;else{if(v!=4)return this.toRadix(v);y=2}var S,E=(1<<y)-1,F=false,C="",B=(this||p).t;var D=(this||p).DB-B*(this||p).DB%y;if(B-- >0){if(D<(this||p).DB&&(S=(this||p)[B]>>D)>0){F=true;C=int2char(S)}while(B>=0){if(D<y){S=((this||p)[B]&(1<<D)-1)<<y-D;S|=(this||p)[--B]>>(D+=(this||p).DB-y)}else{S=(this||p)[B]>>(D-=y)&E;if(D<=0){D+=(this||p).DB;--B}}S>0&&(F=true);F&&(C+=int2char(S))}}return F?C:"0"}function bnNegate(){var v=nbi();BigInteger.ZERO.subTo(this||p,v);return v}function bnAbs(){return(this||p).s<0?this.negate():this||p}function bnCompareTo(v){var y=(this||p).s-v.s;if(y!=0)return y;var S=(this||p).t;y=S-v.t;if(y!=0)return(this||p).s<0?-y:y;while(--S>=0)if((y=(this||p)[S]-v[S])!=0)return y;return 0}function nbits(v){var p,y=1;if((p=v>>>16)!=0){v=p;y+=16}if((p=v>>8)!=0){v=p;y+=8}if((p=v>>4)!=0){v=p;y+=4}if((p=v>>2)!=0){v=p;y+=2}if((p=v>>1)!=0){v=p;y+=1}return y}function bnBitLength(){return(this||p).t<=0?0:(this||p).DB*((this||p).t-1)+nbits((this||p)[(this||p).t-1]^(this||p).s&(this||p).DM)}function bnpDLShiftTo(v,y){var S;for(S=(this||p).t-1;S>=0;--S)y[S+v]=(this||p)[S];for(S=v-1;S>=0;--S)y[S]=0;y.t=(this||p).t+v;y.s=(this||p).s}function bnpDRShiftTo(v,y){for(var S=v;S<(this||p).t;++S)y[S-v]=(this||p)[S];y.t=Math.max((this||p).t-v,0);y.s=(this||p).s}function bnpLShiftTo(v,y){var S=v%(this||p).DB;var E=(this||p).DB-S;var F=(1<<E)-1;var C,B=Math.floor(v/(this||p).DB),D=(this||p).s<<S&(this||p).DM;for(C=(this||p).t-1;C>=0;--C){y[C+B+1]=(this||p)[C]>>E|D;D=((this||p)[C]&F)<<S}for(C=B-1;C>=0;--C)y[C]=0;y[B]=D;y.t=(this||p).t+B+1;y.s=(this||p).s;y.clamp()}function bnpRShiftTo(v,y){y.s=(this||p).s;var S=Math.floor(v/(this||p).DB);if(S>=(this||p).t)y.t=0;else{var E=v%(this||p).DB;var F=(this||p).DB-E;var C=(1<<E)-1;y[0]=(this||p)[S]>>E;for(var B=S+1;B<(this||p).t;++B){y[B-S-1]|=((this||p)[B]&C)<<F;y[B-S]=(this||p)[B]>>E}E>0&&(y[(this||p).t-S-1]|=((this||p).s&C)<<F);y.t=(this||p).t-S;y.clamp()}}function bnpSubTo(v,y){var S=0,E=0,F=Math.min(v.t,(this||p).t);while(S<F){E+=(this||p)[S]-v[S];y[S++]=E&(this||p).DM;E>>=(this||p).DB}if(v.t<(this||p).t){E-=v.s;while(S<(this||p).t){E+=(this||p)[S];y[S++]=E&(this||p).DM;E>>=(this||p).DB}E+=(this||p).s}else{E+=(this||p).s;while(S<v.t){E-=v[S];y[S++]=E&(this||p).DM;E>>=(this||p).DB}E-=v.s}y.s=E<0?-1:0;E<-1?y[S++]=(this||p).DV+E:E>0&&(y[S++]=E);y.t=S;y.clamp()}function bnpMultiplyTo(v,y){var S=this.abs(),E=v.abs();var F=S.t;y.t=F+E.t;while(--F>=0)y[F]=0;for(F=0;F<E.t;++F)y[F+S.t]=S.am(0,E[F],y,F,0,S.t);y.s=0;y.clamp();(this||p).s!=v.s&&BigInteger.ZERO.subTo(y,y)}function bnpSquareTo(v){var p=this.abs();var y=v.t=2*p.t;while(--y>=0)v[y]=0;for(y=0;y<p.t-1;++y){var S=p.am(y,p[y],v,2*y,0,1);if((v[y+p.t]+=p.am(y+1,2*p[y],v,2*y+1,S,p.t-y-1))>=p.DV){v[y+p.t]-=p.DV;v[y+p.t+1]=1}}v.t>0&&(v[v.t-1]+=p.am(y,p[y],v,2*y,0,1));v.s=0;v.clamp()}function bnpDivRemTo(v,y,S){var E=v.abs();if(!(E.t<=0)){var F=this.abs();if(F.t<E.t){y!=null&&y.fromInt(0);S!=null&&this.copyTo(S)}else{S==null&&(S=nbi());var C=nbi(),B=(this||p).s,D=v.s;var P=(this||p).DB-nbits(E[E.t-1]);if(P>0){E.lShiftTo(P,C);F.lShiftTo(P,S)}else{E.copyTo(C);F.copyTo(S)}var R=C.t;var T=C[R-1];if(T!=0){var N=T*(1<<(this||p).F1)+(R>1?C[R-2]>>(this||p).F2:0);var O=(this||p).FV/N,V=(1<<(this||p).F1)/N,L=1<<(this||p).F2;var M=S.t,_=M-R,U=y==null?nbi():y;C.dlShiftTo(_,U);if(S.compareTo(U)>=0){S[S.t++]=1;S.subTo(U,S)}BigInteger.ONE.dlShiftTo(R,U);U.subTo(C,C);while(C.t<R)C[C.t++]=0;while(--_>=0){var G=S[--M]==T?(this||p).DM:Math.floor(S[M]*O+(S[M-1]+L)*V);if((S[M]+=C.am(0,G,S,_,0,R))<G){C.dlShiftTo(_,U);S.subTo(U,S);while(S[M]<--G)S.subTo(U,S)}}if(y!=null){S.drShiftTo(R,y);B!=D&&BigInteger.ZERO.subTo(y,y)}S.t=R;S.clamp();P>0&&S.rShiftTo(P,S);B<0&&BigInteger.ZERO.subTo(S,S)}}}}function bnMod(v){var y=nbi();this.abs().divRemTo(v,null,y);(this||p).s<0&&y.compareTo(BigInteger.ZERO)>0&&v.subTo(y,y);return y}function Classic(v){(this||p).m=v}function cConvert(v){return v.s<0||v.compareTo((this||p).m)>=0?v.mod((this||p).m):v}function cRevert(v){return v}function cReduce(v){v.divRemTo((this||p).m,null,v)}function cMulTo(v,p,y){v.multiplyTo(p,y);this.reduce(y)}function cSqrTo(v,p){v.squareTo(p);this.reduce(p)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if((this||p).t<1)return 0;var v=(this||p)[0];if((v&1)==0)return 0;var y=v&3;y=y*(2-(v&15)*y)&15;y=y*(2-(v&255)*y)&255;y=y*(2-((v&65535)*y&65535))&65535;y=y*(2-v*y%(this||p).DV)%(this||p).DV;return y>0?(this||p).DV-y:-y}function Montgomery(v){(this||p).m=v;(this||p).mp=v.invDigit();(this||p).mpl=(this||p).mp&32767;(this||p).mph=(this||p).mp>>15;(this||p).um=(1<<v.DB-15)-1;(this||p).mt2=2*v.t}function montConvert(v){var y=nbi();v.abs().dlShiftTo((this||p).m.t,y);y.divRemTo((this||p).m,null,y);v.s<0&&y.compareTo(BigInteger.ZERO)>0&&(this||p).m.subTo(y,y);return y}function montRevert(v){var p=nbi();v.copyTo(p);this.reduce(p);return p}function montReduce(v){while(v.t<=(this||p).mt2)v[v.t++]=0;for(var y=0;y<(this||p).m.t;++y){var S=v[y]&32767;var E=S*(this||p).mpl+((S*(this||p).mph+(v[y]>>15)*(this||p).mpl&(this||p).um)<<15)&v.DM;S=y+(this||p).m.t;v[S]+=(this||p).m.am(0,E,v,y,0,(this||p).m.t);while(v[S]>=v.DV){v[S]-=v.DV;v[++S]++}}v.clamp();v.drShiftTo((this||p).m.t,v);v.compareTo((this||p).m)>=0&&v.subTo((this||p).m,v)}function montSqrTo(v,p){v.squareTo(p);this.reduce(p)}function montMulTo(v,p,y){v.multiplyTo(p,y);this.reduce(y)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return((this||p).t>0?(this||p)[0]&1:(this||p).s)==0}function bnpExp(v,y){if(v>4294967295||v<1)return BigInteger.ONE;var S=nbi(),E=nbi(),F=y.convert(this||p),C=nbits(v)-1;F.copyTo(S);while(--C>=0){y.sqrTo(S,E);if((v&1<<C)>0)y.mulTo(E,F,S);else{var B=S;S=E;E=B}}return y.revert(S)}function bnModPowInt(v,p){var y;y=v<256||p.isEven()?new Classic(p):new Montgomery(p);return this.exp(v,y)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var v=nbi();this.copyTo(v);return v}function bnIntValue(){if((this||p).s<0){if((this||p).t==1)return(this||p)[0]-(this||p).DV;if((this||p).t==0)return-1}else{if((this||p).t==1)return(this||p)[0];if((this||p).t==0)return 0}return((this||p)[1]&(1<<32-(this||p).DB)-1)<<(this||p).DB|(this||p)[0]}function bnByteValue(){return(this||p).t==0?(this||p).s:(this||p)[0]<<24>>24}function bnShortValue(){return(this||p).t==0?(this||p).s:(this||p)[0]<<16>>16}function bnpChunkSize(v){return Math.floor(Math.LN2*(this||p).DB/Math.log(v))}function bnSigNum(){return(this||p).s<0?-1:(this||p).t<=0||(this||p).t==1&&(this||p)[0]<=0?0:1}function bnpToRadix(v){v==null&&(v=10);if(this.signum()==0||v<2||v>36)return"0";var p=this.chunkSize(v);var y=Math.pow(v,p);var S=nbv(y),E=nbi(),F=nbi(),C="";this.divRemTo(S,E,F);while(E.signum()>0){C=(y+F.intValue()).toString(v).substr(1)+C;E.divRemTo(S,E,F)}return F.intValue().toString(v)+C}function bnpFromRadix(v,y){this.fromInt(0);y==null&&(y=10);var S=this.chunkSize(y);var E=Math.pow(y,S),F=false,C=0,B=0;for(var D=0;D<v.length;++D){var P=intAt(v,D);if(P<0)v.charAt(D)=="-"&&this.signum()==0&&(F=true);else{B=y*B+P;if(++C>=S){this.dMultiply(E);this.dAddOffset(B,0);C=0;B=0}}}if(C>0){this.dMultiply(Math.pow(y,C));this.dAddOffset(B,0)}F&&BigInteger.ZERO.subTo(this||p,this||p)}function bnpFromNumber(v,y,S){if("number"==typeof y)if(v<2)this.fromInt(1);else{this.fromNumber(v,S);this.testBit(v-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(v-1),op_or,this||p);this.isEven()&&this.dAddOffset(1,0);while(!this.isProbablePrime(y)){this.dAddOffset(2,0);this.bitLength()>v&&this.subTo(BigInteger.ONE.shiftLeft(v-1),this||p)}}else{var E=new Array,F=v&7;E.length=1+(v>>3);y.nextBytes(E);F>0?E[0]&=(1<<F)-1:E[0]=0;this.fromString(E,256)}}function bnToByteArray(){var v=(this||p).t,y=new Array;y[0]=(this||p).s;var S,E=(this||p).DB-v*(this||p).DB%8,F=0;if(v-- >0){E<(this||p).DB&&(S=(this||p)[v]>>E)!=((this||p).s&(this||p).DM)>>E&&(y[F++]=S|(this||p).s<<(this||p).DB-E);while(v>=0){if(E<8){S=((this||p)[v]&(1<<E)-1)<<8-E;S|=(this||p)[--v]>>(E+=(this||p).DB-8)}else{S=(this||p)[v]>>(E-=8)&255;if(E<=0){E+=(this||p).DB;--v}}(S&128)!=0&&(S|=-256);F==0&&((this||p).s&128)!=(S&128)&&++F;(F>0||S!=(this||p).s)&&(y[F++]=S)}}return y}function bnEquals(v){return this.compareTo(v)==0}function bnMin(v){return this.compareTo(v)<0?this||p:v}function bnMax(v){return this.compareTo(v)>0?this||p:v}function bnpBitwiseTo(v,y,S){var E,F,C=Math.min(v.t,(this||p).t);for(E=0;E<C;++E)S[E]=y((this||p)[E],v[E]);if(v.t<(this||p).t){F=v.s&(this||p).DM;for(E=C;E<(this||p).t;++E)S[E]=y((this||p)[E],F);S.t=(this||p).t}else{F=(this||p).s&(this||p).DM;for(E=C;E<v.t;++E)S[E]=y(F,v[E]);S.t=v.t}S.s=y((this||p).s,v.s);S.clamp()}function op_and(v,p){return v&p}function bnAnd(v){var p=nbi();this.bitwiseTo(v,op_and,p);return p}function op_or(v,p){return v|p}function bnOr(v){var p=nbi();this.bitwiseTo(v,op_or,p);return p}function op_xor(v,p){return v^p}function bnXor(v){var p=nbi();this.bitwiseTo(v,op_xor,p);return p}function op_andnot(v,p){return v&~p}function bnAndNot(v){var p=nbi();this.bitwiseTo(v,op_andnot,p);return p}function bnNot(){var v=nbi();for(var y=0;y<(this||p).t;++y)v[y]=(this||p).DM&~(this||p)[y];v.t=(this||p).t;v.s=~(this||p).s;return v}function bnShiftLeft(v){var p=nbi();v<0?this.rShiftTo(-v,p):this.lShiftTo(v,p);return p}function bnShiftRight(v){var p=nbi();v<0?this.lShiftTo(-v,p):this.rShiftTo(v,p);return p}function lbit(v){if(v==0)return-1;var p=0;if((v&65535)==0){v>>=16;p+=16}if((v&255)==0){v>>=8;p+=8}if((v&15)==0){v>>=4;p+=4}if((v&3)==0){v>>=2;p+=2}(v&1)==0&&++p;return p}function bnGetLowestSetBit(){for(var v=0;v<(this||p).t;++v)if((this||p)[v]!=0)return v*(this||p).DB+lbit((this||p)[v]);return(this||p).s<0?(this||p).t*(this||p).DB:-1}function cbit(v){var p=0;while(v!=0){v&=v-1;++p}return p}function bnBitCount(){var v=0,y=(this||p).s&(this||p).DM;for(var S=0;S<(this||p).t;++S)v+=cbit((this||p)[S]^y);return v}function bnTestBit(v){var y=Math.floor(v/(this||p).DB);return y>=(this||p).t?(this||p).s!=0:((this||p)[y]&1<<v%(this||p).DB)!=0}function bnpChangeBit(v,p){var y=BigInteger.ONE.shiftLeft(v);this.bitwiseTo(y,p,y);return y}function bnSetBit(v){return this.changeBit(v,op_or)}function bnClearBit(v){return this.changeBit(v,op_andnot)}function bnFlipBit(v){return this.changeBit(v,op_xor)}function bnpAddTo(v,y){var S=0,E=0,F=Math.min(v.t,(this||p).t);while(S<F){E+=(this||p)[S]+v[S];y[S++]=E&(this||p).DM;E>>=(this||p).DB}if(v.t<(this||p).t){E+=v.s;while(S<(this||p).t){E+=(this||p)[S];y[S++]=E&(this||p).DM;E>>=(this||p).DB}E+=(this||p).s}else{E+=(this||p).s;while(S<v.t){E+=v[S];y[S++]=E&(this||p).DM;E>>=(this||p).DB}E+=v.s}y.s=E<0?-1:0;E>0?y[S++]=E:E<-1&&(y[S++]=(this||p).DV+E);y.t=S;y.clamp()}function bnAdd(v){var p=nbi();this.addTo(v,p);return p}function bnSubtract(v){var p=nbi();this.subTo(v,p);return p}function bnMultiply(v){var p=nbi();this.multiplyTo(v,p);return p}function bnSquare(){var v=nbi();this.squareTo(v);return v}function bnDivide(v){var p=nbi();this.divRemTo(v,p,null);return p}function bnRemainder(v){var p=nbi();this.divRemTo(v,null,p);return p}function bnDivideAndRemainder(v){var p=nbi(),y=nbi();this.divRemTo(v,p,y);return new Array(p,y)}function bnpDMultiply(v){(this||p)[(this||p).t]=this.am(0,v-1,this||p,0,0,(this||p).t);++(this||p).t;this.clamp()}function bnpDAddOffset(v,y){if(v!=0){while((this||p).t<=y)(this||p)[(this||p).t++]=0;(this||p)[y]+=v;while((this||p)[y]>=(this||p).DV){(this||p)[y]-=(this||p).DV;++y>=(this||p).t&&((this||p)[(this||p).t++]=0);++(this||p)[y]}}}function NullExp(){}function nNop(v){return v}function nMulTo(v,p,y){v.multiplyTo(p,y)}function nSqrTo(v,p){v.squareTo(p)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(v){return this.exp(v,new NullExp)}function bnpMultiplyLowerTo(v,y,S){var E=Math.min((this||p).t+v.t,y);S.s=0;S.t=E;while(E>0)S[--E]=0;var F;for(F=S.t-(this||p).t;E<F;++E)S[E+(this||p).t]=this.am(0,v[E],S,E,0,(this||p).t);for(F=Math.min(v.t,y);E<F;++E)this.am(0,v[E],S,E,0,y-E);S.clamp()}function bnpMultiplyUpperTo(v,y,S){--y;var E=S.t=(this||p).t+v.t-y;S.s=0;while(--E>=0)S[E]=0;for(E=Math.max(y-(this||p).t,0);E<v.t;++E)S[(this||p).t+E-y]=this.am(y-E,v[E],S,0,0,(this||p).t+E-y);S.clamp();S.drShiftTo(1,S)}function Barrett(v){(this||p).r2=nbi();(this||p).q3=nbi();BigInteger.ONE.dlShiftTo(2*v.t,(this||p).r2);(this||p).mu=(this||p).r2.divide(v);(this||p).m=v}function barrettConvert(v){if(v.s<0||v.t>2*(this||p).m.t)return v.mod((this||p).m);if(v.compareTo((this||p).m)<0)return v;var y=nbi();v.copyTo(y);this.reduce(y);return y}function barrettRevert(v){return v}function barrettReduce(v){v.drShiftTo((this||p).m.t-1,(this||p).r2);if(v.t>(this||p).m.t+1){v.t=(this||p).m.t+1;v.clamp()}(this||p).mu.multiplyUpperTo((this||p).r2,(this||p).m.t+1,(this||p).q3);(this||p).m.multiplyLowerTo((this||p).q3,(this||p).m.t+1,(this||p).r2);while(v.compareTo((this||p).r2)<0)v.dAddOffset(1,(this||p).m.t+1);v.subTo((this||p).r2,v);while(v.compareTo((this||p).m)>=0)v.subTo((this||p).m,v)}function barrettSqrTo(v,p){v.squareTo(p);this.reduce(p)}function barrettMulTo(v,p,y){v.multiplyTo(p,y);this.reduce(y)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(v,y){var S,E,F=v.bitLength(),C=nbv(1);if(F<=0)return C;S=F<18?1:F<48?3:F<144?4:F<768?5:6;E=F<8?new Classic(y):y.isEven()?new Barrett(y):new Montgomery(y);var B=new Array,D=3,P=S-1,R=(1<<S)-1;B[1]=E.convert(this||p);if(S>1){var T=nbi();E.sqrTo(B[1],T);while(D<=R){B[D]=nbi();E.mulTo(T,B[D-2],B[D]);D+=2}}var N,O,V=v.t-1,L=true,M=nbi();F=nbits(v[V])-1;while(V>=0){if(F>=P)N=v[V]>>F-P&R;else{N=(v[V]&(1<<F+1)-1)<<P-F;V>0&&(N|=v[V-1]>>(this||p).DB+F-P)}D=S;while((N&1)==0){N>>=1;--D}if((F-=D)<0){F+=(this||p).DB;--V}if(L){B[N].copyTo(C);L=false}else{while(D>1){E.sqrTo(C,M);E.sqrTo(M,C);D-=2}if(D>0)E.sqrTo(C,M);else{O=C;C=M;M=O}E.mulTo(M,B[N],C)}while(V>=0&&(v[V]&1<<F)==0){E.sqrTo(C,M);O=C;C=M;M=O;if(--F<0){F=(this||p).DB-1;--V}}}return E.revert(C)}function bnGCD(v){var y=(this||p).s<0?this.negate():this.clone();var S=v.s<0?v.negate():v.clone();if(y.compareTo(S)<0){var E=y;y=S;S=E}var F=y.getLowestSetBit(),C=S.getLowestSetBit();if(C<0)return y;F<C&&(C=F);if(C>0){y.rShiftTo(C,y);S.rShiftTo(C,S)}while(y.signum()>0){(F=y.getLowestSetBit())>0&&y.rShiftTo(F,y);(F=S.getLowestSetBit())>0&&S.rShiftTo(F,S);if(y.compareTo(S)>=0){y.subTo(S,y);y.rShiftTo(1,y)}else{S.subTo(y,S);S.rShiftTo(1,S)}}C>0&&S.lShiftTo(C,S);return S}function bnpModInt(v){if(v<=0)return 0;var y=(this||p).DV%v,S=(this||p).s<0?v-1:0;if((this||p).t>0)if(y==0)S=(this||p)[0]%v;else for(var E=(this||p).t-1;E>=0;--E)S=(y*S+(this||p)[E])%v;return S}function bnModInverse(v){var y=v.isEven();if(this.isEven()&&y||v.signum()==0)return BigInteger.ZERO;var S=v.clone(),E=this.clone();var F=nbv(1),C=nbv(0),B=nbv(0),D=nbv(1);while(S.signum()!=0){while(S.isEven()){S.rShiftTo(1,S);if(y){if(!F.isEven()||!C.isEven()){F.addTo(this||p,F);C.subTo(v,C)}F.rShiftTo(1,F)}else C.isEven()||C.subTo(v,C);C.rShiftTo(1,C)}while(E.isEven()){E.rShiftTo(1,E);if(y){if(!B.isEven()||!D.isEven()){B.addTo(this||p,B);D.subTo(v,D)}B.rShiftTo(1,B)}else D.isEven()||D.subTo(v,D);D.rShiftTo(1,D)}if(S.compareTo(E)>=0){S.subTo(E,S);y&&F.subTo(B,F);C.subTo(D,C)}else{E.subTo(S,E);y&&B.subTo(F,B);D.subTo(C,D)}}if(E.compareTo(BigInteger.ONE)!=0)return BigInteger.ZERO;if(D.compareTo(v)>=0)return D.subtract(v);if(!(D.signum()<0))return D;D.addTo(v,D);return D.signum()<0?D.add(v):D}var G=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var X=(1<<26)/G[G.length-1];function bnIsProbablePrime(v){var p,y=this.abs();if(y.t==1&&y[0]<=G[G.length-1]){for(p=0;p<G.length;++p)if(y[0]==G[p])return true;return false}if(y.isEven())return false;p=1;while(p<G.length){var S=G[p],E=p+1;while(E<G.length&&S<X)S*=G[E++];S=y.modInt(S);while(p<E)if(S%G[p++]==0)return false}return y.millerRabin(v)}function bnpMillerRabin(v){var y=this.subtract(BigInteger.ONE);var S=y.getLowestSetBit();if(S<=0)return false;var E=y.shiftRight(S);v=v+1>>1;v>G.length&&(v=G.length);var F=nbi();for(var C=0;C<v;++C){F.fromInt(G[Math.floor(Math.random()*G.length)]);var B=F.modPow(E,this||p);if(B.compareTo(BigInteger.ONE)!=0&&B.compareTo(y)!=0){var D=1;while(D++<S&&B.compareTo(y)!=0){B=B.modPowInt(2,this||p);if(B.compareTo(BigInteger.ONE)==0)return false}if(B.compareTo(y)!=0)return false}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;function Arcfour(){(this||p).i=0;(this||p).j=0;(this||p).S=new Array}function ARC4init(v){var y,S,E;for(y=0;y<256;++y)(this||p).S[y]=y;S=0;for(y=0;y<256;++y){S=S+(this||p).S[y]+v[y%v.length]&255;E=(this||p).S[y];(this||p).S[y]=(this||p).S[S];(this||p).S[S]=E}(this||p).i=0;(this||p).j=0}function ARC4next(){var v;(this||p).i=(this||p).i+1&255;(this||p).j=(this||p).j+(this||p).S[(this||p).i]&255;v=(this||p).S[(this||p).i];(this||p).S[(this||p).i]=(this||p).S[(this||p).j];(this||p).S[(this||p).j]=v;return(this||p).S[v+(this||p).S[(this||p).i]&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour}var W=256;var J;var $;var Y;function rng_seed_int(v){$[Y++]^=v&255;$[Y++]^=v>>8&255;$[Y++]^=v>>16&255;$[Y++]^=v>>24&255;Y>=W&&(Y-=W)}function rng_seed_time(){rng_seed_int((new Date).getTime())}if($==null){$=new Array;Y=0;var Z;if(F!==void 0&&(F.crypto!==void 0||F.msCrypto!==void 0)){var Q=F.crypto||F.msCrypto;if(Q.getRandomValues){var tt=new Uint8Array(32);Q.getRandomValues(tt);for(Z=0;Z<32;++Z)$[Y++]=tt[Z]}else if(E.appName=="Netscape"&&E.appVersion<"5"){var et=F.crypto.random(32);for(Z=0;Z<et.length;++Z)$[Y++]=et.charCodeAt(Z)&255}}while(Y<W){Z=Math.floor(65536*Math.random());$[Y++]=Z>>>8;$[Y++]=Z&255}Y=0;rng_seed_time()}function rng_get_byte(){if(J==null){rng_seed_time();J=prng_newstate();J.init($);for(Y=0;Y<$.length;++Y)$[Y]=0;Y=0}return J.next()}function rng_get_bytes(v){var p;for(p=0;p<v.length;++p)v[p]=rng_get_byte()}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;function parseBigInt(v,p){return new BigInteger(v,p)}function RSAKey(){(this||p).n=null;(this||p).e=0;(this||p).d=null;(this||p).p=null;(this||p).q=null;(this||p).dmp1=null;(this||p).dmq1=null;(this||p).coeff=null}function RSASetPublic(v,y){(this||p).isPublic=true;(this||p).isPrivate=false;if(typeof v!=="string"){(this||p).n=v;(this||p).e=y}else{if(!(v!=null&&y!=null&&v.length>0&&y.length>0))throw"Invalid RSA public key";(this||p).n=parseBigInt(v,16);(this||p).e=parseInt(y,16)}}function RSADoPublic(v){return v.modPowInt((this||p).e,(this||p).n)}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.type="RSA";function RSASetPrivate(v,y,S){(this||p).isPrivate=true;if(typeof v!=="string"){(this||p).n=v;(this||p).e=y;(this||p).d=S}else{if(!(v!=null&&y!=null&&v.length>0&&y.length>0))throw"Invalid RSA private key";(this||p).n=parseBigInt(v,16);(this||p).e=parseInt(y,16);(this||p).d=parseBigInt(S,16)}}function RSASetPrivateEx(v,y,S,E,F,C,B,D){(this||p).isPrivate=true;(this||p).isPublic=false;if(v==null)throw"RSASetPrivateEx N == null";if(y==null)throw"RSASetPrivateEx E == null";if(v.length==0)throw"RSASetPrivateEx N.length == 0";if(y.length==0)throw"RSASetPrivateEx E.length == 0";if(!(v!=null&&y!=null&&v.length>0&&y.length>0))throw"Invalid RSA private key in RSASetPrivateEx";(this||p).n=parseBigInt(v,16);(this||p).e=parseInt(y,16);(this||p).d=parseBigInt(S,16);(this||p).p=parseBigInt(E,16);(this||p).q=parseBigInt(F,16);(this||p).dmp1=parseBigInt(C,16);(this||p).dmq1=parseBigInt(B,16);(this||p).coeff=parseBigInt(D,16)}function RSAGenerate(v,y){var S=new SecureRandom;var E=v>>1;(this||p).e=parseInt(y,16);var F=new BigInteger(y,16);var C=v/2-100;var B=BigInteger.ONE.shiftLeft(C);for(;;){for(;;){(this||p).p=new BigInteger(v-E,1,S);if((this||p).p.subtract(BigInteger.ONE).gcd(F).compareTo(BigInteger.ONE)==0&&(this||p).p.isProbablePrime(10))break}for(;;){(this||p).q=new BigInteger(E,1,S);if((this||p).q.subtract(BigInteger.ONE).gcd(F).compareTo(BigInteger.ONE)==0&&(this||p).q.isProbablePrime(10))break}if((this||p).p.compareTo((this||p).q)<=0){var D=(this||p).p;(this||p).p=(this||p).q;(this||p).q=D}var P=(this||p).q.subtract((this||p).p).abs();if(!(P.bitLength()<C||P.compareTo(B)<=0)){var R=(this||p).p.subtract(BigInteger.ONE);var T=(this||p).q.subtract(BigInteger.ONE);var N=R.multiply(T);if(N.gcd(F).compareTo(BigInteger.ONE)==0){(this||p).n=(this||p).p.multiply((this||p).q);if((this||p).n.bitLength()==v){(this||p).d=F.modInverse(N);(this||p).dmp1=(this||p).d.mod(R);(this||p).dmq1=(this||p).d.mod(T);(this||p).coeff=(this||p).q.modInverse((this||p).p);break}}}}(this||p).isPrivate=true}function RSADoPrivate(v){if((this||p).p==null||(this||p).q==null)return v.modPow((this||p).d,(this||p).n);var y=v.mod((this||p).p).modPow((this||p).dmp1,(this||p).p);var S=v.mod((this||p).q).modPow((this||p).dmq1,(this||p).q);while(y.compareTo(S)<0)y=y.add((this||p).p);return y.subtract(S).multiply((this||p).coeff).mod((this||p).p).multiply((this||p).q).add(S)}RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.generate=RSAGenerate;function ECFieldElementFp(v,y){(this||p).x=y;(this||p).q=v}function feFpEquals(v){return v==(this||p)||(this||p).q.equals(v.q)&&(this||p).x.equals(v.x)}function feFpToBigInteger(){return(this||p).x}function feFpNegate(){return new ECFieldElementFp((this||p).q,(this||p).x.negate().mod((this||p).q))}function feFpAdd(v){return new ECFieldElementFp((this||p).q,(this||p).x.add(v.toBigInteger()).mod((this||p).q))}function feFpSubtract(v){return new ECFieldElementFp((this||p).q,(this||p).x.subtract(v.toBigInteger()).mod((this||p).q))}function feFpMultiply(v){return new ECFieldElementFp((this||p).q,(this||p).x.multiply(v.toBigInteger()).mod((this||p).q))}function feFpSquare(){return new ECFieldElementFp((this||p).q,(this||p).x.square().mod((this||p).q))}function feFpDivide(v){return new ECFieldElementFp((this||p).q,(this||p).x.multiply(v.toBigInteger().modInverse((this||p).q)).mod((this||p).q))}ECFieldElementFp.prototype.equals=feFpEquals;ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger;ECFieldElementFp.prototype.negate=feFpNegate;ECFieldElementFp.prototype.add=feFpAdd;ECFieldElementFp.prototype.subtract=feFpSubtract;ECFieldElementFp.prototype.multiply=feFpMultiply;ECFieldElementFp.prototype.square=feFpSquare;ECFieldElementFp.prototype.divide=feFpDivide;ECFieldElementFp.prototype.sqrt=function(){return new ECFieldElementFp((this||p).q,(this||p).x.sqrt().mod((this||p).q))};function ECPointFp(v,y,S,E){(this||p).curve=v;(this||p).x=y;(this||p).y=S;(this||p).z=E==null?BigInteger.ONE:E;(this||p).zinv=null}function pointFpGetX(){(this||p).zinv==null&&((this||p).zinv=(this||p).z.modInverse((this||p).curve.q));return(this||p).curve.fromBigInteger((this||p).x.toBigInteger().multiply((this||p).zinv).mod((this||p).curve.q))}function pointFpGetY(){(this||p).zinv==null&&((this||p).zinv=(this||p).z.modInverse((this||p).curve.q));return(this||p).curve.fromBigInteger((this||p).y.toBigInteger().multiply((this||p).zinv).mod((this||p).curve.q))}function pointFpEquals(v){if(v==(this||p))return true;if(this.isInfinity())return v.isInfinity();if(v.isInfinity())return this.isInfinity();var y,S;y=v.y.toBigInteger().multiply((this||p).z).subtract((this||p).y.toBigInteger().multiply(v.z)).mod((this||p).curve.q);if(!y.equals(BigInteger.ZERO))return false;S=v.x.toBigInteger().multiply((this||p).z).subtract((this||p).x.toBigInteger().multiply(v.z)).mod((this||p).curve.q);return S.equals(BigInteger.ZERO)}function pointFpIsInfinity(){return(this||p).x==null&&(this||p).y==null||(this||p).z.equals(BigInteger.ZERO)&&!(this||p).y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp((this||p).curve,(this||p).x,(this||p).y.negate(),(this||p).z)}function pointFpAdd(v){if(this.isInfinity())return v;if(v.isInfinity())return this||p;var y=v.y.toBigInteger().multiply((this||p).z).subtract((this||p).y.toBigInteger().multiply(v.z)).mod((this||p).curve.q);var S=v.x.toBigInteger().multiply((this||p).z).subtract((this||p).x.toBigInteger().multiply(v.z)).mod((this||p).curve.q);if(BigInteger.ZERO.equals(S))return BigInteger.ZERO.equals(y)?this.twice():(this||p).curve.getInfinity();var E=new BigInteger("3");var F=(this||p).x.toBigInteger();var C=(this||p).y.toBigInteger();v.x.toBigInteger();v.y.toBigInteger();var B=S.square();var D=B.multiply(S);var P=F.multiply(B);var R=y.square().multiply((this||p).z);var T=R.subtract(P.shiftLeft(1)).multiply(v.z).subtract(D).multiply(S).mod((this||p).curve.q);var N=P.multiply(E).multiply(y).subtract(C.multiply(D)).subtract(R.multiply(y)).multiply(v.z).add(y.multiply(D)).mod((this||p).curve.q);var O=D.multiply((this||p).z).multiply(v.z).mod((this||p).curve.q);return new ECPointFp((this||p).curve,(this||p).curve.fromBigInteger(T),(this||p).curve.fromBigInteger(N),O)}function pointFpTwice(){if(this.isInfinity())return this||p;if((this||p).y.toBigInteger().signum()==0)return(this||p).curve.getInfinity();var v=new BigInteger("3");var y=(this||p).x.toBigInteger();var S=(this||p).y.toBigInteger();var E=S.multiply((this||p).z);var F=E.multiply(S).mod((this||p).curve.q);var C=(this||p).curve.a.toBigInteger();var B=y.square().multiply(v);BigInteger.ZERO.equals(C)||(B=B.add((this||p).z.square().multiply(C)));B=B.mod((this||p).curve.q);var D=B.square().subtract(y.shiftLeft(3).multiply(F)).shiftLeft(1).multiply(E).mod((this||p).curve.q);var P=B.multiply(v).multiply(y).subtract(F.shiftLeft(1)).shiftLeft(2).multiply(F).subtract(B.square().multiply(B)).mod((this||p).curve.q);var R=E.square().multiply(E).shiftLeft(3).mod((this||p).curve.q);return new ECPointFp((this||p).curve,(this||p).curve.fromBigInteger(D),(this||p).curve.fromBigInteger(P),R)}function pointFpMultiply(v){if(this.isInfinity())return this||p;if(v.signum()==0)return(this||p).curve.getInfinity();var y=v;var S=y.multiply(new BigInteger("3"));var E=this.negate();var F=this||p;var C=(this||p).curve.q.subtract(v);var B=C.multiply(new BigInteger("3"));var D=new ECPointFp((this||p).curve,(this||p).x,(this||p).y);var P=D.negate();var R;for(R=S.bitLength()-2;R>0;--R){F=F.twice();var T=S.testBit(R);var N=y.testBit(R);T!=N&&(F=F.add(T?this||p:E))}for(R=B.bitLength()-2;R>0;--R){D=D.twice();var O=B.testBit(R);var V=C.testBit(R);O!=V&&(D=D.add(O?D:P))}return F}function pointFpMultiplyTwo(v,y,S){var E;E=v.bitLength()>S.bitLength()?v.bitLength()-1:S.bitLength()-1;var F=(this||p).curve.getInfinity();var C=this.add(y);while(E>=0){F=F.twice();v.testBit(E)?F=S.testBit(E)?F.add(C):F.add(this||p):S.testBit(E)&&(F=F.add(y));--E}return F}ECPointFp.prototype.getX=pointFpGetX;ECPointFp.prototype.getY=pointFpGetY;ECPointFp.prototype.equals=pointFpEquals;ECPointFp.prototype.isInfinity=pointFpIsInfinity;ECPointFp.prototype.negate=pointFpNegate;ECPointFp.prototype.add=pointFpAdd;ECPointFp.prototype.twice=pointFpTwice;ECPointFp.prototype.multiply=pointFpMultiply;ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo;function ECCurveFp(v,y,S){(this||p).q=v;(this||p).a=this.fromBigInteger(y);(this||p).b=this.fromBigInteger(S);(this||p).infinity=new ECPointFp(this||p,null,null)}function curveFpGetQ(){return(this||p).q}function curveFpGetA(){return(this||p).a}function curveFpGetB(){return(this||p).b}function curveFpEquals(v){return v==(this||p)||(this||p).q.equals(v.q)&&(this||p).a.equals(v.a)&&(this||p).b.equals(v.b)}function curveFpGetInfinity(){return(this||p).infinity}function curveFpFromBigInteger(v){return new ECFieldElementFp((this||p).q,v)}function curveFpDecodePointHex(v){switch(parseInt(v.substr(0,2),16)){case 0:return(this||p).infinity;case 2:case 3:var y=v.substr(0,2);v.substr(2);var S=this.fromBigInteger(new BigInteger(P,16));var E=this.getA();var F=this.getB();var C=S.square().add(E).multiply(S).add(F);var B=C.sqrt();y=="03"&&(B=B.negate());return new ECPointFp(this||p,S,B);case 4:case 6:case 7:var D=(v.length-2)/2;var P=v.substr(2,D);var R=v.substr(D+2,D);return new ECPointFp(this||p,this.fromBigInteger(new BigInteger(P,16)),this.fromBigInteger(new BigInteger(R,16)));default:return null}}ECCurveFp.prototype.getQ=curveFpGetQ;ECCurveFp.prototype.getA=curveFpGetA;ECCurveFp.prototype.getB=curveFpGetB;ECCurveFp.prototype.equals=curveFpEquals;ECCurveFp.prototype.getInfinity=curveFpGetInfinity;ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger;ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex;ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};ECPointFp.prototype.getEncoded=function(v){var d=function(v,p){var y=v.toByteArrayUnsigned();if(p<y.length)y=y.slice(y.length-p);else while(p>y.length)y.unshift(0);return y};var p=this.getX().toBigInteger();var y=this.getY().toBigInteger();var S=d(p,32);if(v)y.isEven()?S.unshift(2):S.unshift(3);else{S.unshift(4);S=S.concat(d(y,32))}return S};ECPointFp.decodeFrom=function(v,p){p[0];var y=p.length-1;var S=p.slice(1,1+y/2);var E=p.slice(1+y/2,1+y);S.unshift(0);E.unshift(0);var F=new BigInteger(S);var C=new BigInteger(E);return new ECPointFp(v,v.fromBigInteger(F),v.fromBigInteger(C))};ECPointFp.decodeFromHex=function(v,p){p.substr(0,2);var y=p.length-2;var S=p.substr(2,y/2);var E=p.substr(2+y/2,y/2);var F=new BigInteger(S,16);var C=new BigInteger(E,16);return new ECPointFp(v,v.fromBigInteger(F),v.fromBigInteger(C))};ECPointFp.prototype.add2D=function(v){if(this.isInfinity())return v;if(v.isInfinity())return this||p;if((this||p).x.equals(v.x))return(this||p).y.equals(v.y)?this.twice():(this||p).curve.getInfinity();var y=v.x.subtract((this||p).x);var S=v.y.subtract((this||p).y);var E=S.divide(y);var F=E.square().subtract((this||p).x).subtract(v.x);var C=E.multiply((this||p).x.subtract(F)).subtract((this||p).y);return new ECPointFp((this||p).curve,F,C)};ECPointFp.prototype.twice2D=function(){if(this.isInfinity())return this||p;if((this||p).y.toBigInteger().signum()==0)return(this||p).curve.getInfinity();var v=(this||p).curve.fromBigInteger(BigInteger.valueOf(2));var y=(this||p).curve.fromBigInteger(BigInteger.valueOf(3));var S=(this||p).x.square().multiply(y).add((this||p).curve.a).divide((this||p).y.multiply(v));var E=S.square().subtract((this||p).x.multiply(v));var F=S.multiply((this||p).x.subtract(E)).subtract((this||p).y);return new ECPointFp((this||p).curve,E,F)};ECPointFp.prototype.multiply2D=function(v){if(this.isInfinity())return this||p;if(v.signum()==0)return(this||p).curve.getInfinity();var y=v;var S=y.multiply(new BigInteger("3"));var E=this.negate();var F=this||p;var C;for(C=S.bitLength()-2;C>0;--C){F=F.twice();var B=S.testBit(C);var D=y.testBit(C);B!=D&&(F=F.add2D(B?this||p:E))}return F};ECPointFp.prototype.isOnCurve=function(){var v=this.getX().toBigInteger();var y=this.getY().toBigInteger();var S=(this||p).curve.getA().toBigInteger();var E=(this||p).curve.getB().toBigInteger();var F=(this||p).curve.getQ();var C=y.multiply(y).mod(F);var B=v.multiply(v).multiply(v).add(S.multiply(v)).add(E).mod(F);return C.equals(B)};ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};ECPointFp.prototype.validate=function(){var v=(this||p).curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var y=this.getX().toBigInteger();var S=this.getY().toBigInteger();if(y.compareTo(BigInteger.ONE)<0||y.compareTo(v.subtract(BigInteger.ONE))>0)throw new Error("x coordinate out of bounds");if(S.compareTo(BigInteger.ONE)<0||S.compareTo(v.subtract(BigInteger.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(v).isInfinity())throw new Error("Point is not a scalar multiple of G.");return true};var rt=function(){var v="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";var p='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';var y='(?:"'+p+'*")';var S=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+v+"|"+y+")","g");var E=new RegExp("\\\\(?:([^u])|u(.{4}))","g");var F={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function h(v,p,y){return p?F[p]:String.fromCharCode(parseInt(y,16))}var C=new String("");var B="\\";var D=Object.hasOwnProperty;return function(v,p){var y=v.match(S);var F;var P=y[0];var R=false;if("{"===P)F={};else if("["===P)F=[];else{F=[];R=true}var T;var N=[F];for(var O=1-R,V=y.length;O<V;++O){P=y[O];var L;switch(P.charCodeAt(0)){default:L=N[0];L[T||L.length]=+P;T=void 0;break;case 34:P=P.substring(1,P.length-1);P.indexOf(B)!==-1&&(P=P.replace(E,h));L=N[0];if(!T){if(!(L instanceof Array)){T=P||C;break}T=L.length}L[T]=P;T=void 0;break;case 91:L=N[0];N.unshift(L[T||L.length]=[]);T=void 0;break;case 93:N.shift();break;case 102:L=N[0];L[T||L.length]=false;T=void 0;break;case 110:L=N[0];L[T||L.length]=null;T=void 0;break;case 116:L=N[0];L[T||L.length]=true;T=void 0;break;case 123:L=N[0];N.unshift(L[T||L.length]={});T=void 0;break;case 125:N.shift();break}}if(R){if(N.length!==1)throw new Error;F=F[0]}else if(N.length)throw new Error;if(p){var s=function(v,y){var S=v[y];if(S&&typeof S==="object"){var E=null;for(var F in S)if(D.call(S,F)&&S!==v){var C=s(S,F);if(C!==void 0)S[F]=C;else{E||(E=[]);E.push(F)}}if(E)for(var B=E.length;--B>=0;)delete S[E[B]]}return p.call(v,y,S)};F=s({"":F},"")}return F}}();typeof nt!="undefined"&&nt||(nt={});typeof nt.asn1!="undefined"&&nt.asn1||(nt.asn1={});nt.asn1.ASN1Util=new function(){(this||p).integerToByteHex=function(v){var p=v.toString(16);p.length%2==1&&(p="0"+p);return p};(this||p).bigIntToMinTwosComplementsHex=function(v){return twoscompl(v)};(this||p).getPEMStringFromHex=function(v,p){return hextopem(v,p)};(this||p).newObject=function(v){var p=nt,y=p.asn1,S=y.ASN1Object,E=y.DERBoolean,F=y.DERInteger,C=y.DERBitString,B=y.DEROctetString,D=y.DERNull,P=y.DERObjectIdentifier,R=y.DEREnumerated,T=y.DERUTF8String,N=y.DERNumericString,O=y.DERPrintableString,V=y.DERTeletexString,L=y.DERIA5String,M=y.DERUTCTime,_=y.DERGeneralizedTime,U=y.DERVisibleString,G=y.DERBMPString,X=y.DERSequence,W=y.DERSet,J=y.DERTaggedObject,$=y.ASN1Util.newObject;if(v instanceof y.ASN1Object)return v;var Y=Object.keys(v);if(Y.length!=1)throw new Error("key of param shall be only one.");var Z=Y[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+Z+":")==-1)throw new Error("undefined key: "+Z);if(Z=="bool")return new E(v[Z]);if(Z=="int")return new F(v[Z]);if(Z=="bitstr")return new C(v[Z]);if(Z=="octstr")return new B(v[Z]);if(Z=="null")return new D(v[Z]);if(Z=="oid")return new P(v[Z]);if(Z=="enum")return new R(v[Z]);if(Z=="utf8str")return new T(v[Z]);if(Z=="numstr")return new N(v[Z]);if(Z=="prnstr")return new O(v[Z]);if(Z=="telstr")return new V(v[Z]);if(Z=="ia5str")return new L(v[Z]);if(Z=="utctime")return new M(v[Z]);if(Z=="gentime")return new _(v[Z]);if(Z=="visstr")return new U(v[Z]);if(Z=="bmpstr")return new G(v[Z]);if(Z=="asn1")return new S(v[Z]);if(Z=="seq"){var Q=v[Z];var tt=[];for(var et=0;et<Q.length;et++){var rt=$(Q[et]);tt.push(rt)}return new X({array:tt})}if(Z=="set"){Q=v[Z];tt=[];for(et=0;et<Q.length;et++){rt=$(Q[et]);tt.push(rt)}return new W({array:tt})}if(Z=="tag"){var it=v[Z];if(Object.prototype.toString.call(it)==="[object Array]"&&it.length==3){var st=$(it[2]);return new J({tag:it[0],explicit:it[1],obj:st})}return new J(it)}};(this||p).jsonToASN1HEX=function(v){var p=this.newObject(v);return p.tohex()}};nt.asn1.ASN1Util.oidHexToInt=function(v){var p="";var y=parseInt(v.substr(0,2),16);var S=Math.floor(y/40);var E=y%40;p=S+"."+E;var F="";for(var C=2;C<v.length;C+=2){var B=parseInt(v.substr(C,2),16);var D=("00000000"+B.toString(2)).slice(-8);F+=D.substr(1,7);if(D.substr(0,1)=="0"){var P=new BigInteger(F,2);p=p+"."+P.toString(10);F=""}}return p};nt.asn1.ASN1Util.oidIntToHex=function(v){var e=function(v){var p=v.toString(16);p.length==1&&(p="0"+p);return p};var d=function(v){var p="";var y=new BigInteger(v,10);var S=y.toString(2);var E=7-S.length%7;E==7&&(E=0);var F="";for(var C=0;C<E;C++)F+="0";S=F+S;for(C=0;C<S.length-1;C+=7){var B=S.substr(C,7);C!=S.length-7&&(B="1"+B);p+=e(parseInt(B,2))}return p};if(!v.match(/^[0-9.]+$/))throw"malformed oid string: "+v;var p="";var y=v.split(".");var S=parseInt(y[0])*40+parseInt(y[1]);p+=e(S);y.splice(0,2);for(var E=0;E<y.length;E++)p+=d(y[E]);return p};nt.asn1.ASN1Object=function(v){var y="";(this||p).params=null;(this||p).getLengthHexFromValue=function(){if(typeof(this||p).hV=="undefined"||(this||p).hV==null)throw new Error("this.hV is null or undefined");if((this||p).hV.length%2==1)throw new Error("value hex must be even length: n="+y.length+",v="+(this||p).hV);var v=(this||p).hV.length/2;var S=v.toString(16);S.length%2==1&&(S="0"+S);if(v<128)return S;var E=S.length/2;if(E>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+v.toString(16));var F=128+E;return F.toString(16)+S};(this||p).tohex=function(){if((this||p).hTLV==null||(this||p).isModified){(this||p).hV=this.getFreshValueHex();(this||p).hL=this.getLengthHexFromValue();(this||p).hTLV=(this||p).hT+(this||p).hL+(this||p).hV;(this||p).isModified=false}return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).getValueHex=function(){this.tohex();return(this||p).hV};(this||p).getFreshValueHex=function(){return""};(this||p).setByParam=function(v){(this||p).params=v};if(v!=void 0&&v.tlv!=void 0){(this||p).hTLV=v.tlv;(this||p).isModified=false}};nt.asn1.DERAbstractString=function(v){nt.asn1.DERAbstractString.superclass.constructor.call(this||p);(this||p).getString=function(){return(this||p).s};(this||p).setString=function(v){(this||p).hTLV=null;(this||p).isModified=true;(this||p).s=v;(this||p).hV=utf8tohex((this||p).s).toLowerCase()};(this||p).setStringHex=function(v){(this||p).hTLV=null;(this||p).isModified=true;(this||p).s=null;(this||p).hV=v};(this||p).getFreshValueHex=function(){return(this||p).hV};typeof v!="undefined"&&(typeof v=="string"?this.setString(v):typeof v.str!="undefined"?this.setString(v.str):typeof v.hex!="undefined"&&this.setStringHex(v.hex))};extendClass(nt.asn1.DERAbstractString,nt.asn1.ASN1Object);nt.asn1.DERAbstractTime=function(v){nt.asn1.DERAbstractTime.superclass.constructor.call(this||p);(this||p).localDateToUTC=function(v){var p=v.getTime()+v.getTimezoneOffset()*6e4;var y=new Date(p);return y};(this||p).formatDate=function(v,y,S){var E=(this||p).zeroPadding;var F=this.localDateToUTC(v);var C=String(F.getFullYear());y=="utc"&&(C=C.substr(2,2));var B=E(String(F.getMonth()+1),2);var D=E(String(F.getDate()),2);var P=E(String(F.getHours()),2);var R=E(String(F.getMinutes()),2);var T=E(String(F.getSeconds()),2);var N=C+B+D+P+R+T;if(S===true){var O=F.getMilliseconds();if(O!=0){var V=E(String(O),3);V=V.replace(/[0]+$/,"");N=N+"."+V}}return N+"Z"};(this||p).zeroPadding=function(v,p){return v.length>=p?v:new Array(p-v.length+1).join("0")+v};(this||p).setByParam=function(v){(this||p).hV=null;(this||p).hTLV=null;(this||p).params=v};(this||p).getString=function(){};(this||p).setString=function(v){(this||p).hTLV=null;(this||p).isModified=true;(this||p).params==void 0&&((this||p).params={});(this||p).params.str=v};(this||p).setByDate=function(v){(this||p).hTLV=null;(this||p).isModified=true;(this||p).params==void 0&&((this||p).params={});(this||p).params.date=v};(this||p).setByDateValue=function(v,p,y,S,E,F){var C=new Date(Date.UTC(v,p-1,y,S,E,F,0));this.setByDate(C)};(this||p).getFreshValueHex=function(){return(this||p).hV}};extendClass(nt.asn1.DERAbstractTime,nt.asn1.ASN1Object);nt.asn1.DERAbstractStructured=function(v){nt.asn1.DERAbstractString.superclass.constructor.call(this||p);(this||p).setByASN1ObjectArray=function(v){(this||p).hTLV=null;(this||p).isModified=true;(this||p).asn1Array=v};(this||p).appendASN1Object=function(v){(this||p).hTLV=null;(this||p).isModified=true;(this||p).asn1Array.push(v)};(this||p).asn1Array=new Array;typeof v!="undefined"&&typeof v.array!="undefined"&&((this||p).asn1Array=v.array)};extendClass(nt.asn1.DERAbstractStructured,nt.asn1.ASN1Object);nt.asn1.DERBoolean=function(v){nt.asn1.DERBoolean.superclass.constructor.call(this||p);(this||p).hT="01";(this||p).hTLV=v==false?"010100":"0101ff"};extendClass(nt.asn1.DERBoolean,nt.asn1.ASN1Object);nt.asn1.DERInteger=function(v){nt.asn1.DERInteger.superclass.constructor.call(this||p);(this||p).hT="02";(this||p).params=null;var y=twoscompl;(this||p).setByBigInteger=function(v){(this||p).isModified=true;(this||p).params={bigint:v}};(this||p).setByInteger=function(v){(this||p).isModified=true;(this||p).params=v};(this||p).setValueHex=function(v){(this||p).isModified=true;(this||p).params={hex:v}};(this||p).getFreshValueHex=function(){var v=(this||p).params;var S=null;if(v==null)throw new Error("value not set");if(typeof v=="object"&&v.hex!=void 0){(this||p).hV=v.hex;return(this||p).hV}if(typeof v=="number")S=new BigInteger(String(v),10);else if(v.int!=void 0)S=new BigInteger(String(v.int),10);else{if(v.bigint==void 0)throw new Error("wrong parameter");S=v.bigint}(this||p).hV=y(S);return(this||p).hV};v!=void 0&&((this||p).params=v)};extendClass(nt.asn1.DERInteger,nt.asn1.ASN1Object);nt.asn1.DERBitString=function(v){if(v!==void 0&&typeof v.obj!=="undefined"){var y=nt.asn1.ASN1Util.newObject(v.obj);v.hex="00"+y.tohex()}nt.asn1.DERBitString.superclass.constructor.call(this||p);(this||p).hT="03";(this||p).setHexValueIncludingUnusedBits=function(v){(this||p).hTLV=null;(this||p).isModified=true;(this||p).hV=v};(this||p).setUnusedBitsAndHexValue=function(v,y){if(v<0||7<v)throw"unused bits shall be from 0 to 7: u = "+v;var S="0"+v;(this||p).hTLV=null;(this||p).isModified=true;(this||p).hV=S+y};(this||p).setByBinaryString=function(v){v=v.replace(/0+$/,"");var y=8-v.length%8;y==8&&(y=0);v+="0000000".substr(0,y);var S="";for(var E=0;E<v.length-1;E+=8){var F=v.substr(E,8);var C=parseInt(F,2).toString(16);C.length==1&&(C="0"+C);S+=C}(this||p).hTLV=null;(this||p).isModified=true;(this||p).hV="0"+y+S};(this||p).setByBooleanArray=function(v){var p="";for(var y=0;y<v.length;y++)v[y]==true?p+="1":p+="0";this.setByBinaryString(p)};(this||p).newFalseArray=function(v){var p=new Array(v);for(var y=0;y<v;y++)p[y]=false;return p};(this||p).getFreshValueHex=function(){return(this||p).hV};typeof v!="undefined"&&(typeof v=="string"&&v.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(v):typeof v.hex!="undefined"?this.setHexValueIncludingUnusedBits(v.hex):typeof v.bin!="undefined"?this.setByBinaryString(v.bin):typeof v.array!="undefined"&&this.setByBooleanArray(v.array))};extendClass(nt.asn1.DERBitString,nt.asn1.ASN1Object);nt.asn1.DEROctetString=function(v){if(v!==void 0&&typeof v.obj!=="undefined"){var y=nt.asn1.ASN1Util.newObject(v.obj);v.hex=y.tohex()}nt.asn1.DEROctetString.superclass.constructor.call(this||p,v);(this||p).hT="04"};extendClass(nt.asn1.DEROctetString,nt.asn1.DERAbstractString);nt.asn1.DERNull=function(){nt.asn1.DERNull.superclass.constructor.call(this||p);(this||p).hT="05";(this||p).hTLV="0500"};extendClass(nt.asn1.DERNull,nt.asn1.ASN1Object);nt.asn1.DERObjectIdentifier=function(v){nt.asn1.DERObjectIdentifier.superclass.constructor.call(this||p);(this||p).hT="06";(this||p).setValueHex=function(v){(this||p).hTLV=null;(this||p).isModified=true;(this||p).s=null;(this||p).hV=v};(this||p).setValueOidString=function(v){var y=oidtohex(v);if(y==null)throw new Error("malformed oid string: "+v);(this||p).hTLV=null;(this||p).isModified=true;(this||p).s=null;(this||p).hV=y};(this||p).setValueName=function(v){var p=nt.asn1.x509.OID.name2oid(v);if(p==="")throw new Error("DERObjectIdentifier oidName undefined: "+v);this.setValueOidString(p)};(this||p).setValueNameOrOid=function(v){v.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(v):this.setValueName(v)};(this||p).getFreshValueHex=function(){return(this||p).hV};(this||p).setByParam=function(v){typeof v==="string"?this.setValueNameOrOid(v):v.oid!==void 0?this.setValueNameOrOid(v.oid):v.name!==void 0?this.setValueNameOrOid(v.name):v.hex!==void 0&&this.setValueHex(v.hex)};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.DERObjectIdentifier,nt.asn1.ASN1Object);nt.asn1.DEREnumerated=function(v){nt.asn1.DEREnumerated.superclass.constructor.call(this||p);(this||p).hT="0a";(this||p).setByBigInteger=function(v){(this||p).hTLV=null;(this||p).isModified=true;(this||p).hV=twoscompl(v)};(this||p).setByInteger=function(v){var p=new BigInteger(String(v),10);this.setByBigInteger(p)};(this||p).setValueHex=function(v){(this||p).hV=v};(this||p).getFreshValueHex=function(){return(this||p).hV};typeof v!="undefined"&&(typeof v.int!="undefined"?this.setByInteger(v.int):typeof v=="number"?this.setByInteger(v):typeof v.hex!="undefined"&&this.setValueHex(v.hex))};extendClass(nt.asn1.DEREnumerated,nt.asn1.ASN1Object);nt.asn1.DERUTF8String=function(v){nt.asn1.DERUTF8String.superclass.constructor.call(this||p,v);(this||p).hT="0c"};extendClass(nt.asn1.DERUTF8String,nt.asn1.DERAbstractString);nt.asn1.DERNumericString=function(v){nt.asn1.DERNumericString.superclass.constructor.call(this||p,v);(this||p).hT="12"};extendClass(nt.asn1.DERNumericString,nt.asn1.DERAbstractString);nt.asn1.DERPrintableString=function(v){nt.asn1.DERPrintableString.superclass.constructor.call(this||p,v);(this||p).hT="13"};extendClass(nt.asn1.DERPrintableString,nt.asn1.DERAbstractString);nt.asn1.DERTeletexString=function(v){nt.asn1.DERTeletexString.superclass.constructor.call(this||p,v);(this||p).hT="14"};extendClass(nt.asn1.DERTeletexString,nt.asn1.DERAbstractString);nt.asn1.DERIA5String=function(v){nt.asn1.DERIA5String.superclass.constructor.call(this||p,v);(this||p).hT="16"};extendClass(nt.asn1.DERIA5String,nt.asn1.DERAbstractString);nt.asn1.DERVisibleString=function(v){nt.asn1.DERIA5String.superclass.constructor.call(this||p,v);(this||p).hT="1a"};extendClass(nt.asn1.DERVisibleString,nt.asn1.DERAbstractString);nt.asn1.DERBMPString=function(v){nt.asn1.DERBMPString.superclass.constructor.call(this||p,v);(this||p).hT="1e"};extendClass(nt.asn1.DERBMPString,nt.asn1.DERAbstractString);nt.asn1.DERUTCTime=function(v){nt.asn1.DERUTCTime.superclass.constructor.call(this||p,v);(this||p).hT="17";(this||p).params=void 0;(this||p).getFreshValueHex=function(){var v=(this||p).params;(this||p).params==void 0&&(v={date:new Date});if(typeof v=="string"){if(!v.match(/^[0-9]{12}Z$/)&&!v.match(/^[0-9]{12}\.[0-9]+Z$/))throw new Error("malformed string for UTCTime: "+v);(this||p).hV=stohex(v)}else if(v.str!=void 0)(this||p).hV=stohex(v.str);else if(v.date==void 0&&v.millis==true){var y=new Date;(this||p).hV=stohex(this.formatDate(y,"utc",true))}else if(v.date!=void 0&&v.date instanceof Date){var S=v.millis===true;(this||p).hV=stohex(this.formatDate(v.date,"utc",S))}else v instanceof Date&&((this||p).hV=stohex(this.formatDate(v,"utc")));if((this||p).hV==void 0)throw new Error("parameter not specified properly for UTCTime");return(this||p).hV};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.DERUTCTime,nt.asn1.DERAbstractTime);nt.asn1.DERGeneralizedTime=function(v){nt.asn1.DERGeneralizedTime.superclass.constructor.call(this||p,v);(this||p).hT="18";(this||p).params=v;(this||p).getFreshValueHex=function(){var v=(this||p).params;(this||p).params==void 0&&(v={date:new Date});if(typeof v=="string"){if(!v.match(/^[0-9]{14}Z$/)&&!v.match(/^[0-9]{14}\.[0-9]+Z$/))throw new Error("malformed string for GeneralizedTime: "+v);(this||p).hV=stohex(v)}else if(v.str!=void 0)(this||p).hV=stohex(v.str);else if(v.date==void 0&&v.millis==true){var y=new Date;(this||p).hV=stohex(this.formatDate(y,"gen",true))}else if(v.date!=void 0&&v.date instanceof Date){var S=v.millis===true;(this||p).hV=stohex(this.formatDate(v.date,"gen",S))}else v instanceof Date&&((this||p).hV=stohex(this.formatDate(v,"gen")));if((this||p).hV==void 0)throw new Error("parameter not specified properly for GeneralizedTime");return(this||p).hV};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.DERGeneralizedTime,nt.asn1.DERAbstractTime);nt.asn1.DERSequence=function(v){nt.asn1.DERSequence.superclass.constructor.call(this||p,v);(this||p).hT="30";(this||p).getFreshValueHex=function(){var v="";for(var y=0;y<(this||p).asn1Array.length;y++){var S=(this||p).asn1Array[y];v+=S.tohex()}(this||p).hV=v;return(this||p).hV}};extendClass(nt.asn1.DERSequence,nt.asn1.DERAbstractStructured);nt.asn1.DERSet=function(v){nt.asn1.DERSet.superclass.constructor.call(this||p,v);(this||p).hT="31";(this||p).sortFlag=true;(this||p).getFreshValueHex=function(){var v=new Array;for(var y=0;y<(this||p).asn1Array.length;y++){var S=(this||p).asn1Array[y];v.push(S.tohex())}(this||p).sortFlag==true&&v.sort();(this||p).hV=v.join("");return(this||p).hV};typeof v!="undefined"&&typeof v.sortflag!="undefined"&&v.sortflag==false&&((this||p).sortFlag=false)};extendClass(nt.asn1.DERSet,nt.asn1.DERAbstractStructured);nt.asn1.DERTaggedObject=function(v){nt.asn1.DERTaggedObject.superclass.constructor.call(this||p);var y=nt.asn1,S=it,E=S.getV,F=(S.isASN1HEX,y.ASN1Util.newObject);(this||p).hT="a0";(this||p).hV="";(this||p).isExplicit=true;(this||p).asn1Object=null;(this||p).params={tag:"a0",explicit:true};(this||p).setASN1Object=function(v,y,S){(this||p).params={tag:y,explicit:v,obj:S}};(this||p).getFreshValueHex=function(){var v=(this||p).params;v.explicit==void 0&&(v.explicit=true);if(v.tage!=void 0){v.tag=v.tage;v.explicit=true}if(v.tagi!=void 0){v.tag=v.tagi;v.explicit=false}if(v.str!=void 0)(this||p).hV=utf8tohex(v.str);else if(v.hex!=void 0)(this||p).hV=v.hex;else{if(v.obj==void 0)throw new Error("str, hex nor obj not specified");var S;v.obj instanceof y.ASN1Object?S=v.obj.tohex():typeof v.obj=="object"&&(S=F(v.obj).tohex());v.explicit?(this||p).hV=S:(this||p).hV=E(S,0)}v.tag==void 0&&(v.tag="a0");(this||p).hT=v.tag;(this||p).hTLV=null;(this||p).isModified=true;return(this||p).hV};(this||p).setByParam=function(v){(this||p).params=v};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.DERTaggedObject,nt.asn1.ASN1Object);var it=new function(){};it.getLblen=function(v,p){if(v.substr(p+2,1)!="8")return 1;var y=parseInt(v.substr(p+3,1));return y==0?-1:0<y&&y<10?y+1:-2};it.getL=function(v,p){var y=it.getLblen(v,p);return y<1?"":v.substr(p+2,y*2)};it.getVblen=function(v,p){var y,S;y=it.getL(v,p);if(y=="")return-1;S=y.substr(0,1)==="8"?new BigInteger(y.substr(2),16):new BigInteger(y,16);return S.intValue()};it.getVidx=function(v,p){var y=it.getLblen(v,p);return y<0?y:p+(y+1)*2};it.getV=function(v,p){var y=it.getVidx(v,p);var S=it.getVblen(v,p);return v.substr(y,S*2)};it.getTLV=function(v,p){return v.substr(p,2)+it.getL(v,p)+it.getV(v,p)};it.getTLVblen=function(v,p){return 2+it.getLblen(v,p)*2+it.getVblen(v,p)*2};it.getNextSiblingIdx=function(v,p){var y=it.getVidx(v,p);var S=it.getVblen(v,p);return y+S*2};it.getChildIdx=function(v,p){var y=it;var S=[];var E,F,C;E=y.getVidx(v,p);F=y.getVblen(v,p)*2;if(v.substr(p,2)=="03"){E+=2;F-=2}C=0;var B=E;while(C<=F){var D=y.getTLVblen(v,B);C+=D;C<=F&&S.push(B);B+=D;if(C>=F)break}return S};it.getNthChildIdx=function(v,p,y){var S=it.getChildIdx(v,p);return S[y]};it.getIdxbyList=function(v,p,y,S){var E=it;var F,C;if(y.length==0)return S!==void 0&&v.substr(p,2)!==S?-1:p;F=y.shift();C=E.getChildIdx(v,p);return F>=C.length?-1:E.getIdxbyList(v,C[F],y,S)};it.getIdxbyListEx=function(v,p,y,S){var E=it;var F,C;if(y.length==0)return S!==void 0&&v.substr(p,2)!==S?-1:p;F=y.shift();C=E.getChildIdx(v,p);var B=0;for(var D=0;D<C.length;D++){var P=v.substr(C[D],2);if(typeof F=="number"&&!E.isContextTag(P)&&B==F||typeof F=="string"&&E.isContextTag(P,F))return E.getIdxbyListEx(v,C[D],y,S);E.isContextTag(P)||B++}return-1};it.getTLVbyList=function(v,p,y,S){var E=it;var F=E.getIdxbyList(v,p,y,S);return F==-1||F>=v.length?null:E.getTLV(v,F)};it.getTLVbyListEx=function(v,p,y,S){var E=it;var F=E.getIdxbyListEx(v,p,y,S);return F==-1?null:E.getTLV(v,F)};it.getVbyList=function(v,p,y,S,E){var F=it;var C,B;C=F.getIdxbyList(v,p,y,S);if(C==-1)return null;if(C>=v.length)return null;B=F.getV(v,C);E===true&&(B=B.substr(2));return B};it.getVbyListEx=function(v,p,y,S,E){var F=it;var C,B;C=F.getIdxbyListEx(v,p,y,S);if(C==-1)return null;B=F.getV(v,C);v.substr(C,2)=="03"&&E!==false&&(B=B.substr(2));return B};it.getInt=function(v,p,y){y==void 0&&(y=-1);try{var S=v.substr(p,2);if(S!="02"&&S!="03")return y;var E=it.getV(v,p);return S=="02"?parseInt(E,16):bitstrtoint(E)}catch(v){return y}};it.getOID=function(v,p,y){y==void 0&&(y=null);try{if(v.substr(p,2)!="06")return y;var S=it.getV(v,p);return hextooid(S)}catch(v){return y}};it.getOIDName=function(v,p,y){y==void 0&&(y=null);try{var S=it.getOID(v,p,y);if(S==y)return y;var E=nt.asn1.x509.OID.oid2name(S);return E==""?S:E}catch(v){return y}};it.getString=function(v,p,y){y==void 0&&(y=null);try{var S=it.getV(v,p);return hextorstr(S)}catch(v){return y}};it.hextooidstr=function(v){var h=function(v,p){return v.length>=p?v:new Array(p-v.length+1).join("0")+v};var p=[];var y=v.substr(0,2);var S=parseInt(y,16);p[0]=new String(Math.floor(S/40));p[1]=new String(S%40);var E=v.substr(2);var F=[];for(var C=0;C<E.length/2;C++)F.push(parseInt(E.substr(C*2,2),16));var B=[];var D="";for(C=0;C<F.length;C++)if(F[C]&128)D+=h((F[C]&127).toString(2),7);else{D+=h((F[C]&127).toString(2),7);B.push(new String(parseInt(D,2)));D=""}var P=p.join(".");B.length>0&&(P=P+"."+B.join("."));return P};it.dump=function(v,p,y,S){var E=it;var F=E.getV;var C=E.dump;var B=E.getChildIdx;var D=v;v instanceof nt.asn1.ASN1Object&&(D=v.tohex());var q=function(v,p){if(v.length<=p*2)return v;var y=v.substr(0,p)+"..(total "+v.length/2+"bytes).."+v.substr(v.length-p,p);return y};p===void 0&&(p={ommit_long_octet:32});y===void 0&&(y=0);S===void 0&&(S="");var P=p.ommit_long_octet;var R=D.substr(y,2);if(R=="01"){var T=F(D,y);return T=="00"?S+"BOOLEAN FALSE\n":S+"BOOLEAN TRUE\n"}if(R=="02"){T=F(D,y);return S+"INTEGER "+q(T,P)+"\n"}if(R=="03"){T=F(D,y);if(E.isASN1HEX(T.substr(2))){var N=S+"BITSTRING, encapsulates\n";N+=C(T.substr(2),p,0,S+"  ");return N}return S+"BITSTRING "+q(T,P)+"\n"}if(R=="04"){T=F(D,y);if(E.isASN1HEX(T)){N=S+"OCTETSTRING, encapsulates\n";N+=C(T,p,0,S+"  ");return N}return S+"OCTETSTRING "+q(T,P)+"\n"}if(R=="05")return S+"NULL\n";if(R=="06"){var O=F(D,y);var V=nt.asn1.ASN1Util.oidHexToInt(O);var L=nt.asn1.x509.OID.oid2name(V);var M=V.replace(/\./g," ");return L!=""?S+"ObjectIdentifier "+L+" ("+M+")\n":S+"ObjectIdentifier ("+M+")\n"}if(R=="0a")return S+"ENUMERATED "+parseInt(F(D,y))+"\n";if(R=="0c")return S+"UTF8String '"+hextoutf8(F(D,y))+"'\n";if(R=="13")return S+"PrintableString '"+hextoutf8(F(D,y))+"'\n";if(R=="14")return S+"TeletexString '"+hextoutf8(F(D,y))+"'\n";if(R=="16")return S+"IA5String '"+hextoutf8(F(D,y))+"'\n";if(R=="17")return S+"UTCTime "+hextoutf8(F(D,y))+"\n";if(R=="18")return S+"GeneralizedTime "+hextoutf8(F(D,y))+"\n";if(R=="1a")return S+"VisualString '"+hextoutf8(F(D,y))+"'\n";if(R=="1e")return S+"BMPString '"+ucs2hextoutf8(F(D,y))+"'\n";if(R=="30"){if(D.substr(y,4)=="3000")return S+"SEQUENCE {}\n";N=S+"SEQUENCE\n";var _=B(D,y);var U=p;if((_.length==2||_.length==3)&&D.substr(_[0],2)=="06"&&D.substr(_[_.length-1],2)=="04"){L=E.oidname(F(D,_[0]));var G=JSON.parse(JSON.stringify(p));G.x509ExtName=L;U=G}for(var X=0;X<_.length;X++)N+=C(D,U,_[X],S+"  ");return N}if(R=="31"){N=S+"SET\n";_=B(D,y);for(X=0;X<_.length;X++)N+=C(D,p,_[X],S+"  ");return N}R=parseInt(R,16);if((R&128)!=0){var W=R&31;if((R&32)!=0){N=S+"["+W+"]\n";_=B(D,y);for(X=0;X<_.length;X++)N+=C(D,p,_[X],S+"  ");return N}T=F(D,y);if(it.isASN1HEX(T)){N=S+"["+W+"]\n";N+=C(T,p,0,S+"  ");return N}(T.substr(0,8)=="68747470"||p.x509ExtName==="subjectAltName"&&W==2)&&(T=hextoutf8(T));N=S+"["+W+"] "+T+"\n";return N}return S+"UNKNOWN("+R+") "+F(D,y)+"\n"};it.parse=function(v){var p=it,y=p.parse,S=p.isASN1HEX,E=p.getV,F=p.getTLV,C=p.getChildIdx,B=nt.asn1,D=B.ASN1Util.oidHexToInt,P=B.x509.OID.oid2name,R=hextoutf8,T=ucs2hextoutf8,N=iso88591hextoutf8;var O={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"};var u=function(v){var p=[];var S=C(v,0);for(var E=0;E<S.length;E++){var B=S[E];var D=F(v,B);var P=y(D);p.push(P)}return p};var V=v.substr(0,2);var L={};var M=E(v,0);if(V=="01")return v=="0101ff"?{bool:true}:{bool:false};if(V=="02")return{int:{hex:M}};if(V=="03")try{if(M.substr(0,2)!="00")throw"not encap";var _=M.substr(2);if(!S(_))throw"not encap";return{bitstr:{obj:y(_)}}}catch(v){var U=null;M.length<=10&&(U=bitstrtobinstr(M));return U==null?{bitstr:{hex:M}}:{bitstr:{bin:U}}}else if(V=="04")try{if(!S(M))throw"not encap";return{octstr:{obj:y(M)}}}catch(v){return{octstr:{hex:M}}}else{if(V=="05")return{null:""};if(V=="06"){var G=D(M);var X=P(G);return X==""?{oid:G}:{oid:X}}if(V=="0a")return M.length>4?{enum:{hex:M}}:{enum:parseInt(M,16)};if(V=="30"||V=="31"){L[O[V]]=u(v);return L}if(V=="14"){var W=N(M);L[O[V]]={str:W};return L}if(V=="1e"){W=T(M);L[O[V]]={str:W};return L}if(":0c:12:13:16:17:18:1a:".indexOf(V)!=-1){W=R(M);L[O[V]]={str:W};return L}if(V.match(/^8[0-9]$/)){W=R(M);return W==null|W==""||W.match(/[\x00-\x1F\x7F-\x9F]/)!=null||W.match(/[\u0000-\u001F\u0080–\u009F]/)!=null?{tag:{tag:V,explicit:false,hex:M}}:{tag:{tag:V,explicit:false,str:W}}}if(!V.match(/^a[0-9]$/)){var J=new nt.asn1.ASN1Object;J.hV=M;var $=J.getLengthHexFromValue();return{asn1:{tlv:V+$+M}}}try{if(!S(M))throw new Error("not encap");return{tag:{tag:V,explicit:true,obj:y(M)}}}catch(v){return{tag:{tag:V,explicit:true,hex:M}}}}};it.isContextTag=function(v,p){v=v.toLowerCase();var y,S;try{y=parseInt(v,16)}catch(v){return-1}if(p===void 0)return(y&192)==128;try{var E=p.match(/^\[[0-9]+\]$/);if(E==null)return false;S=parseInt(p.substr(1,p.length-1),10);return!(S>31)&&((y&192)==128&&(y&31)==S)}catch(v){return false}};it.isASN1HEX=function(v){var p=it;if(v.length%2==1)return false;var y=p.getVblen(v,0);var S=v.substr(0,2);var E=p.getL(v,0);var F=v.length-S.length-E.length;return F==y*2};it.checkStrictDER=function(v,p,y,S,E){var F=it;if(y===void 0){if(typeof v!="string")throw new Error("not hex string");v=v.toLowerCase();if(!nt.lang.String.isHex(v))throw new Error("not hex string");y=v.length;S=v.length/2;E=S<128?1:Math.ceil(S.toString(16))+1}var C=F.getL(v,p);if(C.length>E*2)throw new Error("L of TLV too long: idx="+p);var B=F.getVblen(v,p);if(B>S)throw new Error("value of L too long than hex: idx="+p);var D=F.getTLV(v,p);var P=D.length-2-F.getL(v,p).length;if(P!==B*2)throw new Error("V string length and L's value not the same:"+P+"/"+B*2);if(p===0&&v.length!=D.length)throw new Error("total length and TLV length unmatch:"+v.length+"!="+D.length);var R=v.substr(p,2);if(R==="02"){var T=F.getVidx(v,p);if(v.substr(T,2)=="00"&&v.charCodeAt(T+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(R,16)&32){var N=F.getVblen(v,p);var O=0;var V=F.getChildIdx(v,p);for(var L=0;L<V.length;L++){var M=F.getTLV(v,V[L]);O+=M.length;F.checkStrictDER(v,V[L],y,S,E)}if(N*2!=O)throw new Error("sum of children's TLV length and L unmatch: "+N*2+"!="+O)}};it.oidname=function(v){var p=nt.asn1;nt.lang.String.isHex(v)&&(v=p.ASN1Util.oidHexToInt(v));var y=p.x509.OID.oid2name(v);y===""&&(y=v);return y};typeof nt!="undefined"&&nt||(nt={});typeof nt.asn1!="undefined"&&nt.asn1||(nt.asn1={});typeof nt.asn1.x509!="undefined"&&nt.asn1.x509||(nt.asn1.x509={});nt.asn1.x509.Certificate=function(v){nt.asn1.x509.Certificate.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.DERBitString,F=S.DERSequence,C=S.x509,B=C.TBSCertificate,D=C.AlgorithmIdentifier;(this||p).params=void 0;(this||p).setByParam=function(v){(this||p).params=v};(this||p).sign=function(){var v=(this||p).params;var y=v.sigalg;v.sigalg.name!=void 0&&(y=v.sigalg.name);var S=v.tbsobj.tohex();var E=new nt.crypto.Signature({alg:y});E.init(v.cakey);E.updateHex(S);v.sighex=E.sign()};(this||p).getPEM=function(){return hextopem(this.tohex(),"CERTIFICATE")};(this||p).tohex=function(){var v=(this||p).params;v.tbsobj!=void 0&&v.tbsobj!=null||(v.tbsobj=new B(v));v.sighex==void 0&&v.cakey!=void 0&&this.sign();if(v.sighex==void 0)throw new Error("sighex or cakey parameter not defined");var y=[];y.push(v.tbsobj);y.push(new D({name:v.sigalg}));y.push(new E({hex:"00"+v.sighex}));var S=new F({array:y});return S.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.Certificate,nt.asn1.ASN1Object);nt.asn1.x509.TBSCertificate=function(v){nt.asn1.x509.TBSCertificate.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.x509,F=S.DERTaggedObject,C=S.DERInteger,B=S.DERSequence,D=E.AlgorithmIdentifier,P=E.Time,R=E.X500Name,T=E.Extensions,N=E.SubjectPublicKeyInfo;(this||p).params=null;(this||p).setByParam=function(v){(this||p).params=v};(this||p).tohex=function(){var v=[];var y=(this||p).params;if(y.version!=void 0||y.version!=1){var S=2;y.version!=void 0&&(S=y.version-1);var E=new F({obj:new C({int:S})});v.push(E)}v.push(new C(y.serial));v.push(new D({name:y.sigalg}));v.push(new R(y.issuer));v.push(new B({array:[new P(y.notbefore),new P(y.notafter)]}));v.push(new R(y.subject));v.push(new N(ot.getKey(y.sbjpubkey)));y.ext!==void 0&&y.ext.length>0&&v.push(new F({tag:"a3",obj:new T(y.ext)}));var O=new nt.asn1.DERSequence({array:v});return O.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.x509.TBSCertificate,nt.asn1.ASN1Object);nt.asn1.x509.Extensions=function(v){nt.asn1.x509.Extensions.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.DERSequence,F=S.x509;(this||p).aParam=[];(this||p).setByParam=function(v){(this||p).aParam=v};(this||p).tohex=function(){var v=[];for(var y=0;y<(this||p).aParam.length;y++){var S=(this||p).aParam[y];var C=S.extname;var B=null;if(S.extn!=void 0)B=new F.PrivateExtension(S);else if(C=="subjectKeyIdentifier")B=new F.SubjectKeyIdentifier(S);else if(C=="keyUsage")B=new F.KeyUsage(S);else if(C=="subjectAltName")B=new F.SubjectAltName(S);else if(C=="issuerAltName")B=new F.IssuerAltName(S);else if(C=="basicConstraints")B=new F.BasicConstraints(S);else if(C=="nameConstraints")B=new F.NameConstraints(S);else if(C=="cRLDistributionPoints")B=new F.CRLDistributionPoints(S);else if(C=="certificatePolicies")B=new F.CertificatePolicies(S);else if(C=="policyMappings")B=new F.PolicyMappings(S);else if(C=="policyConstraints")B=new F.PolicyConstraints(S);else if(C=="inhibitAnyPolicy")B=new F.InhibitAnyPolicy(S);else if(C=="authorityKeyIdentifier")B=new F.AuthorityKeyIdentifier(S);else if(C=="extKeyUsage")B=new F.ExtKeyUsage(S);else if(C=="authorityInfoAccess")B=new F.AuthorityInfoAccess(S);else if(C=="cRLNumber")B=new F.CRLNumber(S);else if(C=="cRLReason")B=new F.CRLReason(S);else if(C=="ocspNonce")B=new F.OCSPNonce(S);else if(C=="ocspNoCheck")B=new F.OCSPNoCheck(S);else if(C=="adobeTimeStamp")B=new F.AdobeTimeStamp(S);else{if(C!="subjectDirectoryAttributes")throw new Error("extension not supported:"+JSON.stringify(S));B=new F.SubjectDirectoryAttributes(S)}B!=null&&v.push(B)}var D=new E({array:v});return D.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.x509.Extensions,nt.asn1.ASN1Object);nt.asn1.x509.Extension=function(v){nt.asn1.x509.Extension.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.DERObjectIdentifier,F=S.DEROctetString,C=(S.DERBitString,S.DERBoolean),B=S.DERSequence;(this||p).tohex=function(){var v=new E({oid:(this||p).oid});var y=new F({hex:this.getExtnValueHex()});var S=new Array;S.push(v);(this||p).critical&&S.push(new C);S.push(y);var D=new B({array:S});return D.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).critical=false;v!==void 0&&v.critical!==void 0&&((this||p).critical=v.critical)};extendClass(nt.asn1.x509.Extension,nt.asn1.ASN1Object);nt.asn1.x509.KeyUsage=function(v){nt.asn1.x509.KeyUsage.superclass.constructor.call(this||p,v);var y=Error;var S={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};(this||p).getExtnValueHex=function(){var v=this.getBinValue();(this||p).asn1ExtnValue=new nt.asn1.DERBitString({bin:v});return(this||p).asn1ExtnValue.tohex()};(this||p).getBinValue=function(){var v=(this||p).params;if(typeof v!="object"||typeof v.names!="object"&&typeof v.bin!="string")throw new y("parameter not yet set");if(v.names!=void 0)return namearraytobinstr(v.names,S);if(v.bin!=void 0)return v.bin;throw new y("parameter not set properly")};(this||p).oid="2.5.29.15";v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.KeyUsage,nt.asn1.x509.Extension);nt.asn1.x509.BasicConstraints=function(v){nt.asn1.x509.BasicConstraints.superclass.constructor.call(this||p,v);var y=nt.asn1,S=y.DERBoolean,E=y.DERInteger,F=y.DERSequence;(this||p).getExtnValueHex=function(){var v=new Array;(this||p).cA&&v.push(new S);(this||p).pathLen>-1&&v.push(new E({int:(this||p).pathLen}));var y=new F({array:v});(this||p).asn1ExtnValue=y;return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.19";(this||p).cA=false;(this||p).pathLen=-1;if(v!==void 0){v.cA!==void 0&&((this||p).cA=v.cA);v.pathLen!==void 0&&((this||p).pathLen=v.pathLen)}};extendClass(nt.asn1.x509.BasicConstraints,nt.asn1.x509.Extension);nt.asn1.x509.CRLDistributionPoints=function(v){nt.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this||p,v);var y=nt,S=y.asn1,E=S.x509;(this||p).getExtnValueHex=function(){return(this||p).asn1ExtnValue.tohex()};(this||p).setByDPArray=function(v){var y=[];for(var F=0;F<v.length;F++)if(v[F]instanceof nt.asn1.ASN1Object)y.push(v[F]);else{var C=new E.DistributionPoint(v[F]);y.push(C)}(this||p).asn1ExtnValue=new S.DERSequence({array:y})};(this||p).setByOneURI=function(v){var p=new E.DistributionPoint({fulluri:v});this.setByDPArray([p])};(this||p).oid="2.5.29.31";v!==void 0&&(v.array!==void 0?this.setByDPArray(v.array):v.uri!==void 0&&this.setByOneURI(v.uri))};extendClass(nt.asn1.x509.CRLDistributionPoints,nt.asn1.x509.Extension);nt.asn1.x509.DistributionPoint=function(v){nt.asn1.x509.DistributionPoint.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.x509.DistributionPointName;(this||p).tohex=function(){var v=new S.DERSequence;if((this||p).asn1DP!=null){var y=new S.DERTaggedObject({explicit:true,tag:"a0",obj:(this||p).asn1DP});v.appendASN1Object(y)}(this||p).hTLV=v.tohex();return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&(v.dpobj!==void 0?(this||p).asn1DP=v.dpobj:v.dpname!==void 0?(this||p).asn1DP=new E(v.dpname):v.fulluri!==void 0&&((this||p).asn1DP=new E({full:[{uri:v.fulluri}]})))};extendClass(nt.asn1.x509.DistributionPoint,nt.asn1.ASN1Object);nt.asn1.x509.DistributionPointName=function(v){nt.asn1.x509.DistributionPointName.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.DERTaggedObject;(this||p).tohex=function(){if((this||p).type!="full")throw new Error("currently type shall be 'full': "+(this||p).type);(this||p).asn1Obj=new E({explicit:false,tag:(this||p).tag,obj:(this||p).asn1V});(this||p).hTLV=(this||p).asn1Obj.tohex();return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};if(v!==void 0)if(S.x509.GeneralNames.prototype.isPrototypeOf(v)){(this||p).type="full";(this||p).tag="a0";(this||p).asn1V=v}else{if(v.full===void 0)throw new Error("This class supports GeneralNames only as argument");(this||p).type="full";(this||p).tag="a0";(this||p).asn1V=new S.x509.GeneralNames(v.full)}};extendClass(nt.asn1.x509.DistributionPointName,nt.asn1.ASN1Object);nt.asn1.x509.CertificatePolicies=function(v){nt.asn1.x509.CertificatePolicies.superclass.constructor.call(this||p,v);var y=nt,S=y.asn1,E=S.x509,F=S.DERSequence,C=E.PolicyInformation;(this||p).params=null;(this||p).getExtnValueHex=function(){var v=[];for(var y=0;y<(this||p).params.array.length;y++)v.push(new C((this||p).params.array[y]));var S=new F({array:v});(this||p).asn1ExtnValue=S;return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.32";v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.CertificatePolicies,nt.asn1.x509.Extension);nt.asn1.x509.PolicyInformation=function(v){nt.asn1.x509.PolicyInformation.superclass.constructor.call(this||p,v);var y=nt.asn1,S=y.DERSequence,E=y.DERObjectIdentifier,F=y.x509.PolicyQualifierInfo;(this||p).params=null;(this||p).tohex=function(){if((this||p).params.policyoid===void 0&&(this||p).params.array===void 0)throw new Error("parameter oid and array missing");var v=[new E((this||p).params.policyoid)];if((this||p).params.array!==void 0){var y=[];for(var C=0;C<(this||p).params.array.length;C++)y.push(new F((this||p).params.array[C]));y.length>0&&v.push(new S({array:y}))}var B=new S({array:v});return B.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.PolicyInformation,nt.asn1.ASN1Object);nt.asn1.x509.PolicyQualifierInfo=function(v){nt.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this||p,v);var y=nt.asn1,S=y.DERSequence,E=y.DERIA5String,F=y.DERObjectIdentifier,C=y.x509.UserNotice;(this||p).params=null;(this||p).tohex=function(){if((this||p).params.cps!==void 0){var v=new S({array:[new F({oid:"1.3.6.1.5.5.7.2.1"}),new E({str:(this||p).params.cps})]});return v.tohex()}if((this||p).params.unotice!=void 0){v=new S({array:[new F({oid:"1.3.6.1.5.5.7.2.2"}),new C((this||p).params.unotice)]});return v.tohex()}};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.PolicyQualifierInfo,nt.asn1.ASN1Object);nt.asn1.x509.UserNotice=function(v){nt.asn1.x509.UserNotice.superclass.constructor.call(this||p,v);var y=nt.asn1.DERSequence,S=(nt.asn1.DERInteger,nt.asn1.x509.DisplayText),E=nt.asn1.x509.NoticeReference;(this||p).params=null;(this||p).tohex=function(){var v=[];(this||p).params.noticeref!==void 0&&v.push(new E((this||p).params.noticeref));(this||p).params.exptext!==void 0&&v.push(new S((this||p).params.exptext));var F=new y({array:v});return F.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.UserNotice,nt.asn1.ASN1Object);nt.asn1.x509.NoticeReference=function(v){nt.asn1.x509.NoticeReference.superclass.constructor.call(this||p,v);var y=nt.asn1.DERSequence,S=nt.asn1.DERInteger,E=nt.asn1.x509.DisplayText;(this||p).params=null;(this||p).tohex=function(){var v=[];(this||p).params.org!==void 0&&v.push(new E((this||p).params.org));if((this||p).params.noticenum!==void 0){var F=[];var C=(this||p).params.noticenum;for(var B=0;B<C.length;B++)F.push(new S(C[B]));v.push(new y({array:F}))}if(v.length==0)throw new Error("parameter is empty");var D=new y({array:v});return D.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.NoticeReference,nt.asn1.ASN1Object);nt.asn1.x509.DisplayText=function(v){nt.asn1.x509.DisplayText.superclass.constructor.call(this||p,v);(this||p).hT="0c";v!==void 0&&(v.type==="ia5"?(this||p).hT="16":v.type==="vis"?(this||p).hT="1a":v.type==="bmp"&&((this||p).hT="1e"))};extendClass(nt.asn1.x509.DisplayText,nt.asn1.DERAbstractString);nt.asn1.x509.PolicyMappings=function(v){nt.asn1.x509.PolicyMappings.superclass.constructor.call(this||p,v);var y=nt,S=y.asn1,E=(S.x509,S.ASN1Util.newObject);(this||p).params=null;(this||p).getExtnValueHex=function(){var v=(this||p).params;var y=[];for(var S=0;S<v.array.length;S++){var F=v.array[S];y.push({seq:[{oid:F[0]},{oid:F[1]}]})}(this||p).asn1ExtnValue=E({seq:y});return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.33";v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.PolicyMappings,nt.asn1.x509.Extension);nt.asn1.x509.PolicyConstraints=function(v){nt.asn1.x509.PolicyConstraints.superclass.constructor.call(this||p,v);var y=nt,S=y.asn1,E=(S.x509,S.ASN1Util.newObject);(this||p).params=null;(this||p).getExtnValueHex=function(){var v=(this||p).params;var y=[];v.reqexp!=void 0&&y.push({tag:{tagi:"80",obj:{int:v.reqexp}}});v.inhibit!=void 0&&y.push({tag:{tagi:"81",obj:{int:v.inhibit}}});(this||p).asn1ExtnValue=E({seq:y});return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.36";v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.PolicyConstraints,nt.asn1.x509.Extension);nt.asn1.x509.InhibitAnyPolicy=function(v){nt.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this||p,v);var y=nt,S=y.asn1,E=(S.x509,S.ASN1Util.newObject);(this||p).params=null;(this||p).getExtnValueHex=function(){(this||p).asn1ExtnValue=E({int:(this||p).params.skip});return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.54";v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.InhibitAnyPolicy,nt.asn1.x509.Extension);nt.asn1.x509.NameConstraints=function(v){nt.asn1.x509.NameConstraints.superclass.constructor.call(this||p,v);var y=nt,S=y.asn1,E=S.x509,F=S.ASN1Util.newObject,C=E.GeneralSubtree;(this||p).params=null;(this||p).getExtnValueHex=function(){var v=(this||p).params;var y=[];if(v.permit!=void 0&&v.permit.length!=void 0){var S=[];for(var E=0;E<v.permit.length;E++)S.push(new C(v.permit[E]));y.push({tag:{tagi:"a0",obj:{seq:S}}})}if(v.exclude!=void 0&&v.exclude.length!=void 0){var B=[];for(E=0;E<v.exclude.length;E++)B.push(new C(v.exclude[E]));y.push({tag:{tagi:"a1",obj:{seq:B}}})}(this||p).asn1ExtnValue=F({seq:y});return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.30";v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.NameConstraints,nt.asn1.x509.Extension);nt.asn1.x509.GeneralSubtree=function(v){nt.asn1.x509.GeneralSubtree.superclass.constructor.call(this||p);var y=nt.asn1,S=y.x509,E=S.GeneralName,F=y.ASN1Util.newObject;(this||p).params=null;(this||p).setByParam=function(v){(this||p).params=v};(this||p).tohex=function(){var v=(this||p).params;var y=[new E(v)];v.min!=void 0&&y.push({tag:{tagi:"80",obj:{int:v.min}}});v.max!=void 0&&y.push({tag:{tagi:"81",obj:{int:v.max}}});var S=F({seq:y});return S.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.x509.GeneralSubtree,nt.asn1.ASN1Object);nt.asn1.x509.ExtKeyUsage=function(v){nt.asn1.x509.ExtKeyUsage.superclass.constructor.call(this||p,v);var y=nt,S=y.asn1;(this||p).setPurposeArray=function(v){(this||p).asn1ExtnValue=new S.DERSequence;for(var y=0;y<v.length;y++){var E=new S.DERObjectIdentifier(v[y]);(this||p).asn1ExtnValue.appendASN1Object(E)}};(this||p).getExtnValueHex=function(){return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.37";v!==void 0&&v.array!==void 0&&this.setPurposeArray(v.array)};extendClass(nt.asn1.x509.ExtKeyUsage,nt.asn1.x509.Extension);nt.asn1.x509.AuthorityKeyIdentifier=function(v){nt.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this||p,v);var y=nt,S=y.asn1,E=S.DERTaggedObject,F=S.x509.GeneralNames;y.crypto.Util.isKey;(this||p).asn1KID=null;(this||p).asn1CertIssuer=null;(this||p).asn1CertSN=null;(this||p).getExtnValueHex=function(){var v=new Array;(this||p).asn1KID&&v.push(new E({explicit:false,tag:"80",obj:(this||p).asn1KID}));(this||p).asn1CertIssuer&&v.push(new E({explicit:false,tag:"a1",obj:new F([{dn:(this||p).asn1CertIssuer}])}));(this||p).asn1CertSN&&v.push(new E({explicit:false,tag:"82",obj:(this||p).asn1CertSN}));var y=new S.DERSequence({array:v});(this||p).asn1ExtnValue=y;return(this||p).asn1ExtnValue.tohex()};(this||p).setKIDByParam=function(v){if(v.str!==void 0||v.hex!==void 0)(this||p).asn1KID=new nt.asn1.DEROctetString(v);else if(typeof v==="object"&&nt.crypto.Util.isKey(v)||typeof v==="string"&&v.indexOf("BEGIN ")!=-1){var y=v;typeof v==="string"&&(y=ot.getKey(v));var S=ot.getKeyID(y);(this||p).asn1KID=new nt.asn1.DEROctetString({hex:S})}};(this||p).setCertIssuerByParam=function(v){v.str!==void 0||v.ldapstr!==void 0||v.hex!==void 0||v.certsubject!==void 0||v.certissuer!==void 0?(this||p).asn1CertIssuer=new nt.asn1.x509.X500Name(v):typeof v==="string"&&v.indexOf("BEGIN ")!=-1&&v.indexOf("CERTIFICATE")!=-1&&((this||p).asn1CertIssuer=new nt.asn1.x509.X500Name({certissuer:v}))};(this||p).setCertSNByParam=function(v){if(v.str!==void 0||v.bigint!==void 0||v.hex!==void 0)(this||p).asn1CertSN=new nt.asn1.DERInteger(v);else if(typeof v==="string"&&v.indexOf("BEGIN ")!=-1&&v.indexOf("CERTIFICATE")){var y=new X509;y.readCertPEM(v);var S=y.getSerialNumberHex();(this||p).asn1CertSN=new nt.asn1.DERInteger({hex:S})}};(this||p).oid="2.5.29.35";if(v!==void 0){v.kid!==void 0&&this.setKIDByParam(v.kid);v.issuer!==void 0&&this.setCertIssuerByParam(v.issuer);v.sn!==void 0&&this.setCertSNByParam(v.sn);if(v.issuersn!==void 0&&typeof v.issuersn==="string"&&v.issuersn.indexOf("BEGIN ")!=-1&&v.issuersn.indexOf("CERTIFICATE")){this.setCertSNByParam(v.issuersn);this.setCertIssuerByParam(v.issuersn)}}};extendClass(nt.asn1.x509.AuthorityKeyIdentifier,nt.asn1.x509.Extension);nt.asn1.x509.SubjectKeyIdentifier=function(v){nt.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this||p,v);var y=nt,S=y.asn1,E=S.DEROctetString;(this||p).asn1KID=null;(this||p).getExtnValueHex=function(){(this||p).asn1ExtnValue=(this||p).asn1KID;return(this||p).asn1ExtnValue.tohex()};(this||p).setKIDByParam=function(v){if(v.str!==void 0||v.hex!==void 0)(this||p).asn1KID=new E(v);else if(typeof v==="object"&&nt.crypto.Util.isKey(v)||typeof v==="string"&&v.indexOf("BEGIN")!=-1){var y=v;typeof v==="string"&&(y=ot.getKey(v));var S=ot.getKeyID(y);(this||p).asn1KID=new nt.asn1.DEROctetString({hex:S})}};(this||p).oid="2.5.29.14";v!==void 0&&v.kid!==void 0&&this.setKIDByParam(v.kid)};extendClass(nt.asn1.x509.SubjectKeyIdentifier,nt.asn1.x509.Extension);nt.asn1.x509.AuthorityInfoAccess=function(v){nt.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this||p,v);(this||p).setAccessDescriptionArray=function(v){var y=new Array,S=nt,E=S.asn1,F=E.DERSequence,C=E.DERObjectIdentifier,B=E.x509.GeneralName;for(var D=0;D<v.length;D++){var P;var R=v[D];if(R.ocsp!==void 0)P=new F({array:[new C({oid:"1.3.6.1.5.5.7.48.1"}),new B({uri:R.ocsp})]});else{if(R.caissuer===void 0)throw new Error("unknown AccessMethod parameter: "+JSON.stringify(R));P=new F({array:[new C({oid:"1.3.6.1.5.5.7.48.2"}),new B({uri:R.caissuer})]})}y.push(P)}(this||p).asn1ExtnValue=new F({array:y})};(this||p).getExtnValueHex=function(){return(this||p).asn1ExtnValue.tohex()};(this||p).oid="1.3.6.1.5.5.7.1.1";v!==void 0&&v.array!==void 0&&this.setAccessDescriptionArray(v.array)};extendClass(nt.asn1.x509.AuthorityInfoAccess,nt.asn1.x509.Extension);nt.asn1.x509.SubjectAltName=function(v){nt.asn1.x509.SubjectAltName.superclass.constructor.call(this||p,v);(this||p).setNameArray=function(v){(this||p).asn1ExtnValue=new nt.asn1.x509.GeneralNames(v)};(this||p).getExtnValueHex=function(){return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.17";v!==void 0&&v.array!==void 0&&this.setNameArray(v.array)};extendClass(nt.asn1.x509.SubjectAltName,nt.asn1.x509.Extension);nt.asn1.x509.IssuerAltName=function(v){nt.asn1.x509.IssuerAltName.superclass.constructor.call(this||p,v);(this||p).setNameArray=function(v){(this||p).asn1ExtnValue=new nt.asn1.x509.GeneralNames(v)};(this||p).getExtnValueHex=function(){return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.18";v!==void 0&&v.array!==void 0&&this.setNameArray(v.array)};extendClass(nt.asn1.x509.IssuerAltName,nt.asn1.x509.Extension);nt.asn1.x509.SubjectDirectoryAttributes=function(v){nt.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this||p,v);var y=nt.asn1,S=y.DERSequence,E=y.ASN1Util.newObject,F=y.x509.OID.name2oid;(this||p).params=null;(this||p).getExtnValueHex=function(){var v=[];for(var y=0;y<(this||p).params.array.length;y++){var C=(this||p).params.array[y];if(C.attr==void 0||C.array==void 0){var B={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(C.attr=="dateOfBirth"){B.seq[0].oid=F(C.attr);B.seq[1].set[0]={gentime:C.str}}else if(C.attr=="placeOfBirth"){B.seq[0].oid=F(C.attr);B.seq[1].set[0]={utf8str:C.str}}else if(C.attr=="gender"){B.seq[0].oid=F(C.attr);B.seq[1].set[0]={prnstr:C.str}}else if(C.attr=="countryOfCitizenship"){B.seq[0].oid=F(C.attr);B.seq[1].set[0]={prnstr:C.str}}else{if(C.attr!="countryOfResidence")throw new Error("unsupported attribute: "+C.attr);B.seq[0].oid=F(C.attr);B.seq[1].set[0]={prnstr:C.str}}v.push(new E(B))}else{var D={seq:[{oid:C.attr},{set:C.array}]};v.push(E(D))}}var P=new S({array:v});(this||p).asn1ExtnValue=P;return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.9";v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.SubjectDirectoryAttributes,nt.asn1.x509.Extension);nt.asn1.x509.PrivateExtension=function(v){nt.asn1.x509.PrivateExtension.superclass.constructor.call(this||p,v);var y=nt,S=y.lang.String.isHex,E=y.asn1,F=E.x509.OID.name2oid,C=E.ASN1Util.newObject;(this||p).params=null;(this||p).setByParam=function(v){(this||p).oid=F(v.extname);(this||p).params=v};(this||p).getExtnValueHex=function(){if((this||p).params.extname==void 0||(this||p).params.extn==void 0)throw new Error("extname or extnhex not specified");var v=(this||p).params.extn;if(typeof v=="string"&&S(v))return v;if(typeof v=="object")try{return C(v).tohex()}catch(v){}throw new Error("unsupported extn value")};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.x509.PrivateExtension,nt.asn1.x509.Extension);nt.asn1.x509.CRL=function(v){nt.asn1.x509.CRL.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.DERSequence,F=S.DERBitString,C=S.x509,B=C.AlgorithmIdentifier,D=C.TBSCertList;(this||p).params=void 0;(this||p).setByParam=function(v){(this||p).params=v};(this||p).sign=function(){var v=new D((this||p).params).tohex();var y=new nt.crypto.Signature({alg:(this||p).params.sigalg});y.init((this||p).params.cakey);y.updateHex(v);var S=y.sign();(this||p).params.sighex=S};(this||p).getPEM=function(){return hextopem(this.tohex(),"X509 CRL")};(this||p).tohex=function(){var v=(this||p).params;v.tbsobj==void 0&&(v.tbsobj=new D(v));v.sighex==void 0&&v.cakey!=void 0&&this.sign();if(v.sighex==void 0)throw new Error("sighex or cakey parameter not defined");var y=[];y.push(v.tbsobj);y.push(new B({name:v.sigalg}));y.push(new F({hex:"00"+v.sighex}));var S=new E({array:y});return S.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.CRL,nt.asn1.ASN1Object);nt.asn1.x509.TBSCertList=function(v){nt.asn1.x509.TBSCertList.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.DERInteger,F=S.DERSequence,C=S.DERTaggedObject,B=(S.DERObjectIdentifier,S.x509),D=B.AlgorithmIdentifier,P=B.Time,R=B.Extensions,T=B.X500Name;(this||p).params=null;(this||p).setByParam=function(v){(this||p).params=v};(this||p).getRevCertSequence=function(){var v=[];var y=(this||p).params.revcert;for(var S=0;S<y.length;S++){var C=[new E(y[S].sn),new P(y[S].date)];y[S].ext!=void 0&&C.push(new R(y[S].ext));v.push(new F({array:C}))}return new F({array:v})};(this||p).tohex=function(){var v=[];var y=(this||p).params;if(y.version!=void 0){var S=y.version-1;var B=new E({int:S});v.push(B)}v.push(new D({name:y.sigalg}));v.push(new T(y.issuer));v.push(new P(y.thisupdate));y.nextupdate!=void 0&&v.push(new P(y.nextupdate));y.revcert!=void 0&&v.push(this.getRevCertSequence());if(y.ext!=void 0){var N=new R(y.ext);v.push(new C({tag:"a0",explicit:true,obj:N}))}var O=new F({array:v});return O.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.x509.TBSCertList,nt.asn1.ASN1Object);nt.asn1.x509.CRLEntry=function(v){nt.asn1.x509.CRLEntry.superclass.constructor.call(this||p);var y=nt,S=y.asn1;(this||p).setCertSerial=function(v){(this||p).sn=new S.DERInteger(v)};(this||p).setRevocationDate=function(v){(this||p).time=new S.x509.Time(v)};(this||p).tohex=function(){var v=new S.DERSequence({array:[(this||p).sn,(this||p).time]});(this||p).TLV=v.tohex();return(this||p).TLV};(this||p).getEncodedHex=function(){return this.tohex()};if(v!==void 0){v.time!==void 0&&this.setRevocationDate(v.time);v.sn!==void 0&&this.setCertSerial(v.sn)}};extendClass(nt.asn1.x509.CRLEntry,nt.asn1.ASN1Object);nt.asn1.x509.CRLNumber=function(v){nt.asn1.x509.CRLNumber.superclass.constructor.call(this||p,v);(this||p).params=void 0;(this||p).getExtnValueHex=function(){(this||p).asn1ExtnValue=new nt.asn1.DERInteger((this||p).params.num);return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.20";v!=void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.CRLNumber,nt.asn1.x509.Extension);nt.asn1.x509.CRLReason=function(v){nt.asn1.x509.CRLReason.superclass.constructor.call(this||p,v);(this||p).params=void 0;(this||p).getExtnValueHex=function(){(this||p).asn1ExtnValue=new nt.asn1.DEREnumerated((this||p).params.code);return(this||p).asn1ExtnValue.tohex()};(this||p).oid="2.5.29.21";v!=void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.CRLReason,nt.asn1.x509.Extension);nt.asn1.x509.OCSPNonce=function(v){nt.asn1.x509.OCSPNonce.superclass.constructor.call(this||p,v);(this||p).params=void 0;(this||p).getExtnValueHex=function(){(this||p).asn1ExtnValue=new nt.asn1.DEROctetString((this||p).params);return(this||p).asn1ExtnValue.tohex()};(this||p).oid="1.3.6.1.5.5.7.48.1.2";v!=void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.OCSPNonce,nt.asn1.x509.Extension);nt.asn1.x509.OCSPNoCheck=function(v){nt.asn1.x509.OCSPNoCheck.superclass.constructor.call(this||p,v);(this||p).params=void 0;(this||p).getExtnValueHex=function(){(this||p).asn1ExtnValue=new nt.asn1.DERNull;return(this||p).asn1ExtnValue.tohex()};(this||p).oid="1.3.6.1.5.5.7.48.1.5";v!=void 0&&((this||p).params=v)};extendClass(nt.asn1.x509.OCSPNoCheck,nt.asn1.x509.Extension);nt.asn1.x509.AdobeTimeStamp=function(v){nt.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this||p,v);var y=nt,S=y.asn1,E=S.DERInteger,F=S.DERBoolean,C=S.DERSequence,B=S.x509.GeneralName;(this||p).params=null;(this||p).getExtnValueHex=function(){var v=(this||p).params;var y=[new E(1)];y.push(new B({uri:v.uri}));v.reqauth!=void 0&&y.push(new F(v.reqauth));(this||p).asn1ExtnValue=new C({array:y});return(this||p).asn1ExtnValue.tohex()};(this||p).oid="1.2.840.113583.1.1.9.1";v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.x509.AdobeTimeStamp,nt.asn1.x509.Extension);nt.asn1.x509.X500Name=function(v){nt.asn1.x509.X500Name.superclass.constructor.call(this||p);(this||p).asn1Array=[];(this||p).paramArray=[];(this||p).sRule="utf8";var y=nt,S=y.asn1,E=S.x509,F=E.RDN;(this||p).setByString=function(v,y){y!==void 0&&((this||p).sRule=y);var S=v.split("/");S.shift();var E=[];for(var C=0;C<S.length;C++)if(S[C].match(/^[^=]+=.+$/))E.push(S[C]);else{var B=E.length-1;E[B]=E[B]+"/"+S[C]}for(C=0;C<E.length;C++)(this||p).asn1Array.push(new F({str:E[C],rule:(this||p).sRule}))};(this||p).setByLdapString=function(v,y){y!==void 0&&((this||p).sRule=y);var S=E.X500Name.ldapToCompat(v);this.setByString(S,y)};(this||p).setByObject=function(v,y){y!==void 0&&((this||p).sRule=y);for(var S in v)if(v.hasOwnProperty(S)){var E=new F({str:S+"="+v[S],rule:(this||p).sRule});(this||p).asn1Array?(this||p).asn1Array.push(E):(this||p).asn1Array=[E]}};(this||p).setByParam=function(v){v.rule!==void 0&&((this||p).sRule=v.rule);if(v.array!==void 0)(this||p).paramArray=v.array;else if(v.str!==void 0)this.setByString(v.str);else if(v.ldapstr!==void 0)this.setByLdapString(v.ldapstr);else if(v.hex!==void 0)(this||p).hTLV=v.hex;else if(v.certissuer!==void 0){var y=new X509;y.readCertPEM(v.certissuer);(this||p).hTLV=y.getIssuerHex()}else if(v.certsubject!==void 0){y=new X509;y.readCertPEM(v.certsubject);(this||p).hTLV=y.getSubjectHex()}else typeof v==="object"&&v.certsubject===void 0&&v.certissuer===void 0&&this.setByObject(v)};(this||p).tohex=function(){if(typeof(this||p).hTLV=="string")return(this||p).hTLV;if((this||p).asn1Array.length==0&&(this||p).paramArray.length>0)for(var v=0;v<(this||p).paramArray.length;v++){var y={array:(this||p).paramArray[v]};(this||p).sRule!="utf8"&&(y.rule=(this||p).sRule);var E=new F(y);(this||p).asn1Array.push(E)}var C=new S.DERSequence({array:(this||p).asn1Array});(this||p).hTLV=C.tohex();return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.x509.X500Name,nt.asn1.ASN1Object);nt.asn1.x509.X500Name.compatToLDAP=function(v){if(v.substr(0,1)!=="/")throw"malformed input";v=v.substr(1);var p=v.split("/");p.reverse();p=p.map((function(v){return v.replace(/,/,"\\,")}));return p.join(",")};nt.asn1.x509.X500Name.onelineToLDAP=function(v){return nt.asn1.x509.X500Name.compatToLDAP(v)};nt.asn1.x509.X500Name.ldapToCompat=function(v){var p=v.split(",");var y=false;var S=[];for(var E=0;p.length>0;E++){var F=p.shift();if(y===true){var C=S.pop();var B=(C+","+F).replace(/\\,/g,",");S.push(B);y=false}else S.push(F);F.substr(-1,1)==="\\"&&(y=true)}S=S.map((function(v){return v.replace("/","\\/")}));S.reverse();return"/"+S.join("/")};nt.asn1.x509.X500Name.ldapToOneline=function(v){return nt.asn1.x509.X500Name.ldapToCompat(v)};nt.asn1.x509.RDN=function(v){nt.asn1.x509.RDN.superclass.constructor.call(this||p);(this||p).asn1Array=[];(this||p).paramArray=[];(this||p).sRule="utf8";var y=nt.asn1.x509.AttributeTypeAndValue;(this||p).setByParam=function(v){v.rule!==void 0&&((this||p).sRule=v.rule);v.str!==void 0&&this.addByMultiValuedString(v.str);v.array!==void 0&&((this||p).paramArray=v.array)};(this||p).addByString=function(v){(this||p).asn1Array.push(new nt.asn1.x509.AttributeTypeAndValue({str:v,rule:(this||p).sRule}))};(this||p).addByMultiValuedString=function(v){var p=nt.asn1.x509.RDN.parseString(v);for(var y=0;y<p.length;y++)this.addByString(p[y])};(this||p).tohex=function(){if((this||p).asn1Array.length==0&&(this||p).paramArray.length>0)for(var v=0;v<(this||p).paramArray.length;v++){var S=(this||p).paramArray[v];S.rule!==void 0&&(this||p).sRule!="utf8"&&(S.rule=(this||p).sRule);var E=new y(S);(this||p).asn1Array.push(E)}var F=new nt.asn1.DERSet({array:(this||p).asn1Array});(this||p).TLV=F.tohex();return(this||p).TLV};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.x509.RDN,nt.asn1.ASN1Object);nt.asn1.x509.RDN.parseString=function(v){var p=v.split(/\+/);var y=false;var S=[];for(var E=0;p.length>0;E++){var F=p.shift();if(y===true){var C=S.pop();var B=(C+"+"+F).replace(/\\\+/g,"+");S.push(B);y=false}else S.push(F);F.substr(-1,1)==="\\"&&(y=true)}var D=false;var P=[];for(E=0;S.length>0;E++){F=S.shift();if(D===true){var R=P.pop();if(F.match(/"$/)){B=(R+"+"+F).replace(/^([^=]+)="(.*)"$/,"$1=$2");P.push(B);D=false}else P.push(R+"+"+F)}else P.push(F);F.match(/^[^=]+="/)&&(D=true)}return P};nt.asn1.x509.AttributeTypeAndValue=function(v){nt.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this||p);(this||p).sRule="utf8";(this||p).sType=null;(this||p).sValue=null;(this||p).dsType=null;var y=nt,S=y.asn1,E=S.DERSequence,F=S.DERUTF8String,C=S.DERPrintableString,B=S.DERTeletexString,D=S.DERIA5String,P=S.DERVisibleString,R=S.DERBMPString,T=y.lang.String.isMail,N=y.lang.String.isPrintable;(this||p).setByParam=function(v){v.rule!==void 0&&((this||p).sRule=v.rule);v.ds!==void 0&&((this||p).dsType=v.ds);if(v.value===void 0&&v.str!==void 0){var y=v.str;var S=y.match(/^([^=]+)=(.+)$/);if(!S)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);(this||p).sType=S[1];(this||p).sValue=S[2]}else{(this||p).sType=v.type;(this||p).sValue=v.value}};(this||p).setByString=function(v,y){y!==void 0&&((this||p).sRule=y);var S=v.match(/^([^=]+)=(.+)$/);if(!S)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.setByAttrTypeAndValueStr(S[1],S[2])};(this||p)._getDsType=function(){var v=(this||p).sType;var y=(this||p).sValue;var S=(this||p).sRule;return S==="prn"?v=="CN"&&T(y)?"ia5":N(y)?"prn":"utf8":S==="utf8"?v=="CN"&&T(y)?"ia5":v=="C"?"prn":"utf8":"utf8"};(this||p).setByAttrTypeAndValueStr=function(v,y,S){S!==void 0&&((this||p).sRule=S);(this||p).sType=v;(this||p).sValue=y};(this||p).getValueObj=function(v,p){if(v=="utf8")return new F({str:p});if(v=="prn")return new C({str:p});if(v=="tel")return new B({str:p});if(v=="ia5")return new D({str:p});if(v=="vis")return new P({str:p});if(v=="bmp")return new R({str:p});throw new Error("unsupported directory string type: type="+v+" value="+p)};(this||p).tohex=function(){(this||p).dsType==null&&((this||p).dsType=this._getDsType());var v=nt.asn1.x509.OID.atype2obj((this||p).sType);var y=this.getValueObj((this||p).dsType,(this||p).sValue);var S=new E({array:[v,y]});(this||p).TLV=S.tohex();return(this||p).TLV};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.x509.AttributeTypeAndValue,nt.asn1.ASN1Object);nt.asn1.x509.SubjectPublicKeyInfo=function(v){nt.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.DERInteger,F=S.DERBitString,C=S.DERObjectIdentifier,B=S.DERSequence,D=S.ASN1Util.newObject,P=S.x509,R=P.AlgorithmIdentifier,T=y.crypto;T.ECDSA,T.DSA;(this||p).getASN1Object=function(){if((this||p).asn1AlgId==null||(this||p).asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var v=new B({array:[(this||p).asn1AlgId,(this||p).asn1SubjPKey]});return v};(this||p).tohex=function(){var v=this.getASN1Object();(this||p).hTLV=v.tohex();return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).setPubKey=function(v){try{if(v instanceof RSAKey){var y=D({seq:[{int:{bigint:v.n}},{int:{int:v.e}}]});var S=y.tohex();(this||p).asn1AlgId=new R({name:"rsaEncryption"});(this||p).asn1SubjPKey=new F({hex:"00"+S})}}catch(v){}try{if(v instanceof nt.crypto.ECDSA){var B=new C({name:v.curveName});(this||p).asn1AlgId=new R({name:"ecPublicKey",asn1params:B});(this||p).asn1SubjPKey=new F({hex:"00"+v.pubKeyHex})}}catch(v){}try{if(v instanceof nt.crypto.DSA){B=new D({seq:[{int:{bigint:v.p}},{int:{bigint:v.q}},{int:{bigint:v.g}}]});(this||p).asn1AlgId=new R({name:"dsa",asn1params:B});var P=new E({bigint:v.y});(this||p).asn1SubjPKey=new F({hex:"00"+P.tohex()})}}catch(v){}};v!==void 0&&this.setPubKey(v)};extendClass(nt.asn1.x509.SubjectPublicKeyInfo,nt.asn1.ASN1Object);nt.asn1.x509.Time=function(v){nt.asn1.x509.Time.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.DERUTCTime,F=S.DERGeneralizedTime;(this||p).params=null;(this||p).type=null;(this||p).setTimeParams=function(v){(this||p).timeParams=v};(this||p).setByParam=function(v){(this||p).params=v};(this||p).getType=function(v){return v.match(/^[0-9]{12}Z$/)?"utc":v.match(/^[0-9]{14}Z$/)?"gen":v.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":v.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null};(this||p).tohex=function(){var v=(this||p).params;var y=null;typeof v=="string"&&(v={str:v});v==null||!v.str||v.type!=null&&v.type!=void 0||(v.type=this.getType(v.str));if(v!=null&&v.str){v.type=="utc"&&(y=new E(v.str));v.type=="gen"&&(y=new F(v.str))}else y=(this||p).type=="gen"?new F:new E;if(y==null)throw new Error("wrong setting for Time");(this||p).TLV=y.tohex();return(this||p).TLV};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};nt.asn1.x509.Time_bak=function(v){nt.asn1.x509.Time_bak.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.DERUTCTime,F=S.DERGeneralizedTime;(this||p).setTimeParams=function(v){(this||p).timeParams=v};(this||p).tohex=function(){var v=null;v=(this||p).timeParams!=null?(this||p).type=="utc"?new E((this||p).timeParams):new F((this||p).timeParams):(this||p).type=="utc"?new E:new F;(this||p).TLV=v.tohex();return(this||p).TLV};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).type="utc";if(v!==void 0){if(v.type!==void 0)(this||p).type=v.type;else if(v.str!==void 0){v.str.match(/^[0-9]{12}Z$/)&&((this||p).type="utc");v.str.match(/^[0-9]{14}Z$/)&&((this||p).type="gen")}(this||p).timeParams=v}};extendClass(nt.asn1.x509.Time,nt.asn1.ASN1Object);nt.asn1.x509.AlgorithmIdentifier=function(v){nt.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this||p);(this||p).nameAlg=null;(this||p).asn1Alg=null;(this||p).asn1Params=null;(this||p).paramEmpty=false;var y=nt,S=y.asn1,E=S.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;(this||p).tohex=function(){if((this||p).nameAlg===null&&(this||p).asn1Alg===null)throw new Error("algorithm not specified");if((this||p).nameAlg!==null){var v=null;for(var y in E)y===(this||p).nameAlg&&(v=E[y]);if(v!==null){(this||p).hTLV=v;return(this||p).hTLV}}(this||p).nameAlg!==null&&(this||p).asn1Alg===null&&((this||p).asn1Alg=S.x509.OID.name2obj((this||p).nameAlg));var F=[(this||p).asn1Alg];(this||p).asn1Params!==null&&F.push((this||p).asn1Params);var C=new S.DERSequence({array:F});(this||p).hTLV=C.tohex();return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};if(v!==void 0){v.name!==void 0&&((this||p).nameAlg=v.name);v.asn1params!==void 0&&((this||p).asn1Params=v.asn1params);v.paramempty!==void 0&&((this||p).paramEmpty=v.paramempty)}if((this||p).asn1Params===null&&(this||p).paramEmpty===false&&(this||p).nameAlg!==null){(this||p).nameAlg.name!==void 0&&((this||p).nameAlg=(this||p).nameAlg.name);var F=(this||p).nameAlg.toLowerCase();F.substr(-7,7)!=="withdsa"&&F.substr(-9,9)!=="withecdsa"&&((this||p).asn1Params=new S.DERNull)}};extendClass(nt.asn1.x509.AlgorithmIdentifier,nt.asn1.ASN1Object);nt.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"};nt.asn1.x509.GeneralName=function(v){nt.asn1.x509.GeneralName.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.x509,F=E.X500Name,C=E.OtherName,B=S.DERIA5String,D=(S.DERPrintableString,S.DEROctetString),P=S.DERTaggedObject,R=S.ASN1Object,T=Error;(this||p).params=null;(this||p).setByParam=function(v){(this||p).params=v};(this||p).tohex=function(){var v=(this||p).params;var y,S;var E=false;if(v.other!==void 0)y="a0",S=new C(v.other);else if(v.rfc822!==void 0){y="81";S=new B({str:v.rfc822})}else if(v.dns!==void 0){y="82";S=new B({str:v.dns})}else if(v.dn!==void 0){y="a4";E=true;S=typeof v.dn==="string"?new F({str:v.dn}):v.dn instanceof nt.asn1.x509.X500Name?v.dn:new F(v.dn)}else if(v.ldapdn!==void 0){y="a4";E=true;S=new F({ldapstr:v.ldapdn})}else if(v.certissuer!==void 0||v.certsubj!==void 0){y="a4";E=true;var N,O;var V=null;if(v.certsubj!==void 0){N=false;O=v.certsubj}else{N=true;O=v.certissuer}O.match(/^[0-9A-Fa-f]+$/)&&V==O;O.indexOf("-----BEGIN ")!=-1&&(V=pemtohex(O));if(V==null)throw new Error("certsubj/certissuer not cert");var L=new X509;L.hex=V;var M;M=N?L.getIssuerHex():L.getSubjectHex();S=new R;S.hTLV=M}else if(v.uri!==void 0){y="86";S=new B({str:v.uri})}else{if(v.ip===void 0)throw new T("improper params");y="87";var _;var U=v.ip;try{if(U.match(/^[0-9a-f]+$/)){var G=U.length;if(G!=8&&G!=16&&G!=32&&G!=64)throw"err";_=U}else _=iptohex(U)}catch(p){throw new T("malformed IP address: "+v.ip+":"+p.message)}S=new D({hex:_})}var X=new P({tag:y,explicit:E,obj:S});return X.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.x509.GeneralName,nt.asn1.ASN1Object);nt.asn1.x509.GeneralNames=function(v){nt.asn1.x509.GeneralNames.superclass.constructor.call(this||p);var y=nt,S=y.asn1;(this||p).setByParamArray=function(v){for(var y=0;y<v.length;y++){var E=new S.x509.GeneralName(v[y]);(this||p).asn1Array.push(E)}};(this||p).tohex=function(){var v=new S.DERSequence({array:(this||p).asn1Array});return v.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).asn1Array=new Array;typeof v!="undefined"&&this.setByParamArray(v)};extendClass(nt.asn1.x509.GeneralNames,nt.asn1.ASN1Object);nt.asn1.x509.OtherName=function(v){nt.asn1.x509.OtherName.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.DERObjectIdentifier,F=S.DERSequence,C=S.ASN1Util.newObject;(this||p).params=null;(this||p).setByParam=function(v){(this||p).params=v};(this||p).tohex=function(){var v=(this||p).params;if(v.oid==void 0||v.value==void 0)throw new Error("oid or value not specified");var y=new E({oid:v.oid});var S=C({tag:{tag:"a0",explicit:true,obj:v.value}});var B=new F({array:[y,S]});return B.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.x509.OtherName,nt.asn1.ASN1Object);nt.asn1.x509.OID=new function(){var v=nt.asn1.DERObjectIdentifier;(this||p).name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"};(this||p).atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"};(this||p).objCache={};(this||p).name2obj=function(y){if(typeof(this||p).objCache[y]!="undefined")return(this||p).objCache[y];if(typeof(this||p).name2oidList[y]=="undefined")throw"Name of ObjectIdentifier not defined: "+y;var S=(this||p).name2oidList[y];var E=new v({oid:S});(this||p).objCache[y]=E;return E};(this||p).atype2obj=function(y){if((this||p).objCache[y]!==void 0)return(this||p).objCache[y];var S;if(y.match(/^\d+\.\d+\.[0-9.]+$/))S=y;else if((this||p).atype2oidList[y]!==void 0)S=(this||p).atype2oidList[y];else{if((this||p).name2oidList[y]===void 0)throw new Error("AttributeType name undefined: "+y);S=(this||p).name2oidList[y]}var E=new v({oid:S});(this||p).objCache[y]=E;return E};(this||p).registerOIDs=function(v){if(this.checkOIDs(v))for(var y in v)(this||p).name2oidList[y]=v[y]};(this||p).checkOIDs=function(v){try{var y=Object.keys(v);if(y.length==0)return false;y.map((function(v,y,S){var E=(this||p)[v];if(!E.match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")}),v);return true}catch(v){return false}}};nt.asn1.x509.OID.oid2name=function(v){var p=nt.asn1.x509.OID.name2oidList;for(var y in p)if(p[y]==v)return y;return""};nt.asn1.x509.OID.oid2atype=function(v){var p=nt.asn1.x509.OID.atype2oidList;for(var y in p)if(p[y]==v)return y;return v};nt.asn1.x509.OID.name2oid=function(v){if(v.match(/^[0-9.]+$/))return v;var p=nt.asn1.x509.OID.name2oidList;return p[v]===void 0?"":p[v]};nt.asn1.x509.X509Util={};nt.asn1.x509.X509Util.newCertPEM=function(v){var p=nt.asn1.x509,y=(p.TBSCertificate,p.Certificate);var S=new y(v);return S.getPEM()};typeof nt!="undefined"&&nt||(nt={});typeof nt.asn1!="undefined"&&nt.asn1||(nt.asn1={});typeof nt.asn1.cms!="undefined"&&nt.asn1.cms||(nt.asn1.cms={});nt.asn1.cms.Attribute=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERSequence,C=E.DERSet,B=E.DERObjectIdentifier;(this||p).params=null;(this||p).typeOid=null;(this||p).setByParam=function(v){(this||p).params=v};(this||p).getValueArray=function(){throw new y("not yet implemented abstract")};(this||p).tohex=function(){var v=new B({oid:(this||p).typeOid});var y=new C({array:this.getValueArray()});var S=new F({array:[v,y]});return S.tohex()};(this||p).getEncodedHex=function(){return this.tohex()}};extendClass(nt.asn1.cms.Attribute,nt.asn1.ASN1Object);nt.asn1.cms.ContentType=function(v){var y=nt,S=y.asn1;S.cms.ContentType.superclass.constructor.call(this||p);(this||p).typeOid="1.2.840.113549.1.9.3";(this||p).getValueArray=function(){var v=new S.DERObjectIdentifier((this||p).params.type);return[v]};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.ContentType,nt.asn1.cms.Attribute);nt.asn1.cms.MessageDigest=function(v){var y=nt,S=y.asn1,E=S.DEROctetString,F=S.cms;F.MessageDigest.superclass.constructor.call(this||p);(this||p).typeOid="1.2.840.113549.1.9.4";(this||p).getValueArray=function(){var v=new E((this||p).params);return[v]};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.MessageDigest,nt.asn1.cms.Attribute);nt.asn1.cms.SigningTime=function(v){var y=nt,S=y.asn1;S.cms.SigningTime.superclass.constructor.call(this||p);(this||p).typeOid="1.2.840.113549.1.9.5";(this||p).getValueArray=function(){var v=new S.x509.Time((this||p).params);return[v]};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.SigningTime,nt.asn1.cms.Attribute);nt.asn1.cms.SigningCertificate=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERSequence,C=E.cms,B=C.ESSCertID;S.crypto;C.SigningCertificate.superclass.constructor.call(this||p);(this||p).typeOid="1.2.840.113549.1.9.16.2.12";(this||p).getValueArray=function(){if((this||p).params==null||(this||p).params==void 0||(this||p).params.array==void 0)throw new y("parameter 'array' not specified");var S=(this||p).params.array;var E=[];for(var C=0;C<S.length;C++){var D=S[C];v.hasis!=false||typeof D!="string"||D.indexOf("-----BEGIN")==-1&&!it.isASN1HEX(D)||(D={cert:D});D.hasis!=false&&v.hasis==false&&(D.hasis=false);E.push(new B(D))}var P=new F({array:E});var R=new F({array:[P]});return[R]};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.SigningCertificate,nt.asn1.cms.Attribute);nt.asn1.cms.ESSCertID=function(v){nt.asn1.cms.ESSCertID.superclass.constructor.call(this||p);var y=Error,S=nt,E=S.asn1,F=E.DEROctetString,C=E.DERSequence,B=E.cms.IssuerSerial;(this||p).params=null;(this||p).getCertHash=function(v,p){if(v.hash!=void 0)return v.hash;if(typeof v=="string"&&v.indexOf("-----BEGIN")==-1&&!it.isASN1HEX(v))return v;var E;if(typeof v=="string")E=v;else{if(v.cert==void 0)throw new y("hash nor cert unspecified");E=v.cert}var F;F=E.indexOf("-----BEGIN")!=-1?pemtohex(E):E;typeof v=="string"&&(v.indexOf("-----BEGIN")!=-1?F=pemtohex(v):it.isASN1HEX(v)&&(F=v));var C;if(v.alg!=void 0)C=v.alg;else{if(p==void 0)throw new y("hash alg unspecified");C=p}return S.crypto.Util.hashHex(F,C)};(this||p).tohex=function(){var v=(this||p).params;var y=this.getCertHash(v,"sha1");var S=[];S.push(new F({hex:y}));(typeof v=="string"&&v.indexOf("-----BEGIN")!=-1||v.cert!=void 0&&v.hasis!=false||v.issuer!=void 0&&v.serial!=void 0)&&S.push(new B(v));var E=new C({array:S});return E.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.ESSCertID,nt.asn1.ASN1Object);nt.asn1.cms.SigningCertificateV2=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERSequence,C=(E.x509,E.cms),B=C.ESSCertIDv2;S.crypto;C.SigningCertificateV2.superclass.constructor.call(this||p);(this||p).typeOid="1.2.840.113549.1.9.16.2.47";(this||p).getValueArray=function(){if((this||p).params==null||(this||p).params==void 0||(this||p).params.array==void 0)throw new y("parameter 'array' not specified");var S=(this||p).params.array;var E=[];for(var C=0;C<S.length;C++){var D=S[C];v.alg==void 0&&v.hasis!=false||typeof D!="string"||D.indexOf("-----BEGIN")==-1&&!it.isASN1HEX(D)||(D={cert:D});D.alg==void 0&&v.alg!=void 0&&(D.alg=v.alg);D.hasis!=false&&v.hasis==false&&(D.hasis=false);E.push(new B(D))}var P=new F({array:E});var R=new F({array:[P]});return[R]};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.SigningCertificateV2,nt.asn1.cms.Attribute);nt.asn1.cms.ESSCertIDv2=function(v){nt.asn1.cms.ESSCertIDv2.superclass.constructor.call(this||p);Error;var y=nt,S=y.asn1,E=S.DEROctetString,F=S.DERSequence,C=S.cms.IssuerSerial,B=S.x509.AlgorithmIdentifier;(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var y=this.getCertHash(v,"sha256");var S=[];v.alg!=void 0&&v.alg!="sha256"&&S.push(new B({name:v.alg}));S.push(new E({hex:y}));(typeof v=="string"&&v.indexOf("-----BEGIN")!=-1||v.cert!=void 0&&v.hasis!=false||v.issuer!=void 0&&v.serial!=void 0)&&S.push(new C(v));var D=new F({array:S});return D.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.ESSCertIDv2,nt.asn1.cms.ESSCertID);nt.asn1.cms.IssuerSerial=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERInteger,C=E.DERSequence,B=E.cms,D=E.x509,P=D.GeneralNames,R=X509;B.IssuerSerial.superclass.constructor.call(this||p);(this||p).setByParam=function(v){(this||p).params=v};(this||p).tohex=function(){var v=(this||p).params;var S,E;if(typeof v=="string"&&v.indexOf("-----BEGIN")!=-1||v.cert!=void 0){var B;B=v.cert!=void 0?v.cert:v;var D=new R;D.readCertPEM(B);S=D.getIssuer();E={hex:D.getSerialNumberHex()}}else{if(v.issuer==void 0||!v.serial)throw new y("cert or issuer and serial parameter not specified");S=v.issuer;E=v.serial}var T=new P([{dn:S}]);var N=new F(E);var O=new C({array:[T,N]});return O.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.IssuerSerial,nt.asn1.ASN1Object);nt.asn1.cms.SignerIdentifier=function(v){var y=nt,S=y.asn1,E=(S.DERInteger,S.DERSequence,S.cms),F=E.IssuerAndSerialNumber,C=E.SubjectKeyIdentifier,B=S.x509;B.X500Name,Error;E.SignerIdentifier.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;if(v.type=="isssn"){var y=new F(v);return y.tohex()}if(v.type=="skid"){var S=new C(v);return S.tohex()}throw new Error("wrong property for isssn or skid")};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.SignerIdentifier,nt.asn1.ASN1Object);nt.asn1.cms.IssuerAndSerialNumber=function(v){var y=nt,S=y.asn1,E=S.DERInteger,F=S.DERSequence,C=S.cms,B=S.x509,D=B.X500Name,P=X509,R=Error;C.IssuerAndSerialNumber.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var y,S;if(typeof v=="string"&&v.indexOf("-----BEGIN")!=-1||v.cert!=void 0){var C;C=v.cert!=void 0?v.cert:v;var B=new P;B.readCertPEM(C);y=B.getIssuer();S={hex:B.getSerialNumberHex()}}else{if(v.issuer==void 0||!v.serial)throw new R("cert or issuer and serial parameter not specified");y=v.issuer;S=v.serial}var T=new D(y);var N=new E(S);var O=new F({array:[T,N]});return O.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).setByParam=function(v){(this||p).params=v};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.IssuerAndSerialNumber,nt.asn1.ASN1Object);nt.asn1.cms.SubjectKeyIdentifier=function(v){var y=nt,S=y.asn1,E=(S.DERInteger,S.DERSequence,S.ASN1Util.newObject),F=S.cms,C=(F.IssuerAndSerialName,F.SubjectKeyIdentifier,S.x509),B=(C.X500Name,X509),D=Error;F.SubjectKeyIdentifier.superclass.constructor.call(this||p);(this||p).tohex=function(){var v=(this||p).params;if(v.cert==void 0&&v.skid==void 0)throw new D("property cert nor skid undefined");var y;if(v.cert!=void 0){var S=new B(v.cert);var F=S.getExtSubjectKeyIdentifier();y=F.kid.hex}else v.skid!=void 0&&(y=v.skid);var C=E({tag:{tage:"a0",obj:{octstr:{hex:y}}}});return C.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.SubjectKeyIdentifier,nt.asn1.ASN1Object);nt.asn1.cms.AttributeList=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERSet,C=E.cms;C.AttributeList.superclass.constructor.call(this||p);(this||p).params=null;(this||p).hTLV=null;(this||p).setByParam=function(v){(this||p).params=v};(this||p).tohex=function(){var v=(this||p).params;if((this||p).hTLV!=null)return(this||p).hTLV;var S=true;v.sortflag!=void 0&&(S=v.sortflag);var E=v.array;var B=[];for(var D=0;D<E.length;D++){var P=E[D];var R=P.attr;if(R=="contentType")B.push(new C.ContentType(P));else if(R=="messageDigest")B.push(new C.MessageDigest(P));else if(R=="signingTime")B.push(new C.SigningTime(P));else if(R=="signingCertificate")B.push(new C.SigningCertificate(P));else if(R=="signingCertificateV2")B.push(new C.SigningCertificateV2(P));else if(R=="signaturePolicyIdentifier")B.push(new nt.asn1.cades.SignaturePolicyIdentifier(P));else{if(R!="signatureTimeStamp"&&R!="timeStampToken")throw new y("unknown attr: "+R);B.push(new nt.asn1.cades.SignatureTimeStamp(P))}}var T=new F({array:B,sortflag:S});(this||p).hTLV=T.tohex();return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.AttributeList,nt.asn1.ASN1Object);nt.asn1.cms.SignerInfo=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERInteger,C=E.DEROctetString,B=E.DERSequence,D=E.DERTaggedObject,P=E.cms,R=P.SignerIdentifier,T=P.AttributeList,N=(P.ContentType,P.EncapsulatedContentInfo,P.MessageDigest,P.SignedData,E.x509),O=N.AlgorithmIdentifier,V=S.crypto,L=ot;P.SignerInfo.superclass.constructor.call(this||p);(this||p).params=null;(this||p).sign=function(){var v=(this||p).params;var y=v.sigalg;var S=new T(v.sattrs).tohex();var E=L.getKey(v.signkey);var F=new V.Signature({alg:y});F.init(E);F.updateHex(S);var C=F.sign();v.sighex=C};(this||p).tohex=function(){var v=(this||p).params;var S=[];S.push(new F({int:v.version}));S.push(new R(v.id));S.push(new O({name:v.hashalg}));if(v.sattrs!=void 0){var E=new T(v.sattrs);try{S.push(new D({tag:"a0",explicit:false,obj:E}))}catch(v){throw new y("si sattr error: "+v)}}v.sigalgfield!=void 0?S.push(new O({name:v.sigalgfield})):S.push(new O({name:v.sigalg}));v.sighex==void 0&&v.signkey!=void 0&&this.sign();S.push(new C({hex:v.sighex}));if(v.uattrs!=void 0){E=new T(v.uattrs);try{S.push(new D({tag:"a1",explicit:false,obj:E}))}catch(v){throw new y("si uattr error: "+v)}}var P=new B({array:S});return P.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.SignerInfo,nt.asn1.ASN1Object);nt.asn1.cms.EncapsulatedContentInfo=function(v){var y=nt,S=y.asn1,E=S.DERTaggedObject,F=S.DERSequence,C=S.DERObjectIdentifier,B=S.DEROctetString,D=S.cms;D.EncapsulatedContentInfo.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var y=[];y.push(new C(v.type));if(v.content!=void 0&&(v.content.hex!=void 0||v.content.str!=void 0)&&v.isDetached!=true){var S=new B(v.content);var D=new E({tag:"a0",explicit:true,obj:S});y.push(D)}var P=new F({array:y});return P.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).setByParam=function(v){(this||p).params=v};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.EncapsulatedContentInfo,nt.asn1.ASN1Object);nt.asn1.cms.ContentInfo=function(v){var y=nt,S=y.asn1,E=S.DERTaggedObject,F=S.DERSequence,C=S.DERObjectIdentifier,B=S.x509;B.OID.name2obj;nt.asn1.cms.ContentInfo.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var y=[];y.push(new C(v.type));var S=new E({tag:"a0",explicit:true,obj:v.obj});y.push(S);var B=new F({array:y});return B.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).setByParam=function(v){(this||p).params=v};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.ContentInfo,nt.asn1.ASN1Object);nt.asn1.cms.SignedData=function(v){Error;var y=nt,S=y.asn1,E=(S.ASN1Object,S.DERInteger),F=S.DERSet,C=S.DERSequence,B=(S.DERTaggedObject,S.cms),D=B.EncapsulatedContentInfo,P=B.SignerInfo,R=B.ContentInfo,T=B.CertificateSet,N=B.RevocationInfoChoices,O=S.x509,V=O.AlgorithmIdentifier;nt.asn1.cms.SignedData.superclass.constructor.call(this||p);(this||p).params=null;(this||p).checkAndFixParam=function(){var v=(this||p).params;this._setDigestAlgs(v);this._setContentTypeByEContent(v);this._setMessageDigestByEContent(v);this._setSignerInfoVersion(v);this._setSignedDataVersion(v)};(this||p)._setDigestAlgs=function(v){var p={};var y=v.sinfos;for(var S=0;S<y.length;S++){var E=y[S];p[E.hashalg]=1}v.hashalgs=Object.keys(p).sort()};(this||p)._setContentTypeByEContent=function(v){var p=v.econtent.type;var y=v.sinfos;for(var S=0;S<y.length;S++){var E=y[S];var F=this._getAttrParamByName(E,"contentType");F.type=p}};(this||p)._setMessageDigestByEContent=function(v){var p=v.econtent;v.econtent.type;var y=p.content.hex;y==void 0&&p.type=="data"&&p.content.str!=void 0&&(y=rstrtohex(p.content.str));var S=v.sinfos;for(var E=0;E<S.length;E++){var F=S[E];var C=F.hashalg;var B=this._getAttrParamByName(F,"messageDigest");var D=nt.crypto.Util.hashHex(y,C);B.hex=D}};(this||p)._getAttrParamByName=function(v,p){var y=v.sattrs.array;for(var S=0;S<y.length;S++)if(y[S].attr==p)return y[S]};(this||p)._setSignerInfoVersion=function(v){var p=v.sinfos;for(var y=0;y<p.length;y++){var S=p[y];var E=1;S.id.type=="skid"&&(E=3);S.version=E}};(this||p)._setSignedDataVersion=function(v){var p=this._getSignedDataVersion(v);v.version=p};(this||p)._getSignedDataVersion=function(v){if(v.revinfos!=void 0){var p=v.revinfos;for(var y=0;y<p.length;y++){var S=p[y];if(S.ocsp!=void 0)return 5}}var E=v.sinfos;for(y=0;y<E.length;y++){var F=v.sinfos[y];if(F.version==3)return 3}return v.econtent.type!="data"?3:1};(this||p).tohex=function(){var v=(this||p).params;(this||p).getEncodedHexPrepare!=void 0&&this.getEncodedHexPrepare();v.fixed!=true&&this.checkAndFixParam();var y=[];y.push(new E({int:v.version}));var S=[];for(var B=0;B<v.hashalgs.length;B++){var R=v.hashalgs[B];S.push(new V({name:R}))}y.push(new F({array:S}));y.push(new D(v.econtent));v.certs!=void 0&&y.push(new T(v.certs));v.revinfos!=void 0&&y.push(new N(v.revinfos));var O=[];for(B=0;B<v.sinfos.length;B++){var L=v.sinfos[B];O.push(new P(L))}y.push(new F({array:O}));var M=new C({array:y});return M.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).getContentInfo=function(){var v=new R({type:"signed-data",obj:this||p});return v};(this||p).getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.SignedData,nt.asn1.ASN1Object);nt.asn1.cms.CertificateSet=function(v){nt.asn1.cms.CertificateSet.superclass.constructor.call(this||p);var y=Error,S=nt.asn1,E=S.DERTaggedObject,F=S.DERSet,C=S.ASN1Object;(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var S=[];var B;if(v instanceof Array)B=v;else{if(v.array==void 0)throw new y("cert array not specified");B=v.array}for(var D=0;D<B.length;D++){var P=B[D];var R=pemtohex(P);var T=new C;T.hTLV=R;S.push(T)}var N={array:S};v.sortflag==false&&(N.sortflag=false);var O=new F(N);var V=new E({tag:"a0",explicit:false,obj:O});return V.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.CertificateSet,nt.asn1.ASN1Object);nt.asn1.cms.RevocationInfoChoices=function(v){nt.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;if(!v instanceof Array)throw new Error("params is not array");var y=[];for(var S=0;S<v.length;S++)y.push(new nt.asn1.cms.RevocationInfoChoice(v[S]));var E=nt.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:y}}});return E.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.RevocationInfoChoices,nt.asn1.ASN1Object);nt.asn1.cms.RevocationInfoChoice=function(v){nt.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;if(v.crl!=void 0&&typeof v.crl=="string"){var y=v.crl;v.crl.indexOf("-----BEGIN")!=-1&&(y=pemtohex(v.crl));return y}if(v.ocsp!=void 0){var S=nt.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new nt.asn1.cms.OtherRevocationFormat(v)}});return S.tohex()}throw new Error("property crl or ocsp undefined")};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.RevocationInfoChoice,nt.asn1.ASN1Object);nt.asn1.cms.OtherRevocationFormat=function(v){nt.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this||p);var y=Error,S=nt,E=S.asn1,F=E.ASN1Util.newObject,C=S.lang.String.isHex;(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;if(v.ocsp==void 0)throw new y("property ocsp not specified");if(!C(v.ocsp)||!it.isASN1HEX(v.ocsp))throw new y("ocsp value not ASN.1 hex string");var S=F({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:v.ocsp}}]});return S.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cms.OtherRevocationFormat,nt.asn1.ASN1Object);nt.asn1.cms.CMSUtil=new function(){};nt.asn1.cms.CMSUtil.newSignedData=function(v){return new nt.asn1.cms.SignedData(v)};nt.asn1.cms.CMSUtil.verifySignedData=function(v){var p=nt,y=p.asn1,S=y.cms,E=(S.SignerInfo,S.SignedData,S.SigningTime,S.SigningCertificate,S.SigningCertificateV2,y.cades),F=(E.SignaturePolicyIdentifier,p.lang.String.isHex),C=it,B=C.getVbyList,D=C.getTLVbyList,P=C.getIdxbyList,R=C.getChildIdx,T=C.getTLV,N=C.oidname,O=p.crypto.Util.hashHex;v.cms===void 0&&!F(v.cms);var V=v.cms;var g=function(v,p){var y;for(var S=3;S<6;S++){y=P(v,0,[1,0,S]);if(y!==void 0){var E=v.substr(y,2);E==="a0"&&(p.certsIdx=y);E==="a1"&&(p.revinfosIdx=y);E==="31"&&(p.signerinfosIdx=y)}}};var l=function(v,p){var y=p.signerinfosIdx;if(y!==void 0){var S=R(v,y);p.signerInfoIdxList=S;for(var E=0;E<S.length;E++){var F=S[E];var C={idx:F};k(v,C);p.signerInfos.push(C)}}};var k=function(v,p){var y=p.idx;p.signerid_issuer1=D(v,y,[1,0],"30");p.signerid_serial1=B(v,y,[1,1],"02");p.hashalg=N(B(v,y,[2,0],"06"));var S=P(v,y,[3],"a0");p.idxSignedAttrs=S;f(v,p,S);var E=R(v,y);var F=E.length;if(F<6)throw"malformed SignerInfo";p.sigalg=N(B(v,y,[F-2,0],"06"));p.sigval=B(v,y,[F-1],"04")};var f=function(v,p,y){var S=R(v,y);p.signedAttrIdxList=S;for(var E=0;E<S.length;E++){var F=S[E];var C=B(v,F,[0],"06");var D;if(C==="2a864886f70d010905"){D=hextoutf8(B(v,F,[1,0]));p.saSigningTime=D}else if(C==="2a864886f70d010904"){D=B(v,F,[1,0],"04");p.saMessageDigest=D}}};var w=function(v,p){if(B(v,0,[0],"06")!=="2a864886f70d010702")return p;p.cmsType="signedData";p.econtent=B(v,0,[1,0,2,1,0]);g(v,p);p.signerInfos=[];l(v,p)};var o=function(v,p){var y=p.parse.signerInfos;var S=y.length;var E=true;for(var F=0;F<S;F++){var C=y[F];e(v,p,C,F);C.isValid||(E=false)}p.isValid=E};var x=function(v,p,y,S){var E=p.parse.certsIdx;var F;if(p.certs===void 0){F=[];p.certkeys=[];var C=R(v,E);for(var B=0;B<C.length;B++){var D=T(v,C[B]);var P=new X509;P.readCertHex(D);F[B]=P;p.certkeys[B]=P.getPublicKey()}p.certs=F}else F=p.certs;p.cccc=F.length;p.cccci=C.length;for(B=0;B<F.length;B++){var N=P.getIssuerHex();var O=P.getSerialNumberHex();y.signerid_issuer1===N&&y.signerid_serial1===O&&(y.certkey_idx=B)}};var e=function(v,p,y,S){y.verifyDetail={};var E=y.verifyDetail;var F=p.parse.econtent;var C=y.hashalg;var B=y.saMessageDigest;E.validMessageDigest=false;O(F,C)===B&&(E.validMessageDigest=true);x(v,p,y,S);E.validSignatureValue=false;var D=y.sigalg;var P="31"+T(v,y.idxSignedAttrs).substr(2);y.signedattrshex=P;var R=p.certs[y.certkey_idx].getPublicKey();var N=new nt.crypto.Signature({alg:D});N.init(R);N.updateHex(P);var V=N.verify(y.sigval);E.validSignatureValue_isValid=V;V===true&&(E.validSignatureValue=true);y.isValid=false;E.validMessageDigest&&E.validSignatureValue&&(y.isValid=true)};var L={isValid:false,parse:{}};w(V,L.parse);o(V,L);return L};nt.asn1.cms.CMSParser=function(){var v=Error,y=X509,S=new y,E=it,F=E.getV,C=E.getTLV,B=(E.getIdxbyList,E.getTLVbyList),D=E.getTLVbyListEx,P=E.getVbyList,R=E.getVbyListEx,T=E.getChildIdx;(this||p).getCMSSignedData=function(v){var p=B(v,0,[1,0]);var y=this.getSignedData(p);return y};(this||p).getSignedData=function(v){var p=T(v,0);var y={};var S=F(v,p[0]);var E=parseInt(S,16);y.version=E;var B=C(v,p[1]);y.hashalgs=this.getHashAlgArray(B);var P=C(v,p[2]);y.econtent=this.getEContent(P);var R=D(v,0,["[0]"]);R!=null&&(y.certs=this.getCertificateSet(R));var N=D(v,0,["[1]"]);N!=null;var O=D(v,0,[3]);y.sinfos=this.getSignerInfos(O);return y};(this||p).getHashAlgArray=function(v){var p=T(v,0);var S=new y;var E=[];for(var F=0;F<p.length;F++){var B=C(v,p[F]);var D=S.getAlgorithmIdentifierName(B);E.push(D)}return E};(this||p).getEContent=function(v){var p={};var y=P(v,0,[0]);var S=P(v,0,[1,0]);p.type=nt.asn1.x509.OID.oid2name(it.hextooidstr(y));p.content={hex:S};return p};(this||p).getSignerInfos=function(v){var p=[];var y=T(v,0);for(var S=0;S<y.length;S++){var E=C(v,y[S]);var F=this.getSignerInfo(E);p.push(F)}return p};(this||p).getSignerInfo=function(v){var p={};var y=T(v,0);var F=E.getInt(v,y[0],-1);F!=-1&&(p.version=F);var B=C(v,y[1]);var P=this.getIssuerAndSerialNumber(B);p.id=P;var N=C(v,y[2]);var O=S.getAlgorithmIdentifierName(N);p.hashalg=O;var V=D(v,0,["[0]"]);if(V!=null){var L=this.getAttributeList(V);p.sattrs=L}var M=D(v,0,[3]);var _=S.getAlgorithmIdentifierName(M);p.sigalg=_;var U=R(v,0,[4]);p.sighex=U;var G=D(v,0,["[1]"]);if(G!=null){var X=this.getAttributeList(G);p.uattrs=X}return p};(this||p).getSignerIdentifier=function(v){if(v.substr(0,2)=="30")return this.getIssuerAndSerialNumber(v);throw new Error("SKID of signerIdentifier not supported")};(this||p).getIssuerAndSerialNumber=function(v){var p={type:"isssn"};var y=T(v,0);var E=C(v,y[0]);p.issuer=S.getX500Name(E);var B=F(v,y[1]);p.serial={hex:B};return p};(this||p).getAttributeList=function(v){var p=[];var y=T(v,0);for(var S=0;S<y.length;S++){var E=C(v,y[S]);var F=this.getAttribute(E);p.push(F)}return{array:p}};(this||p).getAttribute=function(v){var p={};var y=T(v,0);var S=E.getOID(v,y[0]);var F=nt.asn1.x509.OID.oid2name(S);p.attr=F;var B=C(v,y[1]);var D=T(B,0);if(D.length==1)p.valhex=C(B,D[0]);else{var P=[];for(var R=0;R<D.length;R++)P.push(C(B,D[R]));p.valhex=P}F=="contentType"?this.setContentType(p):F=="messageDigest"?this.setMessageDigest(p):F=="signingTime"?this.setSigningTime(p):F=="signingCertificate"?this.setSigningCertificate(p):F=="signingCertificateV2"?this.setSigningCertificateV2(p):F=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(p);return p};(this||p).setContentType=function(v){var p=E.getOIDName(v.valhex,0,null);if(p!=null){v.type=p;delete v.valhex}};(this||p).setSigningTime=function(v){var p=F(v.valhex,0);var y=hextoutf8(p);v.str=y;delete v.valhex};(this||p).setMessageDigest=function(v){var p=F(v.valhex,0);v.hex=p;delete v.valhex};(this||p).setSigningCertificate=function(v){var p=T(v.valhex,0);if(p.length>0){var y=C(v.valhex,p[0]);var S=T(y,0);var E=[];for(var F=0;F<S.length;F++){var B=C(y,S[F]);var D=this.getESSCertID(B);E.push(D)}v.array=E}if(p.length>1){var P=C(v.valhex,p[1]);v.polhex=P}delete v.valhex};(this||p).setSignaturePolicyIdentifier=function(v){var p=T(v.valhex,0);if(p.length>0){var S=E.getOID(v.valhex,p[0]);v.oid=S}if(p.length>1){var B=new y;var D=T(v.valhex,p[1]);var P=C(v.valhex,D[0]);var R=B.getAlgorithmIdentifierName(P);v.alg=R;var N=F(v.valhex,D[1]);v.hash=N}delete v.valhex};(this||p).setSigningCertificateV2=function(v){var p=T(v.valhex,0);if(p.length>0){var y=C(v.valhex,p[0]);var S=T(y,0);var E=[];for(var F=0;F<S.length;F++){var B=C(y,S[F]);var D=this.getESSCertIDv2(B);E.push(D)}v.array=E}if(p.length>1){var P=C(v.valhex,p[1]);v.polhex=P}delete v.valhex};(this||p).getESSCertID=function(v){var p={};var y=T(v,0);if(y.length>0){var S=F(v,y[0]);p.hash=S}if(y.length>1){var E=C(v,y[1]);var B=this.getIssuerSerial(E);B.serial!=void 0&&(p.serial=B.serial);B.issuer!=void 0&&(p.issuer=B.issuer)}return p};(this||p).getESSCertIDv2=function(p){var y={};var E=T(p,0);if(E.length<1||3<E.length)throw new v("wrong number of elements");var B=0;if(p.substr(E[0],2)=="30"){var D=C(p,E[0]);y.alg=S.getAlgorithmIdentifierName(D);B++}else y.alg="sha256";var P=F(p,E[B]);y.hash=P;if(E.length>B+1){var R=C(p,E[B+1]);var N=this.getIssuerSerial(R);y.issuer=N.issuer;y.serial=N.serial}return y};(this||p).getIssuerSerial=function(v){var p={};var y=T(v,0);var E=C(v,y[0]);var B=S.getGeneralNames(E);var D=B[0].dn;p.issuer=D;var P=F(v,y[1]);p.serial={hex:P};return p};(this||p).getCertificateSet=function(v){var p=T(v,0);var y=[];for(var S=0;S<p.length;S++){var E=C(v,p[S]);if(E.substr(0,2)=="30"){var F=hextopem(E,"CERTIFICATE");y.push(F)}}return{array:y,sortflag:false}}};typeof nt!="undefined"&&nt||(nt={});typeof nt.asn1!="undefined"&&nt.asn1||(nt.asn1={});typeof nt.asn1.tsp!="undefined"&&nt.asn1.tsp||(nt.asn1.tsp={});nt.asn1.tsp.TimeStampToken=function(v){var y=nt,S=y.asn1,E=S.tsp;E.TimeStampToken.superclass.constructor.call(this||p);(this||p).params=null;(this||p).getEncodedHexPrepare=function(){var v=new E.TSTInfo((this||p).params.econtent.content);(this||p).params.econtent.content.hex=v.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.tsp.TimeStampToken,nt.asn1.cms.SignedData);nt.asn1.tsp.TSTInfo=function(v){Error;var y=nt,S=y.asn1,E=S.DERSequence,F=S.DERInteger,C=S.DERBoolean,B=S.DERGeneralizedTime,D=S.DERObjectIdentifier,P=S.DERTaggedObject,R=S.tsp,T=R.MessageImprint,N=R.Accuracy,O=(S.x509.X500Name,S.x509.GeneralName);R.TSTInfo.superclass.constructor.call(this||p);(this||p).dVersion=new F({int:1});(this||p).dPolicy=null;(this||p).dMessageImprint=null;(this||p).dSerial=null;(this||p).dGenTime=null;(this||p).dAccuracy=null;(this||p).dOrdering=null;(this||p).dNonce=null;(this||p).dTsa=null;(this||p).tohex=function(){var v=[(this||p).dVersion];if((this||p).dPolicy==null)throw new Error("policy shall be specified.");v.push((this||p).dPolicy);if((this||p).dMessageImprint==null)throw new Error("messageImprint shall be specified.");v.push((this||p).dMessageImprint);if((this||p).dSerial==null)throw new Error("serialNumber shall be specified.");v.push((this||p).dSerial);if((this||p).dGenTime==null)throw new Error("genTime shall be specified.");v.push((this||p).dGenTime);(this||p).dAccuracy!=null&&v.push((this||p).dAccuracy);(this||p).dOrdering!=null&&v.push((this||p).dOrdering);(this||p).dNonce!=null&&v.push((this||p).dNonce);(this||p).dTsa!=null&&v.push((this||p).dTsa);var y=new E({array:v});(this||p).hTLV=y.tohex();return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};if(v!==void 0){if(typeof v.policy=="string"){if(!v.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";(this||p).dPolicy=new D({oid:v.policy})}v.messageImprint!==void 0&&((this||p).dMessageImprint=new T(v.messageImprint));v.serial!==void 0&&((this||p).dSerial=new F(v.serial));v.genTime!==void 0&&((this||p).dGenTime=new B(v.genTime));v.accuracy!==void 0&&((this||p).dAccuracy=new N(v.accuracy));v.ordering!==void 0&&v.ordering==true&&((this||p).dOrdering=new C);v.nonce!==void 0&&((this||p).dNonce=new F(v.nonce));v.tsa!==void 0&&((this||p).dTsa=new P({tag:"a0",explicit:true,obj:new O({dn:v.tsa})}))}};extendClass(nt.asn1.tsp.TSTInfo,nt.asn1.ASN1Object);nt.asn1.tsp.Accuracy=function(v){var y=nt,S=y.asn1,E=S.ASN1Util.newObject;S.tsp.Accuracy.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var y=[];v.seconds!=void 0&&typeof v.seconds=="number"&&y.push({int:v.seconds});v.millis!=void 0&&typeof v.millis=="number"&&y.push({tag:{tagi:"80",obj:{int:v.millis}}});v.micros!=void 0&&typeof v.micros=="number"&&y.push({tag:{tagi:"81",obj:{int:v.micros}}});return E({seq:y}).tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.tsp.Accuracy,nt.asn1.ASN1Object);nt.asn1.tsp.MessageImprint=function(v){var y=nt,S=y.asn1,E=S.DERSequence,F=S.DEROctetString,C=S.x509,B=C.AlgorithmIdentifier;S.tsp.MessageImprint.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var y=new B({name:v.alg});var S=new F({hex:v.hash});var C=new E({array:[y,S]});return C.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.tsp.MessageImprint,nt.asn1.ASN1Object);nt.asn1.tsp.TimeStampReq=function(v){var y=nt,S=y.asn1,E=S.DERSequence,F=S.DERInteger,C=S.DERBoolean,B=(S.ASN1Object,S.DERObjectIdentifier),D=S.tsp,P=D.MessageImprint;D.TimeStampReq.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var y=[];y.push(new F({int:1}));v.messageImprint instanceof nt.asn1.ASN1Object?y.push(v.messageImprint):y.push(new P(v.messageImprint));v.policy!=void 0&&y.push(new B(v.policy));v.nonce!=void 0&&y.push(new F(v.nonce));v.certreq==true&&y.push(new C);var S=new E({array:y});return S.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.tsp.TimeStampReq,nt.asn1.ASN1Object);nt.asn1.tsp.TimeStampResp=function(v){var y=nt,S=y.asn1,E=S.DERSequence,F=(S.ASN1Object,S.tsp),C=F.PKIStatusInfo;F.TimeStampResp.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var y=[];if(v.econtent!=void 0||v.tst!=void 0){v.statusinfo!=void 0?y.push(new C(v.statusinfo)):y.push(new C("granted"));if(v.econtent!=void 0)y.push(new F.TimeStampToken(v).getContentInfo());else{if(!(v.tst instanceof S.ASN1Object))throw new Error("improper member tst value");y.push(v.tst)}}else{if(v.statusinfo==void 0)throw new Error("parameter for token nor statusinfo not specified");y.push(new C(v.statusinfo))}var B=new E({array:y});return B.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.tsp.TimeStampResp,nt.asn1.ASN1Object);nt.asn1.tsp.PKIStatusInfo=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERSequence,C=E.tsp,B=C.PKIStatus,D=C.PKIFreeText,P=C.PKIFailureInfo;C.PKIStatusInfo.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var S=[];if(typeof v=="string")S.push(new B(v));else{if(v.status==void 0)throw new y("property 'status' unspecified");S.push(new B(v.status));v.statusstr!=void 0&&S.push(new D(v.statusstr));v.failinfo!=void 0&&S.push(new P(v.failinfo))}var E=new F({array:S});return E.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.tsp.PKIStatusInfo,nt.asn1.ASN1Object);nt.asn1.tsp.PKIStatus=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERInteger,C=E.tsp;C.PKIStatus.superclass.constructor.call(this||p);var B={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var S;if(typeof v=="string")try{S=B[v]}catch(p){throw new y("undefined name: "+v)}else{if(typeof v!="number")throw new y("unsupported params");S=v}return new F({int:S}).tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.tsp.PKIStatus,nt.asn1.ASN1Object);nt.asn1.tsp.PKIFreeText=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERSequence,C=E.DERUTF8String,B=E.tsp;B.PKIFreeText.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;if(!v instanceof Array)throw new y("wrong params: not array");var S=[];for(var E=0;E<v.length;E++)S.push(new C({str:v[E]}));var B=new F({array:S});return B.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.tsp.PKIFreeText,nt.asn1.ASN1Object);nt.asn1.tsp.PKIFailureInfo=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERBitString,C=E.tsp,B=C.PKIFailureInfo;var D={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};B.superclass.constructor.call(this||p);(this||p).params=null;(this||p).getBinValue=function(){var v=(this||p).params;var S=0;if(typeof v=="number"&&0<=v&&v<=25){S|=1<<v;var E=S.toString(2);var F="";for(var C=E.length-1;C>=0;C--)F+=E[C];return F}if(typeof v=="string"&&D[v]!=void 0)return namearraytobinstr([v],D);if(typeof v=="object"&&v.length!=void 0)return namearraytobinstr(v,D);throw new y("wrong params")};(this||p).tohex=function(){(this||p).params;var v=this.getBinValue();return new F({bin:v}).tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.tsp.PKIFailureInfo,nt.asn1.ASN1Object);nt.asn1.tsp.AbstractTSAAdapter=function(v){(this||p).getTSTHex=function(v,p){throw"not implemented yet"}};nt.asn1.tsp.SimpleTSAAdapter=function(v){var y=nt,S=y.asn1,E=S.tsp,F=y.crypto.Util.hashHex;E.SimpleTSAAdapter.superclass.constructor.call(this||p);(this||p).params=null;(this||p).serial=0;(this||p).getTSTHex=function(v,y){var S=F(v,y);(this||p).params.econtent.content.messageImprint={alg:y,hash:S};(this||p).params.econtent.content.serial={int:(this||p).serial++};var C=Math.floor(Math.random()*1e9);(this||p).params.econtent.content.nonce={int:C};var B=new E.TimeStampToken((this||p).params);return B.getContentInfoEncodedHex()};v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.tsp.SimpleTSAAdapter,nt.asn1.tsp.AbstractTSAAdapter);nt.asn1.tsp.FixedTSAAdapter=function(v){var y=nt,S=y.asn1,E=S.tsp,F=y.crypto.Util.hashHex;E.FixedTSAAdapter.superclass.constructor.call(this||p);(this||p).params=null;(this||p).getTSTHex=function(v,y){var S=F(v,y);(this||p).params.econtent.content.messageImprint={alg:y,hash:S};var C=new E.TimeStampToken((this||p).params);return C.getContentInfoEncodedHex()};v!==void 0&&((this||p).params=v)};extendClass(nt.asn1.tsp.FixedTSAAdapter,nt.asn1.tsp.AbstractTSAAdapter);nt.asn1.tsp.TSPUtil=new function(){};nt.asn1.tsp.TSPUtil.newTimeStampToken=function(v){return new nt.asn1.tsp.TimeStampToken(v)};nt.asn1.tsp.TSPUtil.parseTimeStampReq=function(v){var p=new nt.asn1.tsp.TSPParser;return p.getTimeStampReq(v)};nt.asn1.tsp.TSPUtil.parseMessageImprint=function(v){var p=new nt.asn1.tsp.TSPParser;return p.getMessageImprint(v)};nt.asn1.tsp.TSPParser=function(){Error;var v=X509,y=new v,S=it,E=S.getV,F=S.getTLV,C=S.getIdxbyList,B=(S.getTLVbyListEx,S.getChildIdx);var D=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"];var P={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};(this||p).getResponse=function(v){var p=B(v,0);if(p.length==1)return this.getPKIStatusInfo(F(v,p[0]));if(p.length>1){var y=this.getPKIStatusInfo(F(v,p[0]));var S=F(v,p[1]);var E=this.getToken(S);E.statusinfo=y;return E}};(this||p).getToken=function(v){var p=new nt.asn1.cms.CMSParser;var y=p.getCMSSignedData(v);this.setTSTInfo(y);return y};(this||p).setTSTInfo=function(v){var p=v.econtent;if(p.type=="tstinfo"){var y=p.content.hex;var S=this.getTSTInfo(y);p.content=S}};(this||p).getTSTInfo=function(v){var S={};var C=B(v,0);var D=E(v,C[1]);S.policy=hextooid(D);var P=F(v,C[2]);S.messageImprint=this.getMessageImprint(P);var R=E(v,C[3]);S.serial={hex:R};var T=E(v,C[4]);S.genTime={str:hextoutf8(T)};var N=0;if(C.length>5&&v.substr(C[5],2)=="30"){var O=F(v,C[5]);S.accuracy=this.getAccuracy(O);N++}if(C.length>5+N&&v.substr(C[5+N],2)=="01"){var V=E(v,C[5+N]);V=="ff"&&(S.ordering=true);N++}if(C.length>5+N&&v.substr(C[5+N],2)=="02"){var L=E(v,C[5+N]);S.nonce={hex:L};N++}if(C.length>5+N&&v.substr(C[5+N],2)=="a0"){var M=F(v,C[5+N]);M="30"+M.substr(2);p.pGeneralNames=y.getGeneralNames(M);var _=pGeneralNames[0].dn;S.tsa=_;N++}if(C.length>5+N&&v.substr(C[5+N],2)=="a1"){var U=F(v,C[5+N]);U="30"+U.substr(2);var G=y.getExtParamArray(U);S.ext=G;N++}return S};(this||p).getAccuracy=function(v){var p={};var y=B(v,0);for(var S=0;S<y.length;S++){var F=v.substr(y[S],2);var C=E(v,y[S]);var D=parseInt(C,16);F=="02"?p.seconds=D:F=="80"?p.millis=D:F=="81"&&(p.micros=D)}return p};(this||p).getMessageImprint=function(v){if(v.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var p={};B(v,0);var y=C(v,0,[0,0]);var F=E(v,y);var D=S.hextooidstr(F);var P=nt.asn1.x509.OID.oid2name(D);if(P=="")throw new Error("hashAlg name undefined: "+D);var R=P;var T=C(v,0,[1]);p.alg=R;p.hash=E(v,T);return p};(this||p).getPKIStatusInfo=function(v){var p={};var y=B(v,0);var S=0;try{var C=E(v,y[0]);var P=parseInt(C,16);p.status=D[P]}catch(v){}if(y.length>1&&v.substr(y[1],2)=="30"){var R=F(v,y[1]);p.statusstr=this.getPKIFreeText(R);S++}if(y.length>S&&v.substr(y[1+S],2)=="03"){var T=F(v,y[1+S]);p.failinfo=this.getPKIFailureInfo(T)}return p};(this||p).getPKIFreeText=function(v){var p=[];var y=B(v,0);for(var E=0;E<y.length;E++)p.push(S.getString(v,y[E]));return p};(this||p).getPKIFailureInfo=function(v){var p=S.getInt(v,0);return P[p]!=void 0?P[p]:p};(this||p).getTimeStampReq=function(v){var p={};p.certreq=false;var y=B(v,0);if(y.length<2)throw new Error("TimeStampReq must have at least 2 items");var C=F(v,y[1]);p.messageImprint=nt.asn1.tsp.TSPUtil.parseMessageImprint(C);for(var D=2;D<y.length;D++){var P=y[D];var R=v.substr(P,2);if(R=="06"){var T=E(v,P);p.policy=S.hextooidstr(T)}R=="02"&&(p.nonce=E(v,P));R=="01"&&(p.certreq=true)}return p}};typeof nt!="undefined"&&nt||(nt={});typeof nt.asn1!="undefined"&&nt.asn1||(nt.asn1={});typeof nt.asn1.cades!="undefined"&&nt.asn1.cades||(nt.asn1.cades={});nt.asn1.cades.SignaturePolicyIdentifier=function(v){var y=nt,S=y.asn1,E=S.cades,F=E.SignaturePolicyId;E.SignaturePolicyIdentifier.superclass.constructor.call(this||p);(this||p).typeOid="1.2.840.113549.1.9.16.2.15";(this||p).params=null;(this||p).getValueArray=function(){return[new F((this||p).params)]};(this||p).setByParam=function(v){(this||p).params=v};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cades.SignaturePolicyIdentifier,nt.asn1.cms.Attribute);nt.asn1.cades.SignaturePolicyId=function(v){var y=nt,S=y.asn1,E=S.DERSequence,F=S.DERObjectIdentifier,C=S.x509,B=(C.AlgorithmIdentifier,S.cades),D=B.SignaturePolicyId,P=B.OtherHashAlgAndValue;D.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var y=[];y.push(new F(v.oid));y.push(new P(v));var S=new E({array:y});return S.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).setByParam=function(v){(this||p).params=v};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cades.SignaturePolicyId,nt.asn1.ASN1Object);nt.asn1.cades.OtherHashAlgAndValue=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERSequence,C=E.DEROctetString,B=E.x509,D=B.AlgorithmIdentifier,P=E.cades,R=P.OtherHashAlgAndValue;R.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;if(v.alg==void 0)throw new y("property 'alg' not specified");if(v.hash==void 0&&v.cert==void 0)throw new y("property 'hash' nor 'cert' not specified");var S=null;if(v.hash!=void 0)S=v.hash;else if(v.cert!=void 0){if(typeof v.cert!="string")throw new y("cert not string");var E=v.cert;v.cert.indexOf("-----BEGIN")!=-1&&(E=pemtohex(v.cert));S=nt.crypto.Util.hashHex(E,v.alg)}var B=[];B.push(new D({name:v.alg}));B.push(new C({hex:S}));var P=new F({array:B});return P.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cades.OtherHashAlgAndValue,nt.asn1.ASN1Object);nt.asn1.cades.OtherHashValue=function(v){nt.asn1.cades.OtherHashValue.superclass.constructor.call(this||p);var y=Error,S=nt,E=(S.lang.String.isHex,S.asn1),F=E.DEROctetString;S.crypto.Util.hashHex;(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;if(v.hash==void 0&&v.cert==void 0)throw new y("hash or cert not specified");var S=null;if(v.hash!=void 0)S=v.hash;else if(v.cert!=void 0){if(typeof v.cert!="string")throw new y("cert not string");var E=v.cert;v.cert.indexOf("-----BEGIN")!=-1&&(E=pemtohex(v.cert));S=nt.crypto.Util.hashHex(E,"sha1")}return new F({hex:S}).tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cades.OtherHashValue,nt.asn1.ASN1Object);nt.asn1.cades.SignatureTimeStamp=function(v){var y=Error,S=nt,E=S.lang.String.isHex,F=S.asn1,C=F.ASN1Object,B=(F.x509,F.cades);B.SignatureTimeStamp.superclass.constructor.call(this||p);(this||p).typeOid="1.2.840.113549.1.9.16.2.14";(this||p).params=null;(this||p).getValueArray=function(){var v=(this||p).params;if(v.tst!=void 0){if(E(v.tst)){var S=new C;S.hTLV=v.tst;return[S]}if(v.tst instanceof C)return[v.tst];throw new y("params.tst has wrong value")}if(v.res!=void 0){var F=v.res;F instanceof C&&(F=F.tohex());if(typeof F!="string"||!E(F))throw new y("params.res has wrong value");it.getTLVbyList(F,0,[1]);S=new C;S.hTLV=v.tst;return[S]}};v!=null&&this.setByParam(v)};extendClass(nt.asn1.cades.SignatureTimeStamp,nt.asn1.cms.Attribute);nt.asn1.cades.CompleteCertificateRefs=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERSequence,C=E.cades,B=C.OtherCertID,D=S.lang.String.isHex;C.CompleteCertificateRefs.superclass.constructor.call(this||p);(this||p).typeOid="1.2.840.113549.1.9.16.2.21";(this||p).params=null;(this||p).getValueArray=function(){var v=(this||p).params;var S=[];for(var E=0;E<v.array.length;E++){var C=v.array[E];if(typeof C=="string")if(C.indexOf("-----BEGIN")!=-1)C={cert:C};else{if(!D(C))throw new y("unsupported value: "+C);C={hash:C}}v.alg!=void 0&&C.alg==void 0&&(C.alg=v.alg);v.hasis!=void 0&&C.hasis==void 0&&(C.hasis=v.hasis);var P=new B(C);S.push(P)}var R=new F({array:S});return[R]};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cades.CompleteCertificateRefs,nt.asn1.cms.Attribute);nt.asn1.cades.OtherCertID=function(v){var y=nt,S=y.asn1,E=S.DERSequence,F=S.cms,C=F.IssuerSerial,B=S.cades,D=B.OtherHashValue,P=B.OtherHashAlgAndValue;B.OtherCertID.superclass.constructor.call(this||p);(this||p).params=v;(this||p).tohex=function(){var v=(this||p).params;typeof v=="string"&&(v.indexOf("-----BEGIN")!=-1?v={cert:v}:_isHex(v)&&(v={hash:v}));var y=[];var S=null;S=v.alg!=void 0?new P(v):new D(v);y.push(S);if(v.cert!=void 0&&v.hasis==true||v.issuer!=void 0&&v.serial!=void 0){var F=new C(v);y.push(F)}var B=new E({array:y});return B.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cades.OtherCertID,nt.asn1.ASN1Object);nt.asn1.cades.OtherHash=function(v){Error;var y=nt,S=y.asn1,E=(S.cms,S.cades),F=E.OtherHashAlgAndValue,C=E.OtherHashValue,B=(y.crypto.Util.hashHex,y.lang.String.isHex);E.OtherHash.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;typeof v=="string"&&(v.indexOf("-----BEGIN")!=-1?v={cert:v}:B(v)&&(v={hash:v}));var y=null;y=v.alg!=void 0?new F(v):new C(v);return y.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.cades.OtherHash,nt.asn1.ASN1Object);nt.asn1.cades.CAdESUtil=new function(){};nt.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(v){var p=new nt.asn1.cms.CMSParser;var y=p.getCMSSignedData(v);return y};nt.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(v,p,y){var S=it,E=S.getChildIdx,F=S.getTLV,C=S.getV,B=nt,D=B.asn1,P=D.ASN1Object,R=D.cms,T=R.AttributeList,N=R.SignerInfo;var O={};var V=E(v,p);if(V.length!=6)throw"not supported items for SignerInfo (!=6)";var L=V.shift();O.version=F(v,L);var M=V.shift();O.si=F(v,M);var _=V.shift();O.digalg=F(v,_);var U=V.shift();O.sattrs=F(v,U);var G=V.shift();O.sigalg=F(v,G);var X=V.shift();O.sig=F(v,X);O.sigval=C(v,X);var W=null;O.obj=new N;W=new P;W.hTLV=O.version;O.obj.dCMSVersion=W;W=new P;W.hTLV=O.si;O.obj.dSignerIdentifier=W;W=new P;W.hTLV=O.digalg;O.obj.dDigestAlgorithm=W;W=new P;W.hTLV=O.sattrs;O.obj.dSignedAttrs=W;W=new P;W.hTLV=O.sigalg;O.obj.dSigAlg=W;W=new P;W.hTLV=O.sig;O.obj.dSig=W;O.obj.dUnsignedAttrs=new T;return O};typeof nt.asn1.csr!="undefined"&&nt.asn1.csr||(nt.asn1.csr={});nt.asn1.csr.CertificationRequest=function(v){var y=nt,S=y.asn1,E=S.DERBitString,F=S.DERSequence,C=S.csr,B=(S.x509,C.CertificationRequestInfo);C.CertificationRequest.superclass.constructor.call(this||p);(this||p).setByParam=function(v){(this||p).params=v};(this||p).sign=function(){var v=new B((this||p).params).tohex();var y=new nt.crypto.Signature({alg:(this||p).params.sigalg});y.init((this||p).params.sbjprvkey);y.updateHex(v);var S=y.sign();(this||p).params.sighex=S};(this||p).getPEM=function(){return hextopem(this.tohex(),"CERTIFICATE REQUEST")};(this||p).tohex=function(){var v=(this||p).params;var y=new nt.asn1.csr.CertificationRequestInfo((this||p).params);var S=new nt.asn1.x509.AlgorithmIdentifier({name:v.sigalg});v.sighex==void 0&&v.sbjprvkey!=void 0&&this.sign();if(v.sighex==void 0)throw new Error("sighex or sbjprvkey parameter not defined");var C=new E({hex:"00"+v.sighex});var B=new F({array:[y,S,C]});return B.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.csr.CertificationRequest,nt.asn1.ASN1Object);nt.asn1.csr.CertificationRequestInfo=function(v){var y=nt,S=y.asn1,E=(S.DERBitString,S.DERSequence),F=S.DERInteger,C=S.DERUTF8String,B=S.DERTaggedObject,D=S.ASN1Util.newObject,P=S.csr,R=S.x509,T=R.X500Name,N=R.Extensions,O=R.SubjectPublicKeyInfo;P.AttributeList;P.CertificationRequestInfo.superclass.constructor.call(this||p);(this||p).params=null;(this||p).setByParam=function(v){v!=void 0&&((this||p).params=v)};(this||p).tohex=function(){var v=(this||p).params;var y=[];y.push(new F({int:0}));y.push(new T(v.subject));y.push(new O(ot.getKey(v.sbjpubkey)));if(v.attrs!=void 0){var S=m(v.attrs);var P=D({tag:{tage:"a0",obj:S}});y.push(P)}else if(v.extreq!=void 0){var R=new N(v.extreq);P=D({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[R]}]}}});y.push(P)}else y.push(new B({tag:"a0",explicit:false,obj:new C({str:""})}));var V=new E({array:y});return V.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};function m(v){var p=Error,y=nt.asn1.x509.Extensions;var S=[];for(var E=0;E<v.length;E++){var F=v[E];var C=F.attr;if(C=="extensionRequest"){var B=new y(F.ext);var D={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[B]}]};S.push(D)}else if(C=="unstructuredName"){D={seq:[{oid:"1.2.840.113549.1.9.2"},{set:F.names}]};S.push(D)}else{if(C!="challengePassword")throw new p("unknown CSR attribute");D={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:F.password}]}]};S.push(D)}}return{set:S}}v!=void 0&&this.setByParam(v)};extendClass(nt.asn1.csr.CertificationRequestInfo,nt.asn1.ASN1Object);nt.asn1.csr.AttributeList=function(v){};extendClass(nt.asn1.csr.AttributeList,nt.asn1.ASN1Object);nt.asn1.csr.CSRUtil=new function(){};nt.asn1.csr.CSRUtil.newCSRPEM=function(v){var p=nt.asn1.csr;var y=new p.CertificationRequest(v);var S=y.getPEM();return S};nt.asn1.csr.CSRUtil.getParam=function(v,p){var y=it,S=y.getV,E=y.getIdxbyList,F=y.getTLVbyList,C=y.getTLVbyListEx,B=y.getVbyListEx;var l=function(v){var p=E(v,0,[0,3,0,0],"06");return S(v,p)!="2a864886f70d01090e"?null:F(v,0,[0,3,0,1,0],"30")};var D={};if(v.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var P=pemtohex(v,"CERTIFICATE REQUEST");p&&(D.tbs=F(P,0,[0]));try{var R=C(P,0,[0,1]);if(R=="3000")D.subject={};else{var T=new X509;D.subject=T.getX500Name(R)}}catch(v){}var N=C(P,0,[0,2]);var O=ot.getKey(N,null,"pkcs8pub");D.sbjpubkey=ot.getPEM(O,"PKCS8PUB");var V=l(P);T=new X509;V!=null&&(D.extreq=T.getExtParamArray(V));try{var L=C(P,0,[1],"30");T=new X509;D.sigalg=T.getAlgorithmIdentifierName(L)}catch(v){}try{var M=B(P,0,[2]);D.sighex=M}catch(v){}return D};nt.asn1.csr.CSRUtil.verifySignature=function(v){try{var p=null;typeof v=="string"&&v.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?p=nt.asn1.csr.CSRUtil.getParam(v,true):typeof v=="object"&&v.sbjpubkey!=void 0&&v.sigalg!=void 0&&v.sighex!=void 0&&v.tbs!=void 0&&(p=v);if(p==null)return false;var y=new nt.crypto.Signature({alg:p.sigalg});y.init(p.sbjpubkey);y.updateHex(p.tbs);return y.verify(p.sighex)}catch(v){alert(v);return false}};typeof nt!="undefined"&&nt||(nt={});typeof nt.asn1!="undefined"&&nt.asn1||(nt.asn1={});typeof nt.asn1.ocsp!="undefined"&&nt.asn1.ocsp||(nt.asn1.ocsp={});nt.asn1.ocsp.DEFAULT_HASH="sha1";nt.asn1.ocsp.OCSPResponse=function(v){nt.asn1.ocsp.OCSPResponse.superclass.constructor.call(this||p);nt.asn1.DEREnumerated;var y=nt.asn1.ASN1Util.newObject,S=nt.asn1.ocsp.ResponseBytes;var E=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];(this||p).params=null;(this||p)._getStatusCode=function(){var v=(this||p).params.resstatus;return typeof v=="number"?v:typeof v!="string"?-1:E.indexOf(v)};(this||p).setByParam=function(v){(this||p).params=v};(this||p).tohex=function(){var v=(this||p).params;var E=this._getStatusCode();if(E==-1)throw new Error("responseStatus not supported: "+v.resstatus);if(E!=0)return y({seq:[{enum:{int:E}}]}).tohex();var F=new S(v);return y({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:true,obj:F}}]}).tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.ocsp.OCSPResponse,nt.asn1.ASN1Object);nt.asn1.ocsp.ResponseBytes=function(v){nt.asn1.ocsp.ResponseBytes.superclass.constructor.call(this||p);var y=nt.asn1,S=y.DERSequence,E=y.DERObjectIdentifier,F=y.DEROctetString,C=y.ocsp.BasicOCSPResponse;(this||p).params=null;(this||p).setByParam=function(v){(this||p).params=v};(this||p).tohex=function(){var v=(this||p).params;if(v.restype!="ocspBasic")throw new Error("not supported responseType: "+v.restype);var y=new C(v);var B=[];B.push(new E({name:"ocspBasic"}));B.push(new F({hex:y.tohex()}));var D=new S({array:B});return D.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.ocsp.ResponseBytes,nt.asn1.ASN1Object);nt.asn1.ocsp.BasicOCSPResponse=function(v){nt.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this||p);var y=Error,S=nt.asn1,E=S.ASN1Object,F=S.DERSequence,C=(S.DERGeneralizedTime,S.DERTaggedObject),B=S.DERBitString,D=(S.x509.Extensions,S.x509.AlgorithmIdentifier),P=S.ocsp;P.ResponderID;p._SingleResponseList=P.SingleResponseList,p._ResponseData=P.ResponseData;(this||p).params=null;(this||p).setByParam=function(v){(this||p).params=v};(this||p).sign=function(){var v=(this||p).params;var y=v.tbsresp.tohex();var S=new nt.crypto.Signature({alg:v.sigalg});S.init(v.reskey);S.updateHex(y);v.sighex=S.sign()};(this||p).tohex=function(){var v=(this||p).params;v.tbsresp==void 0&&(v.tbsresp=new _ResponseData(v));v.sighex==void 0&&v.reskey!=void 0&&this.sign();var S=[];S.push(v.tbsresp);S.push(new D({name:v.sigalg}));S.push(new B({hex:"00"+v.sighex}));if(v.certs!=void 0&&v.certs.length!=void 0){var P=[];for(var R=0;R<v.certs.length;R++){var T=v.certs[R];var N=null;if(it.isASN1HEX(T))N=T;else{if(!T.match(/-----BEGIN/))throw new y("certs["+R+"] not hex or PEM");N=pemtohex(T)}P.push(new E({tlv:N}))}var O=new F({array:P});S.push(new C({tag:"a0",explicit:true,obj:O}))}var V=new F({array:S});return V.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.ocsp.BasicOCSPResponse,nt.asn1.ASN1Object);nt.asn1.ocsp.ResponseData=function(v){nt.asn1.ocsp.ResponseData.superclass.constructor.call(this||p);var y=Error,S=nt.asn1,E=S.DERSequence,F=S.DERGeneralizedTime,C=S.DERTaggedObject,B=S.x509.Extensions,D=S.ocsp,P=D.ResponderID;p._SingleResponseList=D.SingleResponseList;(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;v.respid!=void 0&&new y("respid not specified");v.prodat!=void 0&&new y("prodat not specified");v.array!=void 0&&new y("array not specified");var S=[];S.push(new P(v.respid));S.push(new F(v.prodat));S.push(new _SingleResponseList(v.array));if(v.ext!=void 0){var D=new B(v.ext);S.push(new C({tag:"a1",explicit:true,obj:D}))}var R=new E({array:S});return R.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).setByParam=function(v){(this||p).params=v};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.ocsp.ResponseData,nt.asn1.ASN1Object);nt.asn1.ocsp.ResponderID=function(v){nt.asn1.ocsp.ResponderID.superclass.constructor.call(this||p);var y=nt,S=y.asn1,E=S.ASN1Util.newObject,F=S.x509.X500Name,C=y.lang.String.isHex,B=Error;(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;if(v.key!=void 0){var y=null;if(typeof v.key=="string"){C(v.key)&&(y=v.key);if(v.key.match(/-----BEGIN CERTIFICATE/)){var S=new X509(v.key);var D=S.getExtSubjectKeyIdentifier();D!=null&&(y=D.kid.hex)}}else if(v.key instanceof X509){D=v.key.getExtSubjectKeyIdentifier();D!=null&&(y=D.kid.hex)}if(y==null)throw new B("wrong key member value");var P=E({tag:{tag:"a2",explicit:true,obj:{octstr:{hex:y}}}});return P.tohex()}if(v.name!=void 0){var R=null;if(typeof v.name=="string"&&v.name.match(/-----BEGIN CERTIFICATE/)){S=new X509(v.name);R=S.getSubject()}else v.name instanceof X509?R=v.name.getSubject():typeof v.name!="object"||v.name.array==void 0&&v.name.str==void 0||(R=v.name);if(R==null)throw new B("wrong name member value");P=E({tag:{tag:"a1",explicit:true,obj:new F(R)}});return P.tohex()}throw new B("key or name not specified")};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).setByParam=function(v){(this||p).params=v};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.ocsp.ResponderID,nt.asn1.ASN1Object);nt.asn1.ocsp.SingleResponseList=function(v){nt.asn1.ocsp.SingleResponseList.superclass.constructor.call(this||p);var y=nt.asn1,S=y.DERSequence,E=y.ocsp.SingleResponse;(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;if(typeof v!="object"||v.length==void 0)throw new Error("params not specified properly");var y=[];for(var F=0;F<v.length;F++)y.push(new E(v[F]));var C=new S({array:y});return C.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).setByParam=function(v){(this||p).params=v};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.ocsp.SingleResponseList,nt.asn1.ASN1Object);nt.asn1.ocsp.SingleResponse=function(v){var y=Error,S=nt,E=S.asn1,F=E.DERSequence,C=E.DERGeneralizedTime,B=E.DERTaggedObject,D=E.ocsp,P=D.CertID,R=D.CertStatus,T=E.x509,N=T.Extensions;D.SingleResponse.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;var S=[];if(v.certid==void 0)throw new y("certid unspecified");if(v.status==void 0)throw new y("status unspecified");if(v.thisupdate==void 0)throw new y("thisupdate unspecified");S.push(new P(v.certid));S.push(new R(v.status));S.push(new C(v.thisupdate));if(v.nextupdate!=void 0){var E=new C(v.nextupdate);S.push(new B({tag:"a0",explicit:true,obj:E}))}if(v.ext!=void 0){var D=new N(v.ext);S.push(new B({tag:"a1",explicit:true,obj:D}))}var T=new F({array:S});return T.tohex()};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).setByParam=function(v){(this||p).params=v};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.ocsp.SingleResponse,nt.asn1.ASN1Object);nt.asn1.ocsp.CertID=function(v){var y=nt,S=y.asn1,E=S.DEROctetString,F=S.DERInteger,C=S.DERSequence,B=S.x509,D=B.AlgorithmIdentifier,P=S.ocsp,R=(P.DEFAULT_HASH,y.crypto),T=R.Util.hashHex,N=X509,O=it,V=O.getVbyList;P.CertID.superclass.constructor.call(this||p);(this||p).DEFAULT_HASH="sha1";(this||p).params=null;(this||p).setByValue=function(v,y,S,E){E==void 0&&(E=(this||p).DEFAULT_HASH);(this||p).params={alg:E,issname:v,isskey:y,sbjsn:S}};(this||p).setByCert=function(v,y,S){S==void 0&&(S=(this||p).DEFAULT_HASH);(this||p).params={alg:S,issuerCert:v,subjectCert:y}};(this||p).getParamByCerts=function(v,y,S){S==void 0&&(S=(this||p).DEFAULT_HASH);var E=new N(v);var F=new N(y);var C=T(E.getSubjectHex(),S);var B=E.getPublicKeyHex();var D=T(V(B,0,[1],"03",true),S);var P=F.getSerialNumberHex();var R={alg:S,issname:C,isskey:D,sbjsn:P};return R};(this||p).tohex=function(){if(typeof(this||p).params!="object")throw new Error("params not set");var v=(this||p).params;var y,S,B,P;P=v.alg==void 0?(this||p).DEFAULT_HASH:v.alg;if(v.issuerCert!=void 0&&v.subjectCert!=void 0){var R=this.getParamByCerts(v.issuerCert,v.subjectCert,P);y=R.issname;S=R.isskey;B=R.sbjsn}else{if(v.issname==void 0||v.isskey==void 0||v.sbjsn==void 0)throw new Error("required param members not defined");y=v.issname;S=v.isskey;B=v.sbjsn}var T=new D({name:P});var N=new E({hex:y});var O=new E({hex:S});var V=new F({hex:B});var L=new C({array:[T,N,O,V]});(this||p).hTLV=L.tohex();return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.ocsp.CertID,nt.asn1.ASN1Object);nt.asn1.ocsp.CertStatus=function(v){nt.asn1.ocsp.CertStatus.superclass.constructor.call(this||p);(this||p).params=null;(this||p).tohex=function(){var v=(this||p).params;if(v.status=="good")return"8000";if(v.status=="unknown")return"8200";if(v.status=="revoked"){var y=[{gentime:{str:v.time}}];v.reason!=void 0&&y.push({tag:{tag:"a0",explicit:true,obj:{enum:{int:v.reason}}}});var S={tag:"a1",explicit:false,obj:{seq:y}};return nt.asn1.ASN1Util.newObject({tag:S}).tohex()}throw new Error("bad status")};(this||p).getEncodedHex=function(){return this.tohex()};(this||p).setByParam=function(v){(this||p).params=v};v!==void 0&&this.setByParam(v)};extendClass(nt.asn1.ocsp.CertStatus,nt.asn1.ASN1Object);nt.asn1.ocsp.Request=function(v){var y=nt,S=y.asn1,E=S.DERSequence,F=S.ocsp;F.Request.superclass.constructor.call(this||p);(this||p).dReqCert=null;(this||p).dExt=null;(this||p).tohex=function(){var v=[];if((this||p).dReqCert===null)throw"reqCert not set";v.push((this||p).dReqCert);var y=new E({array:v});(this||p).hTLV=y.tohex();return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};if(typeof v!=="undefined"){var C=new F.CertID(v);(this||p).dReqCert=C}};extendClass(nt.asn1.ocsp.Request,nt.asn1.ASN1Object);nt.asn1.ocsp.TBSRequest=function(v){var y=nt,S=y.asn1,E=S.DERSequence,F=S.ocsp;F.TBSRequest.superclass.constructor.call(this||p);(this||p).version=0;(this||p).dRequestorName=null;(this||p).dRequestList=[];(this||p).dRequestExt=null;(this||p).setRequestListByParam=function(v){var y=[];for(var S=0;S<v.length;S++){var E=new F.Request(v[0]);y.push(E)}(this||p).dRequestList=y};(this||p).tohex=function(){var v=[];if((this||p).version!==0)throw"not supported version: "+(this||p).version;if((this||p).dRequestorName!==null)throw"requestorName not supported";var y=new E({array:(this||p).dRequestList});v.push(y);if((this||p).dRequestExt!==null)throw"requestExtensions not supported";var S=new E({array:v});(this||p).hTLV=S.tohex();return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};v!==void 0&&v.reqList!==void 0&&this.setRequestListByParam(v.reqList)};extendClass(nt.asn1.ocsp.TBSRequest,nt.asn1.ASN1Object);nt.asn1.ocsp.OCSPRequest=function(v){var y=nt,S=y.asn1,E=S.DERSequence,F=S.ocsp;F.OCSPRequest.superclass.constructor.call(this||p);(this||p).dTbsRequest=null;(this||p).dOptionalSignature=null;(this||p).tohex=function(){var v=[];if((this||p).dTbsRequest===null)throw"tbsRequest not set";v.push((this||p).dTbsRequest);if((this||p).dOptionalSignature!==null)throw"optionalSignature not supported";var y=new E({array:v});(this||p).hTLV=y.tohex();return(this||p).hTLV};(this||p).getEncodedHex=function(){return this.tohex()};if(v!==void 0&&v.reqList!==void 0){var C=new F.TBSRequest(v);(this||p).dTbsRequest=C}};extendClass(nt.asn1.ocsp.OCSPRequest,nt.asn1.ASN1Object);nt.asn1.ocsp.OCSPUtil={};nt.asn1.ocsp.OCSPUtil.getRequestHex=function(v,p,y){var S=nt,E=S.asn1,F=E.ocsp;y===void 0&&(y=F.DEFAULT_HASH);var C={alg:y,issuerCert:v,subjectCert:p};var B=new F.OCSPRequest({reqList:[C]});return B.tohex()};nt.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(v){var p=it,y=p.getVbyList,S=p.getVbyListEx,E=p.getIdxbyList,F=(p.getIdxbyListEx,p.getV);var C={};try{var B=S(v,0,[0],"0a");C.responseStatus=parseInt(B,16)}catch(v){}if(C.responseStatus!==0)return C;try{var D=E(v,0,[1,0,1,0,0,2,0,1]);if(v.substr(D,2)==="80")C.certStatus="good";else if(v.substr(D,2)==="a1"){C.certStatus="revoked";C.revocationTime=hextoutf8(y(v,D,[0]))}else v.substr(D,2)==="82"&&(C.certStatus="unknown")}catch(v){}try{var P=E(v,0,[1,0,1,0,0,2,0,2]);C.thisUpdate=hextoutf8(F(v,P))}catch(v){}try{var R=E(v,0,[1,0,1,0,0,2,0,3]);v.substr(R,2)==="a0"&&(C.nextUpdate=hextoutf8(y(v,R,[0])))}catch(v){}return C};nt.asn1.ocsp.OCSPParser=function(){var v=Error,y=X509,S=new y,E=it,F=E.getV,C=E.getTLV,B=E.getIdxbyList,D=E.getVbyList,P=E.getTLVbyList,R=E.getVbyListEx,T=E.getTLVbyListEx,N=E.getChildIdx;(this||p).getOCSPRequest=function(p){var y=N(p,0);if(y.length!=1&&y.length!=2)throw new v("wrong number elements: "+y.length);var S=this.getTBSRequest(C(p,y[0]));return S};(this||p).getTBSRequest=function(v){var p={};var y=T(v,0,[0],"30");p.array=this.getRequestList(y);var E=T(v,0,["[2]",0],"30");E!=null&&(p.ext=S.getExtParamArray(E));return p};(this||p).getRequestList=function(v){var p=[];var y=N(v,0);for(var S=0;S<y.length;S++){v=C(v,y[S]);p.push(this.getRequest(v))}return p};(this||p).getRequest=function(p){var y=N(p,0);if(y.length!=1&&y.length!=2)throw new v("wrong number elements: "+y.length);var E=this.getCertID(C(p,y[0]));if(y.length==2){var F=B(p,0,[1,0]);E.ext=S.getExtParamArray(C(p,F))}return E};(this||p).getCertID=function(p){var S=N(p,0);if(S.length!=4)throw new v("wrong number elements: "+S.length);var E=new y;var B={};B.alg=E.getAlgorithmIdentifierName(C(p,S[0]));B.issname=F(p,S[1]);B.isskey=F(p,S[2]);B.sbjsn=F(p,S[3]);return B};(this||p).getOCSPResponse=function(v){var p=N(v,0);var y;var S=F(v,p[0]);var E=parseInt(S);if(p.length==1)return{resstatus:E};var C=P(v,0,[1,0]);y=this.getResponseBytes(C);y.resstatus=E;return y};(this||p).getResponseBytes=function(v){var p=N(v,0);var y;var S=P(v,0,[1,0]);y=this.getBasicOCSPResponse(S);var E=F(v,p[0]);y.restype=nt.asn1.x509.OID.oid2name(hextooid(E));return y};(this||p).getBasicOCSPResponse=function(v){var p=N(v,0);var y;y=this.getResponseData(C(v,p[0]));var S=new X509;y.alg=S.getAlgorithmIdentifierName(C(v,p[1]));var E=F(v,p[2]);y.sighex=E.substr(2);var B=R(v,0,["[0]"]);if(B!=null){var D=N(B,0);var P=[];for(var T=0;T<D.length;T++){var O=C(B,D[T]);P.push(O)}y.certs=P}return y};(this||p).getResponseData=function(v){var p=N(v,0);var y=p.length;var S={};var E=0;v.substr(p[0],2)=="a0"&&E++;S.respid=this.getResponderID(C(v,p[E++]));var B=F(v,p[E++]);S.prodat=hextoutf8(B);S.array=this.getSingleResponseList(C(v,p[E++]));if(v.substr(p[y-1],2)=="a1"){var D=P(v,p[y-1],[0]);var R=new X509;S.ext=R.getExtParamArray(D)}return S};(this||p).getResponderID=function(v){var p={};if(v.substr(0,2)=="a2"){var y=D(v,0,[0]);p.key=y}if(v.substr(0,2)=="a1"){var S=P(v,0,[0]);var E=new X509;p.name=E.getX500Name(S)}return p};(this||p).getSingleResponseList=function(v){var p=N(v,0);var y=[];for(var S=0;S<p.length;S++){var E=this.getSingleResponse(C(v,p[S]));y.push(E)}return y};(this||p).getSingleResponse=function(v){var p=N(v,0);var y={};var S=this.getCertID(C(v,p[0]));y.certid=S;var E=this.getCertStatus(C(v,p[1]));y.status=E;if(v.substr(p[2],2)=="18"){var B=F(v,p[2]);y.thisupdate=hextoutf8(B)}for(var R=3;R<p.length;R++){if(v.substr(p[R],2)=="a0"){var T=D(v,p[R],[0],"18");y.nextupdate=hextoutf8(T)}if(v.substr(p[R],2)=="a1"){var O=new X509;var V=P(v,0,[R,0]);y.ext=O.getExtParamArray(V)}}return y};(this||p).getCertStatus=function(v){var p={};if(v=="8000")return{status:"good"};if(v=="8200")return{status:"unknown"};if(v.substr(0,2)=="a1"){p.status="revoked";var y=D(v,0,[0]);var S=hextoutf8(y);p.time=S}return p}};var nt;typeof nt!="undefined"&&nt||(nt={});typeof nt.lang!="undefined"&&nt.lang||(nt.lang={});nt.lang.String=function(){};function stoBA(v){var p=new Array;for(var y=0;y<v.length;y++)p[y]=v.charCodeAt(y);return p}function BAtos(v){var p="";for(var y=0;y<v.length;y++)p+=String.fromCharCode(v[y]);return p}function BAtohex(v){var p="";for(var y=0;y<v.length;y++){var S=v[y].toString(16);S.length==1&&(S="0"+S);p+=S}return p}function stohex(v){return BAtohex(stoBA(v))}function stob64(v){return hex2b64(stohex(v))}function stob64u(v){return b64tob64u(hex2b64(stohex(v)))}function b64utos(v){return BAtos(b64toBA(b64utob64(v)))}function b64tob64u(v){v=v.replace(/\=/g,"");v=v.replace(/\+/g,"-");v=v.replace(/\//g,"_");return v}function b64utob64(v){v.length%4==2?v+="==":v.length%4==3&&(v+="=");v=v.replace(/-/g,"+");v=v.replace(/_/g,"/");return v}function hextob64u(v){v.length%2==1&&(v="0"+v);return b64tob64u(hex2b64(v))}function b64utohex(v){return b64tohex(b64utob64(v))}var st,at;if(typeof S==="function"){st=function(v){return b64tob64u(S.from(v,"utf8").toString("base64"))};at=function(v){return S.from(b64utob64(v),"base64").toString("utf8")}}else{st=function(v){return hextob64u(uricmptohex(encodeURIComponentAll(v)))};at=function(v){return decodeURIComponent(hextouricmp(b64utohex(v)))}}function utf8tob64(v){return hex2b64(uricmptohex(encodeURIComponentAll(v)))}function b64toutf8(v){return decodeURIComponent(hextouricmp(b64tohex(v)))}function utf8tohex(v){return uricmptohex(encodeURIComponentAll(v)).toLowerCase()}function hextoutf8(v){try{return decodeURIComponent(hextouricmp(v))}catch(v){return null}}function iso88591hextoutf8(v){return hextoutf8(iso88591hextoutf8hex(v))}function iso88591hextoutf8hex(v){var p=v.match(/.{1,2}/g);var y=[];for(var S=0;S<p.length;S++){var E=parseInt(p[S],16);if(161<=E&&E<=191){y.push("c2");y.push(p[S])}else if(192<=E&&E<=255){y.push("c3");y.push((E-64).toString(16))}else y.push(p[S])}return y.join("")}function hextorstr(v){var p="";for(var y=0;y<v.length-1;y+=2)p+=String.fromCharCode(parseInt(v.substr(y,2),16));return p}function rstrtohex(v){var p="";for(var y=0;y<v.length;y++)p+=("0"+v.charCodeAt(y).toString(16)).slice(-2);return p}function hextob64(v){return hex2b64(v)}function hextob64nl(v){return foldnl(hextob64(v),64)}function foldnl(v,p){v=v.replace(new RegExp("(.{"+p+"})","g"),"$1\r\n");v=v.replace(/\s+$/,"");return v}function b64nltohex(v){var p=v.replace(/[^0-9A-Za-z\/+=]*/g,"");var y=b64tohex(p);return y}function b64topem(v,p){return"-----BEGIN "+p+"-----\r\n"+foldnl(v,64)+"\r\n-----END "+p+"-----\r\n"}function hextopem(v,p){return"-----BEGIN "+p+"-----\r\n"+foldnl(hextob64(v),64)+"\r\n-----END "+p+"-----\r\n"}function pemtohex(v,p){if(v.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");if(p!==void 0){v=v.replace(new RegExp("^[^]*-----BEGIN "+p+"-----"),"");v=v.replace(new RegExp("-----END "+p+"-----[^]*$"),"")}else{v=v.replace(/^[^]*-----BEGIN [^-]+-----/,"");v=v.replace(/-----END [^-]+-----[^]*$/,"")}return b64nltohex(v)}function pemtob64(v){if(v.indexOf("-----BEGIN ")==-1||v.indexOf("-----END ")==-1)return null;v=v.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,"");v=v.replace(/-----END [\s\S]+$/m,"");v=v.replace(/\s+/g,"");return v.match(/^[0-9a-zA-Z+/=]+$/)?v:null}function hextoArrayBuffer(v){if(v.length%2!=0)throw"input is not even length";if(v.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";var p=new ArrayBuffer(v.length/2);var y=new DataView(p);for(var S=0;S<v.length/2;S++)y.setUint8(S,parseInt(v.substr(S*2,2),16));return p}function ArrayBuffertohex(v){var p="";var y=new DataView(v);for(var S=0;S<v.byteLength;S++)p+=("00"+y.getUint8(S).toString(16)).slice(-2);return p}function zulutomsec(v){var p,y,S,E,F,C,B;var D,P,R;v=timetogen(v);R=v.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/);if(R){p=parseInt(R[1]);y=parseInt(R[2])-1;S=parseInt(R[3]);E=parseInt(R[4]);F=parseInt(R[5]);C=parseInt(R[6]);B=0;D=R[7];if(D!==""){P=(D.substr(1)+"00").substr(0,3);B=parseInt(P)}return Date.UTC(p,y,S,E,F,C,B)}throw new Error("unsupported zulu format: "+v)}function msectozulu(v){var p=new Date(v),y=("0000"+p.getUTCFullYear()).slice(-4),S=("00"+(p.getUTCMonth()+1)).slice(-2),E=("00"+p.getUTCDate()).slice(-2),F=("00"+p.getUTCHours()).slice(-2),C=("00"+p.getUTCMinutes()).slice(-2),B=("00"+p.getUTCSeconds()).slice(-2),D=("000"+p.getUTCMilliseconds()).slice(-3);D=D.replace(/0+$/,"");D=D!=""?"."+D:D;return y+S+E+F+C+B+D+"Z"}function zulutosec(v){return Math.round(zulutomsec(v)/1e3)}function zulutodate(v){return new Date(zulutomsec(v))}function datetozulu(v,p,y){var S;var E=v.getUTCFullYear();if(p){if(E<1950||2049<E)throw"not proper year for UTCTime: "+E;S=(""+E).slice(-2)}else S=("000"+E).slice(-4);S+=("0"+(v.getUTCMonth()+1)).slice(-2);S+=("0"+v.getUTCDate()).slice(-2);S+=("0"+v.getUTCHours()).slice(-2);S+=("0"+v.getUTCMinutes()).slice(-2);S+=("0"+v.getUTCSeconds()).slice(-2);if(y){var F=v.getUTCMilliseconds();if(F!==0){F=("00"+F).slice(-3);F=F.replace(/0+$/g,"");S+="."+F}}S+="Z";return S}function timetogen(v){return v.match(/^[0-9]{12}Z$/)||v.match(/^[0-9]{12}[.][0-9]*Z$/)?v.match(/^[0-4]/)?"20"+v:"19"+v:v}function uricmptohex(v){return v.replace(/%/g,"")}function hextouricmp(v){return v.replace(/(..)/g,"%$1")}function ipv6tohex(v){var p="malformed IPv6 address";if(!v.match(/^[0-9A-Fa-f:]+$/))throw p;v=v.toLowerCase();var y=v.split(":").length-1;if(y<2)throw p;var S=":".repeat(7-y+2);v=v.replace("::",S);var E=v.split(":");if(E.length!=8)throw p;for(var F=0;F<8;F++)E[F]=("0000"+E[F]).slice(-4);return E.join("")}function hextoipv6(v){if(!v.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+v);v=v.toLowerCase();var p=v.match(/.{1,4}/g);p=p.map((function(v){return v.replace(/^0+/,"")}));p=p.map((function(v){return v==""?"0":v}));v=":"+p.join(":")+":";var y=v.match(/:(0:){2,}/g);if(y==null)return v.slice(1,-1);var S=y.sort().slice(-1)[0];v=v.replace(S.substr(0,S.length-1),":");v.substr(0,2)!="::"&&(v=v.substr(1));v.substr(-2,2)!="::"&&(v=v.substr(0,v.length-1));return v}function hextoip(v){var p=new Error("malformed hex value");if(!v.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw p;if(v.length==8){var y;try{y=parseInt(v.substr(0,2),16)+"."+parseInt(v.substr(2,2),16)+"."+parseInt(v.substr(4,2),16)+"."+parseInt(v.substr(6,2),16);return y}catch(v){throw p}}else{if(v.length!=16){if(v.length==32)return hextoipv6(v);if(v.length==64){try{return hextoipv6(v.substr(0,32))+"/"+ipprefixlen(v.substr(32))}catch(v){throw p}return}return v}try{return hextoip(v.substr(0,8))+"/"+ipprefixlen(v.substr(8))}catch(v){throw p}}}function ipprefixlen(v){var p=new Error("malformed mask");var y;try{y=new BigInteger(v,16).toString(2)}catch(v){throw p}if(!y.match(/^1*0*$/))throw p;return y.replace(/0+$/,"").length}function iptohex(v){var p=new Error("malformed IP address");v=v.toLowerCase(v);if(!v.match(/^[0-9a-f.:/]+$/))throw p;if(!v.match(/^[0-9.]+$/)){if(v.match(/^[0-9.]+\/[0-9]+$/)){var y=v.split("/");return iptohex(y[0])+ipnetmask(parseInt(y[1]),32)}if(v.match(/^[0-9a-f:]+$/)&&v.indexOf(":")!==-1)return ipv6tohex(v);if(v.match(/^[0-9a-f:]+\/[0-9]+$/)&&v.indexOf(":")!==-1){y=v.split("/");return ipv6tohex(y[0])+ipnetmask(parseInt(y[1]),128)}throw p}var S=v.split(".");if(S.length!==4)throw p;var E="";try{for(var F=0;F<4;F++){var C=parseInt(S[F]);E+=("0"+C.toString(16)).slice(-2)}return E}catch(v){throw p}}function ipnetmask(v,p){if(p==32&&v==0)return"00000000";if(p==128&&v==0)return"00000000000000000000000000000000";var y=Array(v+1).join("1")+Array(p-v+1).join("0");return new BigInteger(y,2).toString(16)}function ucs2hextoutf8(v){function e(v){var p=parseInt(v.substr(0,2),16);var y=parseInt(v.substr(2),16);if(p==0&y<128)return String.fromCharCode(y);if(p<8){var S=192|(p&7)<<3|(y&192)>>6;var E=128|y&63;return hextoutf8(S.toString(16)+E.toString(16))}S=224|(p&240)>>4;E=128|(p&15)<<2|(y&192)>>6;var F=128|y&63;return hextoutf8(S.toString(16)+E.toString(16)+F.toString(16))}var p=v.match(/.{4}/g);var y=p.map(e);return y.join("")}function encodeURIComponentAll(v){var p=encodeURIComponent(v);var y="";for(var S=0;S<p.length;S++)if(p[S]=="%"){y+=p.substr(S,3);S+=2}else y=y+"%"+stohex(p[S]);return y}function newline_toUnix(v){v=v.replace(/\r\n/gm,"\n");return v}function newline_toDos(v){v=v.replace(/\r\n/gm,"\n");v=v.replace(/\n/gm,"\r\n");return v}nt.lang.String.isInteger=function(v){return!!v.match(/^[0-9]+$/)||!!v.match(/^-[0-9]+$/)};nt.lang.String.isHex=function(v){return ishex(v)};function ishex(v){return!(v.length%2!=0||!v.match(/^[0-9a-f]+$/)&&!v.match(/^[0-9A-F]+$/))}nt.lang.String.isBase64=function(v){v=v.replace(/\s+/g,"");return!(!v.match(/^[0-9A-Za-z+\/]+={0,3}$/)||v.length%4!=0)};nt.lang.String.isBase64URL=function(v){if(v.match(/[+/=]/))return false;v=b64utob64(v);return nt.lang.String.isBase64(v)};function isBase64URLDot(v){return!!v.match(/^[0-9A-Za-z-_.]+$/)}nt.lang.String.isIntegerArray=function(v){v=v.replace(/\s+/g,"");return!!v.match(/^\[[0-9,]+\]$/)};nt.lang.String.isPrintable=function(v){return v.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null};nt.lang.String.isIA5=function(v){return v.match(/^[\x20-\x21\x23-\x7f]*$/)!==null};nt.lang.String.isMail=function(v){return v.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function hextoposhex(v){return v.length%2==1?"0"+v:v.substr(0,1)>"7"?"00"+v:v}function intarystrtohex(v){v=v.replace(/^\s*\[\s*/,"");v=v.replace(/\s*\]\s*$/,"");v=v.replace(/\s*/g,"");try{var p=v.split(/,/).map((function(v,p,y){var S=parseInt(v);if(S<0||255<S)throw"integer not in range 0-255";var E=("00"+S.toString(16)).slice(-2);return E})).join("");return p}catch(v){throw"malformed integer array string: "+v}}var strdiffidx=function(v,p){var y=v.length;v.length>p.length&&(y=p.length);for(var S=0;S<y;S++)if(v.charCodeAt(S)!=p.charCodeAt(S))return S;return v.length!=p.length?y:-1};function oidtohex(v){var f=function(v){var p=v.toString(16);p.length==1&&(p="0"+p);return p};var e=function(v){var p="";var y=parseInt(v,10);var S=y.toString(2);var E=7-S.length%7;E==7&&(E=0);var F="";for(var C=0;C<E;C++)F+="0";S=F+S;for(C=0;C<S.length-1;C+=7){var B=S.substr(C,7);C!=S.length-7&&(B="1"+B);p+=f(parseInt(B,2))}return p};try{if(!v.match(/^[0-9.]+$/))return null;var p="";var y=v.split(".");var S=parseInt(y[0],10)*40+parseInt(y[1],10);p+=f(S);y.splice(0,2);for(var E=0;E<y.length;E++)p+=e(y[E]);return p}catch(v){return null}}function hextooid(v){if(!ishex(v))return null;try{var p=[];var y=v.substr(0,2);var S=parseInt(y,16);p[0]=new String(Math.floor(S/40));p[1]=new String(S%40);var E=v.substr(2);var F=[];for(var C=0;C<E.length/2;C++)F.push(parseInt(E.substr(C*2,2),16));var B=[];var D="";for(C=0;C<F.length;C++)if(F[C]&128)D+=strpad((F[C]&127).toString(2),7);else{D+=strpad((F[C]&127).toString(2),7);B.push(new String(parseInt(D,2)));D=""}var P=p.join(".");B.length>0&&(P=P+"."+B.join("."));return P}catch(v){return null}}function inttohex(v){var p=new BigInteger(String(v),10);return twoscompl(p)}function twoscompl(v){var p=v.toString(16);if(p.substr(0,1)!="-"){p.length%2==1?p="0"+p:p.match(/^[0-7]/)||(p="00"+p);return p}var y=p.substr(1);var S=y.length;S%2==1?S+=1:p.match(/^[0-7]/)||(S+=2);var E="";for(var F=0;F<S;F++)E+="f";var C=new BigInteger(E,16);var B=C.xor(v).add(BigInteger.ONE);p=B.toString(16).replace(/^-/,"");return p}var strpad=function(v,p,y){y==void 0&&(y="0");return v.length>=p?v:new Array(p-v.length+1).join(y)+v};function bitstrtoint(v){if(v.length%2!=0)return-1;v=v.toLowerCase();if(v.match(/^[0-9a-f]+$/)==null)return-1;try{var p=v.substr(0,2);if(p=="00")return parseInt(v.substr(2),16);var y=parseInt(p,16);if(y>7)return-1;var S=v.substr(2);var E=parseInt(S,16).toString(2);E=="0"&&(E="00000000");E=E.slice(0,0-y);var F=parseInt(E,2);return F==NaN?-1:F}catch(v){return-1}}function inttobitstr(v){if(typeof v!="number")return null;if(v<0)return null;var p=Number(v).toString(2);var y=8-p.length%8;y==8&&(y=0);p+=strpad("",y,"0");var S=parseInt(p,2).toString(16);S.length%2==1&&(S="0"+S);var E="0"+y;return E+S}function bitstrtobinstr(v){if(typeof v!="string")return null;if(v.length%2!=0)return null;if(!v.match(/^[0-9a-f]+$/))return null;try{var p=parseInt(v.substr(0,2),16);if(p<0||7<p)return null;var y=v.substr(2);var S="";for(var E=0;E<y.length;E+=2){var F=y.substr(E,2);var C=parseInt(F,16).toString(2);C=("0000000"+C).slice(-8);S+=C}return S.substr(0,S.length-p)}catch(v){return null}}function binstrtobitstr(v){if(typeof v!="string")return null;if(v.match(/^[01]+$/)==null)return null;try{var p=parseInt(v,2);return inttobitstr(p)}catch(v){return null}}function namearraytobinstr(v,p){var y=0;for(var S=0;S<v.length;S++)y|=1<<p[v[S]];var E=y.toString(2);var F="";for(S=E.length-1;S>=0;S--)F+=E[S];return F}function aryval(v,p,y){if(typeof v=="object"){p=String(p).split(".");for(var S=0;S<p.length&&v;S++){var E=p[S];E.match(/^[0-9]+$/)&&(E=parseInt(E));v=v[E]}return v||v===false?v:y}}function extendClass(v,p){var b=function(){};b.prototype=p.prototype;v.prototype=new b;v.prototype.constructor=v;v.superclass=p.prototype;p.prototype.constructor==Object.prototype.constructor&&(p.prototype.constructor=p)}typeof nt!="undefined"&&nt||(nt={});typeof nt.crypto!="undefined"&&nt.crypto||(nt.crypto={});nt.crypto.Util=new function(){(this||p).DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"};(this||p).DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"};(this||p).CRYPTOJSMESSAGEDIGESTNAME={md5:D.algo.MD5,sha1:D.algo.SHA1,sha224:D.algo.SHA224,sha256:D.algo.SHA256,sha384:D.algo.SHA384,sha512:D.algo.SHA512,ripemd160:D.algo.RIPEMD160};(this||p).getDigestInfoHex=function(v,y){if(typeof(this||p).DIGESTINFOHEAD[y]=="undefined")throw"alg not supported in Util.DIGESTINFOHEAD: "+y;return(this||p).DIGESTINFOHEAD[y]+v};(this||p).getPaddedDigestInfoHex=function(v,p,y){var S=this.getDigestInfoHex(v,p);var E=y/4;if(S.length+22>E)throw"key is too short for SigAlg: keylen="+y+","+p;var F="0001";var C="00"+S;var B="";var D=E-F.length-C.length;for(var P=0;P<D;P+=2)B+="ff";var R=F+B+C;return R};(this||p).hashString=function(v,p){var y=new nt.crypto.MessageDigest({alg:p});return y.digestString(v)};(this||p).hashHex=function(v,p){var y=new nt.crypto.MessageDigest({alg:p});return y.digestHex(v)};(this||p).sha1=function(v){return this.hashString(v,"sha1")};(this||p).sha256=function(v){return this.hashString(v,"sha256")};(this||p).sha256Hex=function(v){return this.hashHex(v,"sha256")};(this||p).sha512=function(v){return this.hashString(v,"sha512")};(this||p).sha512Hex=function(v){return this.hashHex(v,"sha512")};(this||p).isKey=function(v){return v instanceof RSAKey||v instanceof nt.crypto.DSA||v instanceof nt.crypto.ECDSA}};nt.crypto.Util.md5=function(v){var p=new nt.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return p.digestString(v)};nt.crypto.Util.ripemd160=function(v){var p=new nt.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return p.digestString(v)};nt.crypto.Util.SECURERANDOMGEN=new SecureRandom;nt.crypto.Util.getRandomHexOfNbytes=function(v){var p=new Array(v);nt.crypto.Util.SECURERANDOMGEN.nextBytes(p);return BAtohex(p)};nt.crypto.Util.getRandomBigIntegerOfNbytes=function(v){return new BigInteger(nt.crypto.Util.getRandomHexOfNbytes(v),16)};nt.crypto.Util.getRandomHexOfNbits=function(v){var p=v%8;var y=(v-p)/8;var S=new Array(y+1);nt.crypto.Util.SECURERANDOMGEN.nextBytes(S);S[0]=(255<<p&255^255)&S[0];return BAtohex(S)};nt.crypto.Util.getRandomBigIntegerOfNbits=function(v){return new BigInteger(nt.crypto.Util.getRandomHexOfNbits(v),16)};nt.crypto.Util.getRandomBigIntegerZeroToMax=function(v){var p=v.bitLength();while(1){var y=nt.crypto.Util.getRandomBigIntegerOfNbits(p);if(v.compareTo(y)!=-1)return y}};nt.crypto.Util.getRandomBigIntegerMinToMax=function(v,p){var y=v.compareTo(p);if(y==1)throw"biMin is greater than biMax";if(y==0)return v;var S=p.subtract(v);var E=nt.crypto.Util.getRandomBigIntegerZeroToMax(S);return E.add(v)};nt.crypto.MessageDigest=function(v){(this||p).setAlgAndProvider=function(v,y){v=nt.crypto.MessageDigest.getCanonicalAlgName(v);v!==null&&y===void 0&&(y=nt.crypto.Util.DEFAULTPROVIDER[v]);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(v)!=-1&&y=="cryptojs"){try{(this||p).md=nt.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[v].create()}catch(p){throw"setAlgAndProvider hash alg set fail alg="+v+"/"+p}(this||p).updateString=function(v){(this||p).md.update(v)};(this||p).updateHex=function(v){var y=D.enc.Hex.parse(v);(this||p).md.update(y)};(this||p).digest=function(){var v=(this||p).md.finalize();return v.toString(D.enc.Hex)};(this||p).digestString=function(v){this.updateString(v);return this.digest()};(this||p).digestHex=function(v){this.updateHex(v);return this.digest()}}if(":sha256:".indexOf(v)!=-1&&y=="sjcl"){try{(this||p).md=new sjcl.hash.sha256}catch(p){throw"setAlgAndProvider hash alg set fail alg="+v+"/"+p}(this||p).updateString=function(v){(this||p).md.update(v)};(this||p).updateHex=function(v){var y=sjcl.codec.hex.toBits(v);(this||p).md.update(y)};(this||p).digest=function(){var v=(this||p).md.finalize();return sjcl.codec.hex.fromBits(v)};(this||p).digestString=function(v){this.updateString(v);return this.digest()};(this||p).digestHex=function(v){this.updateHex(v);return this.digest()}}};(this||p).updateString=function(v){throw"updateString(str) not supported for this alg/prov: "+(this||p).algName+"/"+(this||p).provName};(this||p).updateHex=function(v){throw"updateHex(hex) not supported for this alg/prov: "+(this||p).algName+"/"+(this||p).provName};(this||p).digest=function(){throw"digest() not supported for this alg/prov: "+(this||p).algName+"/"+(this||p).provName};(this||p).digestString=function(v){throw"digestString(str) not supported for this alg/prov: "+(this||p).algName+"/"+(this||p).provName};(this||p).digestHex=function(v){throw"digestHex(hex) not supported for this alg/prov: "+(this||p).algName+"/"+(this||p).provName};if(v!==void 0&&v.alg!==void 0){(this||p).algName=v.alg;v.prov===void 0&&((this||p).provName=nt.crypto.Util.DEFAULTPROVIDER[(this||p).algName]);this.setAlgAndProvider((this||p).algName,(this||p).provName)}};nt.crypto.MessageDigest.getCanonicalAlgName=function(v){if(typeof v==="string"){v=v.toLowerCase();v=v.replace(/-/,"")}return v};nt.crypto.MessageDigest.getHashLength=function(v){var p=nt.crypto.MessageDigest;var y=p.getCanonicalAlgName(v);if(p.HASHLENGTH[y]===void 0)throw"not supported algorithm: "+v;return p.HASHLENGTH[y]};nt.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};nt.crypto.Mac=function(v){(this||p).setAlgAndProvider=function(v,y){v=v.toLowerCase();v==null&&(v="hmacsha1");v=v.toLowerCase();if(v.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+v;y===void 0&&(y=nt.crypto.Util.DEFAULTPROVIDER[v]);(this||p).algProv=v+"/"+y;var S=v.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(S)!=-1&&y=="cryptojs"){try{var E=nt.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[S];(this||p).mac=D.algo.HMAC.create(E,(this||p).pass)}catch(v){throw"setAlgAndProvider hash alg set fail hashAlg="+S+"/"+v}(this||p).updateString=function(v){(this||p).mac.update(v)};(this||p).updateHex=function(v){var y=D.enc.Hex.parse(v);(this||p).mac.update(y)};(this||p).doFinal=function(){var v=(this||p).mac.finalize();return v.toString(D.enc.Hex)};(this||p).doFinalString=function(v){this.updateString(v);return this.doFinal()};(this||p).doFinalHex=function(v){this.updateHex(v);return this.doFinal()}}};(this||p).updateString=function(v){throw"updateString(str) not supported for this alg/prov: "+(this||p).algProv};(this||p).updateHex=function(v){throw"updateHex(hex) not supported for this alg/prov: "+(this||p).algProv};(this||p).doFinal=function(){throw"digest() not supported for this alg/prov: "+(this||p).algProv};(this||p).doFinalString=function(v){throw"digestString(str) not supported for this alg/prov: "+(this||p).algProv};(this||p).doFinalHex=function(v){throw"digestHex(hex) not supported for this alg/prov: "+(this||p).algProv};(this||p).setPassword=function(v){if(typeof v!="string"){if(typeof v!="object")throw"KJUR.crypto.Mac unsupported password type: "+v;y=null;if(v.hex!==void 0){if(v.hex.length%2!=0||!v.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+v.hex;y=v.hex}v.utf8!==void 0&&(y=utf8tohex(v.utf8));v.rstr!==void 0&&(y=rstrtohex(v.rstr));v.b64!==void 0&&(y=b64tohex(v.b64));v.b64u!==void 0&&(y=b64utohex(v.b64u));if(y==null)throw"KJUR.crypto.Mac unsupported password type: "+v;(this||p).pass=D.enc.Hex.parse(y)}else{var y=v;v.length%2!=1&&v.match(/^[0-9A-Fa-f]+$/)||(y=rstrtohex(v));(this||p).pass=D.enc.Hex.parse(y)}};if(v!==void 0){v.pass!==void 0&&this.setPassword(v.pass);if(v.alg!==void 0){(this||p).algName=v.alg;v.prov===void 0&&((this||p).provName=nt.crypto.Util.DEFAULTPROVIDER[(this||p).algName]);this.setAlgAndProvider((this||p).algName,(this||p).provName)}}};nt.crypto.Signature=function(v){var y=null;(this||p)._setAlgNames=function(){var v=(this||p).algName.match(/^(.+)with(.+)$/);if(v){(this||p).mdAlgName=v[1].toLowerCase();(this||p).pubkeyAlgName=v[2].toLowerCase();(this||p).pubkeyAlgName=="rsaandmgf1"&&(this||p).mdAlgName=="sha"&&((this||p).mdAlgName="sha1")}};(this||p)._zeroPaddingOfSignature=function(v,p){var y="";var S=p/4-v.length;for(var E=0;E<S;E++)y+="0";return y+v};(this||p).setAlgAndProvider=function(v,y){this._setAlgNames();if(y!="cryptojs/jsrsa")throw new Error("provider not supported: "+y);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf((this||p).mdAlgName)!=-1){try{(this||p).md=new nt.crypto.MessageDigest({alg:(this||p).mdAlgName})}catch(v){throw new Error("setAlgAndProvider hash alg set fail alg="+(this||p).mdAlgName+"/"+v)}(this||p).init=function(v,y){var S=null;try{S=y===void 0?ot.getKey(v):ot.getKey(v,y)}catch(v){throw"init failed:"+v}if(S.isPrivate===true){(this||p).prvKey=S;(this||p).state="SIGN"}else{if(S.isPublic!==true)throw"init failed.:"+S;(this||p).pubKey=S;(this||p).state="VERIFY"}};(this||p).updateString=function(v){(this||p).md.updateString(v)};(this||p).updateHex=function(v){(this||p).md.updateHex(v)};(this||p).sign=function(){(this||p).sHashHex=(this||p).md.digest();(this||p).prvKey===void 0&&(this||p).ecprvhex!==void 0&&(this||p).eccurvename!==void 0&&nt.crypto.ECDSA!==void 0&&((this||p).prvKey=new nt.crypto.ECDSA({curve:(this||p).eccurvename,prv:(this||p).ecprvhex}));if((this||p).prvKey instanceof RSAKey&&(this||p).pubkeyAlgName==="rsaandmgf1")(this||p).hSign=(this||p).prvKey.signWithMessageHashPSS((this||p).sHashHex,(this||p).mdAlgName,(this||p).pssSaltLen);else if((this||p).prvKey instanceof RSAKey&&(this||p).pubkeyAlgName==="rsa")(this||p).hSign=(this||p).prvKey.signWithMessageHash((this||p).sHashHex,(this||p).mdAlgName);else if((this||p).prvKey instanceof nt.crypto.ECDSA)(this||p).hSign=(this||p).prvKey.signWithMessageHash((this||p).sHashHex);else{if(!((this||p).prvKey instanceof nt.crypto.DSA))throw"Signature: unsupported private key alg: "+(this||p).pubkeyAlgName;(this||p).hSign=(this||p).prvKey.signWithMessageHash((this||p).sHashHex)}return(this||p).hSign};(this||p).signString=function(v){this.updateString(v);return this.sign()};(this||p).signHex=function(v){this.updateHex(v);return this.sign()};(this||p).verify=function(v){(this||p).sHashHex=(this||p).md.digest();(this||p).pubKey===void 0&&(this||p).ecpubhex!==void 0&&(this||p).eccurvename!==void 0&&nt.crypto.ECDSA!==void 0&&((this||p).pubKey=new nt.crypto.ECDSA({curve:(this||p).eccurvename,pub:(this||p).ecpubhex}));if((this||p).pubKey instanceof RSAKey&&(this||p).pubkeyAlgName==="rsaandmgf1")return(this||p).pubKey.verifyWithMessageHashPSS((this||p).sHashHex,v,(this||p).mdAlgName,(this||p).pssSaltLen);if((this||p).pubKey instanceof RSAKey&&(this||p).pubkeyAlgName==="rsa")return(this||p).pubKey.verifyWithMessageHash((this||p).sHashHex,v);if(nt.crypto.ECDSA!==void 0&&(this||p).pubKey instanceof nt.crypto.ECDSA)return(this||p).pubKey.verifyWithMessageHash((this||p).sHashHex,v);if(nt.crypto.DSA!==void 0&&(this||p).pubKey instanceof nt.crypto.DSA)return(this||p).pubKey.verifyWithMessageHash((this||p).sHashHex,v);throw"Signature: unsupported public key alg: "+(this||p).pubkeyAlgName}}};(this||p).init=function(v,y){throw"init(key, pass) not supported for this alg:prov="+(this||p).algProvName};(this||p).updateString=function(v){throw"updateString(str) not supported for this alg:prov="+(this||p).algProvName};(this||p).updateHex=function(v){throw"updateHex(hex) not supported for this alg:prov="+(this||p).algProvName};(this||p).sign=function(){throw"sign() not supported for this alg:prov="+(this||p).algProvName};(this||p).signString=function(v){throw"digestString(str) not supported for this alg:prov="+(this||p).algProvName};(this||p).signHex=function(v){throw"digestHex(hex) not supported for this alg:prov="+(this||p).algProvName};(this||p).verify=function(v){throw"verify(hSigVal) not supported for this alg:prov="+(this||p).algProvName};(this||p).initParams=v;if(v!==void 0){if(v.alg!==void 0){(this||p).algName=v.alg;v.prov===void 0?(this||p).provName=nt.crypto.Util.DEFAULTPROVIDER[(this||p).algName]:(this||p).provName=v.prov;(this||p).algProvName=(this||p).algName+":"+(this||p).provName;this.setAlgAndProvider((this||p).algName,(this||p).provName);this._setAlgNames()}v.psssaltlen!==void 0&&((this||p).pssSaltLen=v.psssaltlen);if(v.prvkeypem!==void 0){if(v.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{y=ot.getKey(v.prvkeypem);this.init(y)}catch(v){throw"fatal error to load pem private key: "+v}}}};nt.crypto.Cipher=function(v){};nt.crypto.Cipher.encrypt=function(v,y,S,E){aryval(E,"enclag")!=void 0&&(S=E.encalg);if(typeof S=="string"&&S.substr(-4)=="-CBC"){var F=y;var C=v;aryval(E,"key")!=void 0&&(F=E.key);aryval(E,"enc")!=void 0&&(p.hEnc=E.enc);var B=D.enc.Hex.parse(F);var P=D.enc.Hex.parse(C);var R=D.enc.Hex.parse(E.iv);var T;if(S=="des-EDE3-CBC")T=D.TripleDES.encrypt(P,B,{iv:R});else{if(S!="aes128-CBC"&&S!="aes256-CBC")throw new Error("unsupported algorithm: "+S);T=D.AES.encrypt(P,B,{iv:R})}return T+""}throw new Error("Cipher.encrypt: unsupported key or algorithm")};nt.crypto.Cipher.decrypt=function(v,p,y,S){aryval(S,"enclag")!=void 0&&(y=S.encalg);if(typeof y=="string"&&y.substr(-4)=="-CBC"){var E=p;var F=v;aryval(S,"key")!=void 0&&(E=S.key);aryval(S,"enc")!=void 0&&(F=S.enc);var C=D.enc.Hex.parse(E);var B=D.enc.Hex.parse(F);var P=D.enc.Hex.parse(S.iv);var R;if(y=="des-EDE3-CBC")R=D.TripleDES.decrypt({ciphertext:B},C,{iv:P});else{if(y!="aes128-CBC"&&y!="aes256-CBC")throw new Error("unsupported algorithm: "+y);R=D.AES.decrypt({ciphertext:B},C,{iv:P})}return D.enc.Hex.stringify(R)}throw new Error("Cipher.decrypt: unsupported key or algorithm")};nt.crypto.OID=new function(){(this||p).oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};typeof nt!="undefined"&&nt||(nt={});typeof nt.crypto!="undefined"&&nt.crypto||(nt.crypto={});nt.crypto.ECDSA=function(v){var y="secp256r1";var S=Error,E=BigInteger,F=ECPointFp,C=nt.crypto.ECDSA,B=nt.crypto.ECParameterDB,D=C.getName,P=it,R=P.getVbyListEx,T=P.isASN1HEX;var N=new SecureRandom;(this||p).type="EC";(this||p).isPrivate=false;(this||p).isPublic=false;(this||p).getBigRandom=function(v){return new E(v.bitLength(),N).mod(v.subtract(E.ONE)).add(E.ONE)};(this||p).setNamedCurve=function(v){(this||p).ecparams=B.getByName(v);(this||p).prvKeyHex=null;(this||p).pubKeyHex=null;(this||p).curveName=v};(this||p).setPrivateKeyHex=function(v){(this||p).isPrivate=true;(this||p).prvKeyHex=v};(this||p).setPublicKeyHex=function(v){(this||p).isPublic=true;(this||p).pubKeyHex=v};(this||p).getPublicKeyXYHex=function(){var v=(this||p).pubKeyHex;if(v.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var y=(this||p).ecparams.keycharlen;if(v.length!==2+y*2)throw"malformed public key hex length";var S={};S.x=v.substr(2,y);S.y=v.substr(2+y);return S};(this||p).getShortNISTPCurveName=function(){var v=(this||p).curveName;return v==="secp256r1"||v==="NIST P-256"||v==="P-256"||v==="prime256v1"?"P-256":v==="secp384r1"||v==="NIST P-384"||v==="P-384"?"P-384":v==="secp521r1"||v==="NIST P-521"||v==="P-521"?"P-521":null};(this||p).generateKeyPairHex=function(){var v=(this||p).ecparams.n;var y=this.getBigRandom(v);var S=(this||p).ecparams.keycharlen;var E=("0000000000"+y.toString(16)).slice(-S);this.setPrivateKeyHex(E);var F=this.generatePublicKeyHex();return{ecprvhex:E,ecpubhex:F}};(this||p).generatePublicKeyHex=function(){var v=new E((this||p).prvKeyHex,16);var y=(this||p).ecparams.G.multiply(v);var S=y.getX().toBigInteger();var F=y.getY().toBigInteger();var C=(this||p).ecparams.keycharlen;var B=("0000000000"+S.toString(16)).slice(-C);var D=("0000000000"+F.toString(16)).slice(-C);var P="04"+B+D;this.setPublicKeyHex(P);return P};(this||p).signWithMessageHash=function(v){return this.signHex(v,(this||p).prvKeyHex)};(this||p).signHex=function(v,y){var S=new E(y,16);var F=(this||p).ecparams.n;var B=new E(v.substring(0,(this||p).ecparams.keycharlen),16);do{var D=this.getBigRandom(F);var P=(this||p).ecparams.G;var R=P.multiply(D);var T=R.getX().toBigInteger().mod(F)}while(T.compareTo(E.ZERO)<=0);var N=D.modInverse(F).multiply(B.add(S.multiply(T))).mod(F);return C.biRSSigToASN1Sig(T,N)};(this||p).sign=function(v,y){var S=y;var F=(this||p).ecparams.n;var C=E.fromByteArrayUnsigned(v);do{var B=this.getBigRandom(F);var D=(this||p).ecparams.G;var P=D.multiply(B);var R=P.getX().toBigInteger().mod(F)}while(R.compareTo(BigInteger.ZERO)<=0);var T=B.modInverse(F).multiply(C.add(S.multiply(R))).mod(F);return this.serializeSig(R,T)};(this||p).verifyWithMessageHash=function(v,y){return this.verifyHex(v,y,(this||p).pubKeyHex)};(this||p).verifyHex=function(v,y,S){try{var B,D;var P=C.parseSigHex(y);B=P.r;D=P.s;var R=F.decodeFromHex((this||p).ecparams.curve,S);var T=new E(v.substring(0,(this||p).ecparams.keycharlen),16);return this.verifyRaw(T,B,D,R)}catch(v){return false}};(this||p).verify=function(v,y,S){var C,B;if(Bitcoin.Util.isArray(y)){var D=this.parseSig(y);C=D.r;B=D.s}else{if("object"!==typeof y||!y.r||!y.s)throw"Invalid value for signature";C=y.r;B=y.s}var P;if(S instanceof ECPointFp)P=S;else{if(!Bitcoin.Util.isArray(S))throw"Invalid format for pubkey value, must be byte array or ECPointFp";P=F.decodeFrom((this||p).ecparams.curve,S)}var R=E.fromByteArrayUnsigned(v);return this.verifyRaw(R,C,B,P)};(this||p).verifyRaw=function(v,y,S,F){var C=(this||p).ecparams.n;var B=(this||p).ecparams.G;if(y.compareTo(E.ONE)<0||y.compareTo(C)>=0)return false;if(S.compareTo(E.ONE)<0||S.compareTo(C)>=0)return false;var D=S.modInverse(C);var P=v.multiply(D).mod(C);var R=y.multiply(D).mod(C);var T=B.multiply(P).add(F.multiply(R));var N=T.getX().toBigInteger().mod(C);return N.equals(y)};(this||p).serializeSig=function(v,p){var y=v.toByteArraySigned();var S=p.toByteArraySigned();var E=[];E.push(2);E.push(y.length);E=E.concat(y);E.push(2);E.push(S.length);E=E.concat(S);E.unshift(E.length);E.unshift(48);return E};(this||p).parseSig=function(v){var p;if(v[0]!=48)throw new Error("Signature not a valid DERSequence");p=2;if(v[p]!=2)throw new Error("First element in signature must be a DERInteger");var y=v.slice(p+2,p+2+v[p+1]);p+=2+v[p+1];if(v[p]!=2)throw new Error("Second element in signature must be a DERInteger");var S=v.slice(p+2,p+2+v[p+1]);p+=2+v[p+1];var F=E.fromByteArrayUnsigned(y);var C=E.fromByteArrayUnsigned(S);return{r:F,s:C}};(this||p).parseSigCompact=function(v){if(v.length!==65)throw"Signature has the wrong length";var y=v[0]-27;if(y<0||y>7)throw"Invalid signature type";var S=(this||p).ecparams.n;var F=E.fromByteArrayUnsigned(v.slice(1,33)).mod(S);var C=E.fromByteArrayUnsigned(v.slice(33,65)).mod(S);return{r:F,s:C,i:y}};(this||p).readPKCS5PrvKeyHex=function(v){if(T(v)===false)throw new Error("not ASN.1 hex string");var y,S,E;try{y=R(v,0,["[0]",0],"06");S=R(v,0,[1],"04");try{E=R(v,0,["[1]",0],"03")}catch(v){}}catch(v){throw new Error("malformed PKCS#1/5 plain ECC private key")}(this||p).curveName=D(y);if((this||p).curveName===void 0)throw"unsupported curve name";this.setNamedCurve((this||p).curveName);this.setPublicKeyHex(E);this.setPrivateKeyHex(S);(this||p).isPublic=false};(this||p).readPKCS8PrvKeyHex=function(v){if(T(v)===false)throw new S("not ASN.1 hex string");var y,E,F;try{R(v,0,[1,0],"06");y=R(v,0,[1,1],"06");E=R(v,0,[2,0,1],"04");try{F=R(v,0,[2,0,"[1]",0],"03")}catch(v){}}catch(v){throw new S("malformed PKCS#8 plain ECC private key")}(this||p).curveName=D(y);if((this||p).curveName===void 0)throw new S("unsupported curve name");this.setNamedCurve((this||p).curveName);this.setPublicKeyHex(F);this.setPrivateKeyHex(E);(this||p).isPublic=false};(this||p).readPKCS8PubKeyHex=function(v){if(T(v)===false)throw new S("not ASN.1 hex string");var y,E;try{R(v,0,[0,0],"06");y=R(v,0,[0,1],"06");E=R(v,0,[1],"03")}catch(v){throw new S("malformed PKCS#8 ECC public key")}(this||p).curveName=D(y);if((this||p).curveName===null)throw new S("unsupported curve name");this.setNamedCurve((this||p).curveName);this.setPublicKeyHex(E)};(this||p).readCertPubKeyHex=function(v,y){if(T(v)===false)throw new S("not ASN.1 hex string");var E,F;try{E=R(v,0,[0,5,0,1],"06");F=R(v,0,[0,5,1],"03")}catch(v){throw new S("malformed X.509 certificate ECC public key")}(this||p).curveName=D(E);if((this||p).curveName===null)throw new S("unsupported curve name");this.setNamedCurve((this||p).curveName);this.setPublicKeyHex(F)};v!==void 0&&v.curve!==void 0&&((this||p).curveName=v.curve);(this||p).curveName===void 0&&((this||p).curveName=y);this.setNamedCurve((this||p).curveName);if(v!==void 0){v.prv!==void 0&&this.setPrivateKeyHex(v.prv);v.pub!==void 0&&this.setPublicKeyHex(v.pub)}};nt.crypto.ECDSA.parseSigHex=function(v){var p=nt.crypto.ECDSA.parseSigHexInHexRS(v);var y=new BigInteger(p.r,16);var S=new BigInteger(p.s,16);return{r:y,s:S}};nt.crypto.ECDSA.parseSigHexInHexRS=function(v){var p=it,y=p.getChildIdx,S=p.getV;p.checkStrictDER(v,0);if(v.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var E=y(v,0);if(E.length!=2)throw new Error("signature shall have two elements");var F=E[0];var C=E[1];if(v.substr(F,2)!="02")throw new Error("1st item not ASN.1 integer");if(v.substr(C,2)!="02")throw new Error("2nd item not ASN.1 integer");var B=S(v,F);var D=S(v,C);return{r:B,s:D}};nt.crypto.ECDSA.asn1SigToConcatSig=function(v){var p=nt.crypto.ECDSA.parseSigHexInHexRS(v);var y=p.r;var S=p.s;if(y.length>=130&&y.length<=134){if(y.length%2!=0)throw Error("unknown ECDSA sig r length error");if(S.length%2!=0)throw Error("unknown ECDSA sig s length error");y.substr(0,2)=="00"&&(y=y.substr(2));S.substr(0,2)=="00"&&(S=S.substr(2));var E=Math.max(y.length,S.length);y=("000000"+y).slice(-E);S=("000000"+S).slice(-E);return y+S}y.substr(0,2)=="00"&&y.length%32==2&&(y=y.substr(2));S.substr(0,2)=="00"&&S.length%32==2&&(S=S.substr(2));y.length%32==30&&(y="00"+y);S.length%32==30&&(S="00"+S);if(y.length%32!=0)throw Error("unknown ECDSA sig r length error");if(S.length%32!=0)throw Error("unknown ECDSA sig s length error");return y+S};nt.crypto.ECDSA.concatSigToASN1Sig=function(v){if(v.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var p=v.substr(0,v.length/2);var y=v.substr(v.length/2);return nt.crypto.ECDSA.hexRSSigToASN1Sig(p,y)};nt.crypto.ECDSA.hexRSSigToASN1Sig=function(v,p){var y=new BigInteger(v,16);var S=new BigInteger(p,16);return nt.crypto.ECDSA.biRSSigToASN1Sig(y,S)};nt.crypto.ECDSA.biRSSigToASN1Sig=function(v,p){var y=nt.asn1;var S=new y.DERInteger({bigint:v});var E=new y.DERInteger({bigint:p});var F=new y.DERSequence({array:[S,E]});return F.tohex()};nt.crypto.ECDSA.getName=function(v){return v==="2b8104001f"?"secp192k1":v==="2a8648ce3d030107"?"secp256r1":v==="2b8104000a"?"secp256k1":v==="2b81040021"?"secp224r1":v==="2b81040022"?"secp384r1":v==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(v)!==-1?"secp256r1":"|secp256k1|".indexOf(v)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(v)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(v)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(v)!==-1?"secp521r1":null};typeof nt!="undefined"&&nt||(nt={});typeof nt.crypto!="undefined"&&nt.crypto||(nt.crypto={});nt.crypto.ECParameterDB=new function(){var v={};var y={};function a(v){return new BigInteger(v,16)}(this||p).getByName=function(p){var S=p;typeof y[S]!="undefined"&&(S=y[p]);if(typeof v[S]!="undefined")return v[S];throw"unregistered EC curve name: "+S};(this||p).regist=function(p,S,E,F,C,B,D,P,R,T,N,O){v[p]={};var V=a(E);var L=a(F);var M=a(C);var _=a(B);var U=a(D);var G=new ECCurveFp(V,L,M);var X=G.decodePointHex("04"+P+R);v[p].name=p;v[p].keylen=S;v[p].keycharlen=Math.ceil(S/8)*2;v[p].curve=G;v[p].G=X;v[p].n=_;v[p].h=U;v[p].oid=N;v[p].info=O;for(var W=0;W<T.length;W++)y[T[W]]=p}};nt.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");nt.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");nt.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");nt.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);nt.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);nt.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);nt.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);nt.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);nt.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);nt.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);typeof nt!="undefined"&&nt||(nt={});typeof nt.crypto!="undefined"&&nt.crypto||(nt.crypto={});nt.crypto.DSA=function(){var v=it,y=(v.getVbyList,v.getVbyListEx),S=v.isASN1HEX,E=BigInteger;(this||p).p=null;(this||p).q=null;(this||p).g=null;(this||p).y=null;(this||p).x=null;(this||p).type="DSA";(this||p).isPrivate=false;(this||p).isPublic=false;(this||p).setPrivate=function(v,y,S,E,F){(this||p).isPrivate=true;(this||p).p=v;(this||p).q=y;(this||p).g=S;(this||p).y=E;(this||p).x=F};(this||p).setPrivateHex=function(v,p,y,S,E){var F,C,B,D,P;F=new BigInteger(v,16);C=new BigInteger(p,16);B=new BigInteger(y,16);D=typeof S==="string"&&S.length>1?new BigInteger(S,16):null;P=new BigInteger(E,16);this.setPrivate(F,C,B,D,P)};(this||p).setPublic=function(v,y,S,E){(this||p).isPublic=true;(this||p).p=v;(this||p).q=y;(this||p).g=S;(this||p).y=E;(this||p).x=null};(this||p).setPublicHex=function(v,p,y,S){var E,F,C,B;E=new BigInteger(v,16);F=new BigInteger(p,16);C=new BigInteger(y,16);B=new BigInteger(S,16);this.setPublic(E,F,C,B)};(this||p).signWithMessageHash=function(v){var y=(this||p).p;var S=(this||p).q;var E=(this||p).g;(this||p).y;var F=(this||p).x;var C=nt.crypto.Util.getRandomBigIntegerMinToMax(BigInteger.ONE.add(BigInteger.ONE),S.subtract(BigInteger.ONE));var B=v.substr(0,S.bitLength()/4);var D=new BigInteger(B,16);var P=E.modPow(C,y).mod(S);var R=C.modInverse(S).multiply(D.add(F.multiply(P))).mod(S);var T=nt.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:P}},{int:{bigint:R}}]});return T};(this||p).verifyWithMessageHash=function(v,y){var S=(this||p).p;var E=(this||p).q;var F=(this||p).g;var C=(this||p).y;var B=this.parseASN1Signature(y);var D=B[0];var P=B[1];var R=v.substr(0,E.bitLength()/4);var T=new BigInteger(R,16);if(BigInteger.ZERO.compareTo(D)>0||D.compareTo(E)>0)throw"invalid DSA signature";if(BigInteger.ZERO.compareTo(P)>=0||P.compareTo(E)>0)throw"invalid DSA signature";var N=P.modInverse(E);var O=T.multiply(N).mod(E);var V=D.multiply(N).mod(E);var L=F.modPow(O,S).multiply(C.modPow(V,S)).mod(S).mod(E);return L.compareTo(D)==0};(this||p).parseASN1Signature=function(v){try{var p=new E(y(v,0,[0],"02"),16);var S=new E(y(v,0,[1],"02"),16);return[p,S]}catch(v){throw new Error("malformed ASN.1 DSA signature")}};(this||p).readPKCS5PrvKeyHex=function(v){var p,E,F,C,B;if(S(v)===false)throw new Error("not ASN.1 hex string");try{p=y(v,0,[1],"02");E=y(v,0,[2],"02");F=y(v,0,[3],"02");C=y(v,0,[4],"02");B=y(v,0,[5],"02")}catch(v){throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(p,E,F,C,B)};(this||p).readPKCS8PrvKeyHex=function(v){var p,E,F,C;if(S(v)===false)throw new Error("not ASN.1 hex string");try{p=y(v,0,[1,1,0],"02");E=y(v,0,[1,1,1],"02");F=y(v,0,[1,1,2],"02");C=y(v,0,[2,0],"02")}catch(v){throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(p,E,F,null,C)};(this||p).readPKCS8PubKeyHex=function(v){var p,E,F,C;if(S(v)===false)throw new Error("not ASN.1 hex string");try{p=y(v,0,[0,1,0],"02");E=y(v,0,[0,1,1],"02");F=y(v,0,[0,1,2],"02");C=y(v,0,[1,0],"02")}catch(v){throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(p,E,F,C)};(this||p).readCertPubKeyHex=function(v,p){var E,F,C,B;if(S(v)===false)throw new Error("not ASN.1 hex string");try{E=y(v,0,[0,5,0,1,0],"02");F=y(v,0,[0,5,0,1,1],"02");C=y(v,0,[0,5,0,1,2],"02");B=y(v,0,[0,5,1,0],"02")}catch(v){throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(E,F,C,B)}};var ot=function(){var d=function(v,p,y){return k(D.AES,v,p,y)};var e=function(v,p,y){return k(D.TripleDES,v,p,y)};var a=function(v,p,y){return k(D.DES,v,p,y)};var k=function(v,p,y,S){var E=D.enc.Hex.parse(p);var F=D.enc.Hex.parse(y);var C=D.enc.Hex.parse(S);var B={};B.key=F;B.iv=C;B.ciphertext=E;var P=v.decrypt(B,F,{iv:C});return D.enc.Hex.stringify(P)};var l=function(v,p,y){return g(D.AES,v,p,y)};var o=function(v,p,y){return g(D.TripleDES,v,p,y)};var f=function(v,p,y){return g(D.DES,v,p,y)};var g=function(v,p,y,S){var E=D.enc.Hex.parse(p);var F=D.enc.Hex.parse(y);var C=D.enc.Hex.parse(S);var B=v.encrypt(E,F,{iv:C});var P=D.enc.Hex.parse(B.toString());var R=D.enc.Base64.stringify(P);return R};var v={"AES-256-CBC":{proc:d,eproc:l,keylen:32,ivlen:16},"AES-192-CBC":{proc:d,eproc:l,keylen:24,ivlen:16},"AES-128-CBC":{proc:d,eproc:l,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:e,eproc:o,keylen:24,ivlen:8},"DES-CBC":{proc:a,eproc:f,keylen:8,ivlen:8}};var m=function(v){var p=D.lib.WordArray.random(v);var y=D.enc.Hex.stringify(p);return y};var n=function(v){var p={};var y=v.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));if(y){p.cipher=y[1];p.ivsalt=y[2]}var S=v.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));S&&(p.type=S[1]);var E=-1;var F=0;if(v.indexOf("\r\n\r\n")!=-1){E=v.indexOf("\r\n\r\n");F=2}if(v.indexOf("\n\n")!=-1){E=v.indexOf("\n\n");F=1}var C=v.indexOf("-----END");if(E!=-1&&C!=-1){var B=v.substring(E+F*2,C-F);B=B.replace(/\s+/g,"");p.data=B}return p};var j=function(p,y,S){var E=S.substring(0,16);var F=D.enc.Hex.parse(E);var C=D.enc.Utf8.parse(y);var B=v[p].keylen+v[p].ivlen;var P="";var R=null;for(;;){var T=D.algo.MD5.create();R!=null&&T.update(R);T.update(C);T.update(F);R=T.finalize();P+=D.enc.Hex.stringify(R);if(P.length>=B*2)break}var N={};N.keyhex=P.substr(0,v[p].keylen*2);N.ivhex=P.substr(v[p].keylen*2,v[p].ivlen*2);return N};var b=function(p,y,S,E){var F=D.enc.Base64.parse(p);var C=D.enc.Hex.stringify(F);var B=v[y].proc;var P=B(C,S,E);return P};var h=function(p,y,S,E){var F=v[y].eproc;var C=F(p,S,E);return C};return{version:"1.0.0",parsePKCS5PEM:function(v){return n(v)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(v,p,y){return j(v,p,y)},decryptKeyB64:function(v,p,y,S){return b(v,p,y,S)},getDecryptedKeyHex:function(v,p){var y=n(v);y.type;var S=y.cipher;var E=y.ivsalt;var F=y.data;var C=j(S,p,E);var B=C.keyhex;var D=b(F,S,B,E);return D},getEncryptedPKCS5PEMFromPrvKeyHex:function(p,y,S,E,F){var C="";typeof E!="undefined"&&E!=null||(E="AES-256-CBC");if(typeof v[E]=="undefined")throw new Error("KEYUTIL unsupported algorithm: "+E);if(typeof F=="undefined"||F==null){var B=v[E].ivlen;var D=m(B);F=D.toUpperCase()}var P=j(E,S,F);var R=P.keyhex;var T=h(y,E,R,F);var N=T.replace(/(.{64})/g,"$1\r\n");C="-----BEGIN "+p+" PRIVATE KEY-----\r\n";C+="Proc-Type: 4,ENCRYPTED\r\n";C+="DEK-Info: "+E+","+F+"\r\n";C+="\r\n";C+=N;C+="\r\n-----END "+p+" PRIVATE KEY-----\r\n";return C},getEncryptedPKCS8PEM:function(v,p,y){var S=this.getEncryptedPKCS8Hex(v,p,y);return hextopem(S,"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(v,p,y){var S;S=y==void 0||y==null?{}:JSON.parse(JSON.stringify(y));S.plain=v;this.initPBES2Param(S);this.encryptPBES2Param(S,p);var E=this.generatePBES2ASN1Param(S);return nt.asn1.ASN1Util.newObject(E).tohex()},initPBES2Param:function(v){aryval(v,"encalg")==void 0&&(v.encalg="aes256-CBC");aryval(v,"iter")==void 0&&(v.iter=2048);aryval(v,"prf")==void 0&&(v.prf="hmacWithSHA256");aryval(v,"salt")==void 0&&(v.salt=D.enc.Hex.stringify(D.lib.WordArray.random(8)));if(aryval(v,"enciv")==void 0){var p;v.encalg=="des-EDE3-CBC"&&(p=8);v.encalg=="aes128-CBC"&&(p=16);v.encalg=="aes256-CBC"&&(p=16);v.enciv=D.enc.Hex.stringify(D.lib.WordArray.random(p))}},encryptPBES2Param:function(v,p){var y=ot.getDKFromPBES2Param(v,p);try{var S=nt.crypto.Cipher.encrypt(v.plain,y,v.encalg,{iv:v.enciv})}catch(p){throw new Error("encrypt error: "+v.plain+" "+y+" "+v.encalg+" "+v.enciv)}v.enc=S},generatePBES2ASN1Param:function(v){var p={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:v.salt}},{int:{hex:inttohex(v.iter)}}]}]},{seq:[{oid:v.encalg},{octstr:{hex:v.enciv}}]}]}]},{octstr:{hex:v.enc}}]};v.prf!="hmacWithSHA1"&&p.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:v.prf},{null:""}]});return p},parseHexOfEncryptedPKCS8:function(v){var p=it;var y=p.getChildIdx;var S=p.getV;var E={};var F=y(v,0);if(F.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+F.length);E.ciphertext=S(v,F[1]);var C=y(v,F[0]);if(C.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+C.length);if(S(v,C[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var B=y(v,C[1]);if(C.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+B.length);var D=y(v,B[1]);if(D.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+D.length);if(S(v,D[0])!="2a864886f70d0307")throw"this only supports TripleDES";E.encryptionSchemeAlg="TripleDES";E.encryptionSchemeIV=S(v,D[1]);var P=y(v,B[0]);if(P.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+P.length);if(S(v,P[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var R=y(v,P[1]);if(R.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+R.length);E.pbkdf2Salt=S(v,R[0]);var T=S(v,R[1]);try{E.pbkdf2Iter=parseInt(T,16)}catch(v){throw new Error("malformed format pbkdf2Iter: "+T)}return E},getPBKDF2KeyHexFromParam:function(v,p){var y=D.enc.Hex.parse(v.pbkdf2Salt);var S=v.pbkdf2Iter;var E=D.PBKDF2(p,y,{keySize:6,iterations:S});var F=D.enc.Hex.stringify(E);return F},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(v,p){var y=pemtohex(v,"ENCRYPTED PRIVATE KEY");var S=this.parseHexOfEncryptedPKCS8(y);var E=ot.getPBKDF2KeyHexFromParam(S,p);var F={};F.ciphertext=D.enc.Hex.parse(S.ciphertext);var C=D.enc.Hex.parse(E);var B=D.enc.Hex.parse(S.encryptionSchemeIV);var P=D.TripleDES.decrypt(F,C,{iv:B});var R=D.enc.Hex.stringify(P);return R},parsePBES2:function(v){var p=it.parse(v);if(aryval(p,"seq.0.seq.0.oid")!="pkcs5PBES2"||aryval(p,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var y=aryval(p,"seq.0.seq.1.seq.0.seq.1.seq");if(y==void 0)throw new Error("PBKDF2 parameter not found");var S=aryval(y,"0.octstr.hex");var E=aryval(y,"1.int.hex");var F=aryval(y,"2.seq.0.oid","hmacWithSHA1");var C=-1;try{C=parseInt(E,16)}catch(v){throw new Error("iter not proper value")}var B=aryval(p,"seq.0.seq.1.seq.1.seq.0.oid");var D=aryval(p,"seq.0.seq.1.seq.1.seq.1.octstr.hex");var P=aryval(p,"seq.1.octstr.hex");if(B==void 0||D==void 0||P==void 0)throw new Error("encalg, enciv or enc is undefined");var R={salt:S,iter:C,prf:F,encalg:B,enciv:D,enc:P};return R},getDKFromPBES2Param:function(v,p){var y={hmacWithSHA1:D.algo.SHA1,hmacWithSHA224:D.algo.SHA224,hmacWithSHA256:D.algo.SHA256,hmacWithSHA384:D.algo.SHA384,hmacWithSHA512:D.algo.SHA512};var S={"des-EDE3-CBC":6,"aes128-CBC":4,"aes256-CBC":8};var E=y[v.prf];if(E==void 0)throw new Error("unsupported prf");var F=S[v.encalg];if(F==void 0)throw new Error("unsupported encalg");var C=D.enc.Hex.parse(v.salt);var B=v.iter;try{var P=D.PBKDF2(p,C,{keySize:F,iterations:B,hasher:E});return D.enc.Hex.stringify(P)}catch(y){throw new Error("PBKDF2 error: "+y+" "+JSON.stringify(v)+" "+p)}},getPlainHexFromEncryptedPKCS8PEM:function(v,p){if(v.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var y=pemtohex(v);var S;try{S=ot.parsePBES2(y)}catch(v){throw new Error("malformed PBES2 format: "+v.message)}var E=ot.getDKFromPBES2Param(S,p);return nt.crypto.Cipher.decrypt(S.enc,E,S.encalg,{iv:S.enciv})},getKeyFromEncryptedPKCS8PEM:function(v,p){var y=this.getPlainHexFromEncryptedPKCS8PEM(v,p);var S=this.getKeyFromPlainPrivatePKCS8Hex(y);return S},parsePlainPrivatePKCS8Hex:function(v){var p=it;var y=p.getChildIdx;var S=p.getV;var E={};E.algparam=null;if(v.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var F=y(v,0);if(F.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(v.substr(F[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var C=y(v,F[1]);if(C.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(v.substr(C[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");E.algoid=S(v,C[0]);v.substr(C[1],2)=="06"&&(E.algparam=S(v,C[1]));if(v.substr(F[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");E.keyidx=p.getVidx(v,F[2]);return E},getKeyFromPlainPrivatePKCS8PEM:function(v){var p=pemtohex(v,"PRIVATE KEY");var y=this.getKeyFromPlainPrivatePKCS8Hex(p);return y},getKeyFromPlainPrivatePKCS8Hex:function(v){var p=this.parsePlainPrivatePKCS8Hex(v);var y;if(p.algoid=="2a864886f70d010101")y=new RSAKey;else if(p.algoid=="2a8648ce380401")y=new nt.crypto.DSA;else{if(p.algoid!="2a8648ce3d0201")throw new Error("unsupported private key algorithm");y=new nt.crypto.ECDSA}y.readPKCS8PrvKeyHex(v);return y},_getKeyFromPublicPKCS8Hex:function(v){var p;var y=it.getVbyList(v,0,[0,0],"06");if(y==="2a864886f70d010101")p=new RSAKey;else if(y==="2a8648ce380401")p=new nt.crypto.DSA;else{if(y!=="2a8648ce3d0201")throw new Error("unsupported PKCS#8 public key hex");p=new nt.crypto.ECDSA}p.readPKCS8PubKeyHex(v);return p},parsePublicRawRSAKeyHex:function(v){var p=it;var y=p.getChildIdx;var S=p.getV;var E={};if(v.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var F=y(v,0);if(F.length!=2)throw new Error("malformed RSA key(code:002)");if(v.substr(F[0],2)!="02")throw new Error("malformed RSA key(code:003)");E.n=S(v,F[0]);if(v.substr(F[1],2)!="02")throw new Error("malformed RSA key(code:004)");E.e=S(v,F[1]);return E},parsePublicPKCS8Hex:function(v){var p=it;var y=p.getChildIdx;var S=p.getV;var E={};E.algparam=null;var F=y(v,0);if(F.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+F.length);var C=F[0];if(v.substr(C,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var B=y(v,C);if(B.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(v.substr(B[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");E.algoid=S(v,B[0]);if(v.substr(B[1],2)=="06")E.algparam=S(v,B[1]);else if(v.substr(B[1],2)=="30"){E.algparam={};E.algparam.p=p.getVbyList(v,B[1],[0],"02");E.algparam.q=p.getVbyList(v,B[1],[1],"02");E.algparam.g=p.getVbyList(v,B[1],[2],"02")}if(v.substr(F[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");E.key=S(v,F[1]).substr(2);return E}}}();ot.getKey=function(v,p,y){var S=it,E=S.getChildIdx,F=(S.getV,S.getVbyList),C=nt.crypto,B=C.ECDSA,D=C.DSA,P=RSAKey,R=pemtohex,T=ot;if(typeof P!="undefined"&&v instanceof P)return v;if(typeof B!="undefined"&&v instanceof B)return v;if(typeof D!="undefined"&&v instanceof D)return v;if(v.curve!==void 0&&v.xy!==void 0&&v.d===void 0)return new B({pub:v.xy,curve:v.curve});if(v.curve!==void 0&&v.d!==void 0)return new B({prv:v.d,curve:v.curve});if(v.kty===void 0&&v.n!==void 0&&v.e!==void 0&&v.d===void 0){var N=new P;N.setPublic(v.n,v.e);return N}if(v.kty===void 0&&v.n!==void 0&&v.e!==void 0&&v.d!==void 0&&v.p!==void 0&&v.q!==void 0&&v.dp!==void 0&&v.dq!==void 0&&v.co!==void 0&&v.qi===void 0){N=new P;N.setPrivateEx(v.n,v.e,v.d,v.p,v.q,v.dp,v.dq,v.co);return N}if(v.kty===void 0&&v.n!==void 0&&v.e!==void 0&&v.d!==void 0&&v.p===void 0){N=new P;N.setPrivate(v.n,v.e,v.d);return N}if(v.p!==void 0&&v.q!==void 0&&v.g!==void 0&&v.y!==void 0&&v.x===void 0){N=new D;N.setPublic(v.p,v.q,v.g,v.y);return N}if(v.p!==void 0&&v.q!==void 0&&v.g!==void 0&&v.y!==void 0&&v.x!==void 0){N=new D;N.setPrivate(v.p,v.q,v.g,v.y,v.x);return N}if(v.kty==="RSA"&&v.n!==void 0&&v.e!==void 0&&v.d===void 0){N=new P;N.setPublic(b64utohex(v.n),b64utohex(v.e));return N}if(v.kty==="RSA"&&v.n!==void 0&&v.e!==void 0&&v.d!==void 0&&v.p!==void 0&&v.q!==void 0&&v.dp!==void 0&&v.dq!==void 0&&v.qi!==void 0){N=new P;N.setPrivateEx(b64utohex(v.n),b64utohex(v.e),b64utohex(v.d),b64utohex(v.p),b64utohex(v.q),b64utohex(v.dp),b64utohex(v.dq),b64utohex(v.qi));return N}if(v.kty==="RSA"&&v.n!==void 0&&v.e!==void 0&&v.d!==void 0){N=new P;N.setPrivate(b64utohex(v.n),b64utohex(v.e),b64utohex(v.d));return N}if(v.kty==="EC"&&v.crv!==void 0&&v.x!==void 0&&v.y!==void 0&&v.d===void 0){var O=new B({curve:v.crv});var V=O.ecparams.keycharlen;var L=("0000000000"+b64utohex(v.x)).slice(-V);var M=("0000000000"+b64utohex(v.y)).slice(-V);var _="04"+L+M;O.setPublicKeyHex(_);return O}if(v.kty==="EC"&&v.crv!==void 0&&v.x!==void 0&&v.y!==void 0&&v.d!==void 0){O=new B({curve:v.crv});V=O.ecparams.keycharlen;L=("0000000000"+b64utohex(v.x)).slice(-V);M=("0000000000"+b64utohex(v.y)).slice(-V);_="04"+L+M;var U=("0000000000"+b64utohex(v.d)).slice(-V);O.setPublicKeyHex(_);O.setPrivateKeyHex(U);return O}if(y==="pkcs5prv"){var G,X=v;S=it;G=E(X,0);if(G.length===9){N=new P;N.readPKCS5PrvKeyHex(X)}else if(G.length===6){N=new D;N.readPKCS5PrvKeyHex(X)}else{if(!(G.length>2&&X.substr(G[1],2)==="04"))throw new Error("unsupported PKCS#1/5 hexadecimal key");N=new B;N.readPKCS5PrvKeyHex(X)}return N}if(y==="pkcs8prv"){N=T.getKeyFromPlainPrivatePKCS8Hex(v);return N}if(y==="pkcs8pub")return T._getKeyFromPublicPKCS8Hex(v);if(y==="x509pub")return X509.getPublicKeyFromCertHex(v);if(v.indexOf("-END CERTIFICATE-",0)!=-1||v.indexOf("-END X509 CERTIFICATE-",0)!=-1||v.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return X509.getPublicKeyFromCertPEM(v);if(v.indexOf("-END PUBLIC KEY-")!=-1){var W=pemtohex(v,"PUBLIC KEY");return T._getKeyFromPublicPKCS8Hex(W)}if(v.indexOf("-END RSA PRIVATE KEY-")!=-1&&v.indexOf("4,ENCRYPTED")==-1){var J=R(v,"RSA PRIVATE KEY");return T.getKey(J,null,"pkcs5prv")}if(v.indexOf("-END DSA PRIVATE KEY-")!=-1&&v.indexOf("4,ENCRYPTED")==-1){var $=R(v,"DSA PRIVATE KEY");var Y=F($,0,[1],"02");var Z=F($,0,[2],"02");var Q=F($,0,[3],"02");var tt=F($,0,[4],"02");var et=F($,0,[5],"02");N=new D;N.setPrivate(new BigInteger(Y,16),new BigInteger(Z,16),new BigInteger(Q,16),new BigInteger(tt,16),new BigInteger(et,16));return N}if(v.indexOf("-END EC PRIVATE KEY-")!=-1&&v.indexOf("4,ENCRYPTED")==-1){J=R(v,"EC PRIVATE KEY");return T.getKey(J,null,"pkcs5prv")}if(v.indexOf("-END PRIVATE KEY-")!=-1)return T.getKeyFromPlainPrivatePKCS8PEM(v);if(v.indexOf("-END RSA PRIVATE KEY-")!=-1&&v.indexOf("4,ENCRYPTED")!=-1){var rt=T.getDecryptedKeyHex(v,p);var st=new RSAKey;st.readPKCS5PrvKeyHex(rt);return st}if(v.indexOf("-END EC PRIVATE KEY-")!=-1&&v.indexOf("4,ENCRYPTED")!=-1){$=T.getDecryptedKeyHex(v,p);N=F($,0,[1],"04");var at=F($,0,[2,0],"06");var ht=F($,0,[3,0],"03").substr(2);var ut="";if(nt.crypto.OID.oidhex2name[at]===void 0)throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+at);ut=nt.crypto.OID.oidhex2name[at];O=new B({curve:ut});O.setPublicKeyHex(ht);O.setPrivateKeyHex(N);O.isPublic=false;return O}if(v.indexOf("-END DSA PRIVATE KEY-")!=-1&&v.indexOf("4,ENCRYPTED")!=-1){$=T.getDecryptedKeyHex(v,p);Y=F($,0,[1],"02");Z=F($,0,[2],"02");Q=F($,0,[3],"02");tt=F($,0,[4],"02");et=F($,0,[5],"02");N=new D;N.setPrivate(new BigInteger(Y,16),new BigInteger(Z,16),new BigInteger(Q,16),new BigInteger(tt,16),new BigInteger(et,16));return N}if(v.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return T.getKeyFromEncryptedPKCS8PEM(v,p);throw new Error("not supported argument")};ot.generateKeypair=function(v,p){if(v=="RSA"){var y=p;var S=new RSAKey;S.generate(y,"10001");S.isPrivate=true;S.isPublic=true;var E=new RSAKey;var F=S.n.toString(16);var C=S.e.toString(16);E.setPublic(F,C);E.isPrivate=false;E.isPublic=true;var B={};B.prvKeyObj=S;B.pubKeyObj=E;return B}if(v=="EC"){var D=p;var P=new nt.crypto.ECDSA({curve:D});var R=P.generateKeyPairHex();S=new nt.crypto.ECDSA({curve:D});S.setPublicKeyHex(R.ecpubhex);S.setPrivateKeyHex(R.ecprvhex);S.isPrivate=true;S.isPublic=false;E=new nt.crypto.ECDSA({curve:D});E.setPublicKeyHex(R.ecpubhex);E.isPrivate=false;E.isPublic=true;B={};B.prvKeyObj=S;B.pubKeyObj=E;return B}throw new Error("unknown algorithm: "+v)};ot.getPEM=function(v,p,y,S,E,F){var C=nt,B=C.asn1,D=B.DERObjectIdentifier,P=B.DERInteger,R=B.ASN1Util.newObject,T=B.x509,N=T.SubjectPublicKeyInfo,O=C.crypto,V=O.DSA,L=O.ECDSA,M=RSAKey;function z(v){var p=R({seq:[{int:0},{int:{bigint:v.n}},{int:v.e},{int:{bigint:v.d}},{int:{bigint:v.p}},{int:{bigint:v.q}},{int:{bigint:v.dmp1}},{int:{bigint:v.dmq1}},{int:{bigint:v.coeff}}]});return p}function A(v){var p=R({seq:[{int:1},{octstr:{hex:v.prvKeyHex}},{tag:["a0",true,{oid:{name:v.curveName}}]},{tag:["a1",true,{bitstr:{hex:"00"+v.pubKeyHex}}]}]});return p}function w(v){var p=R({seq:[{int:0},{int:{bigint:v.p}},{int:{bigint:v.q}},{int:{bigint:v.g}},{int:{bigint:v.y}},{int:{bigint:v.x}}]});return p}if((M!==void 0&&v instanceof M||V!==void 0&&v instanceof V||L!==void 0&&v instanceof L)&&v.isPublic==true&&(p===void 0||p=="PKCS8PUB")){var _=new N(v);var U=_.tohex();return hextopem(U,"PUBLIC KEY")}if(p=="PKCS1PRV"&&M!==void 0&&v instanceof M&&(y===void 0||y==null)&&v.isPrivate==true){_=z(v);U=_.tohex();return hextopem(U,"RSA PRIVATE KEY")}if(p=="PKCS1PRV"&&L!==void 0&&v instanceof L&&(y===void 0||y==null)&&v.isPrivate==true){var G=new D({name:v.curveName});var X=G.tohex();var W=A(v);var J=W.tohex();var $="";$+=hextopem(X,"EC PARAMETERS");$+=hextopem(J,"EC PRIVATE KEY");return $}if(p=="PKCS1PRV"&&V!==void 0&&v instanceof V&&(y===void 0||y==null)&&v.isPrivate==true){_=w(v);U=_.tohex();return hextopem(U,"DSA PRIVATE KEY")}if(p=="PKCS5PRV"&&M!==void 0&&v instanceof M&&y!==void 0&&y!=null&&v.isPrivate==true){_=z(v);U=_.tohex();S===void 0&&(S="DES-EDE3-CBC");return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",U,y,S,F)}if(p=="PKCS5PRV"&&L!==void 0&&v instanceof L&&y!==void 0&&y!=null&&v.isPrivate==true){_=A(v);U=_.tohex();S===void 0&&(S="DES-EDE3-CBC");return this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",U,y,S,F)}if(p=="PKCS5PRV"&&V!==void 0&&v instanceof V&&y!==void 0&&y!=null&&v.isPrivate==true){_=w(v);U=_.tohex();S===void 0&&(S="DES-EDE3-CBC");return this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",U,y,S,F)}var f=function(v,p){if(typeof p=="string")return ot.getEncryptedPKCS8PEM(v,p);if(typeof p=="object"&&aryval(p,"passcode")!=void 0){var y=JSON.parse(JSON.stringify(p));var S=y.passcode;delete y.passcode;return ot.getEncryptedPKCS8PEM(v,S,y)}};if(p=="PKCS8PRV"&&M!=void 0&&v instanceof M&&v.isPrivate==true){var Y=z(v);var Z=Y.tohex();_=R({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:true}]},{octstr:{hex:Z}}]});U=_.tohex();return y===void 0||y==null?hextopem(U,"PRIVATE KEY"):f(U,y)}if(p=="PKCS8PRV"&&L!==void 0&&v instanceof L&&v.isPrivate==true){var Q={seq:[{int:1},{octstr:{hex:v.prvKeyHex}}]};typeof v.pubKeyHex=="string"&&Q.seq.push({tag:["a1",true,{bitstr:{hex:"00"+v.pubKeyHex}}]});Y=new R(Q);Z=Y.tohex();_=R({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:v.curveName}}]},{octstr:{hex:Z}}]});U=_.tohex();return y===void 0||y==null?hextopem(U,"PRIVATE KEY"):f(U,y)}if(p=="PKCS8PRV"&&V!==void 0&&v instanceof V&&v.isPrivate==true){Y=new P({bigint:v.x});Z=Y.tohex();_=R({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:v.p}},{int:{bigint:v.q}},{int:{bigint:v.g}}]}]},{octstr:{hex:Z}}]});U=_.tohex();return y===void 0||y==null?hextopem(U,"PRIVATE KEY"):f(U,y)}throw new Error("unsupported object nor format")};ot.getKeyFromCSRPEM=function(v){var p=pemtohex(v,"CERTIFICATE REQUEST");var y=ot.getKeyFromCSRHex(p);return y};ot.getKeyFromCSRHex=function(v){var p=ot.parseCSRHex(v);var y=ot.getKey(p.p8pubkeyhex,null,"pkcs8pub");return y};ot.parseCSRHex=function(v){var p=it;var y=p.getChildIdx;var S=p.getTLV;var E={};var F=v;if(F.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var C=y(F,0);if(C.length<1)throw new Error("malformed CSR(code:002)");if(F.substr(C[0],2)!="30")throw new Error("malformed CSR(code:003)");var B=y(F,C[0]);if(B.length<3)throw new Error("malformed CSR(code:004)");E.p8pubkeyhex=S(F,B[2]);return E};ot.getKeyID=function(v){var p=ot;var y=it;typeof v==="string"&&v.indexOf("BEGIN ")!=-1&&(v=p.getKey(v));var S=pemtohex(p.getPEM(v));var E=y.getIdxbyList(S,0,[1]);var F=y.getV(S,E).substring(2);return nt.crypto.Util.hashHex(F,"sha1")};ot.getJWK=function(v,p,y,S,E){var F;var C={};var B;var D=nt.crypto.Util.hashHex;if(typeof v=="string"){F=ot.getKey(v);v.indexOf("CERTIFICATE")!=-1&&(B=pemtohex(v))}else{if(typeof v!="object")throw new Error("unsupported keyinfo type");if(v instanceof X509){F=v.getPublicKey();B=v.hex}else F=v}if(F instanceof RSAKey&&F.isPrivate){C.kty="RSA";C.n=hextob64u(F.n.toString(16));C.e=hextob64u(F.e.toString(16));C.d=hextob64u(F.d.toString(16));C.p=hextob64u(F.p.toString(16));C.q=hextob64u(F.q.toString(16));C.dp=hextob64u(F.dmp1.toString(16));C.dq=hextob64u(F.dmq1.toString(16));C.qi=hextob64u(F.coeff.toString(16))}else if(F instanceof RSAKey&&F.isPublic){C.kty="RSA";C.n=hextob64u(F.n.toString(16));C.e=hextob64u(F.e.toString(16))}else if(F instanceof nt.crypto.ECDSA&&F.isPrivate){var P=F.getShortNISTPCurveName();if(P!=="P-256"&&P!=="P-384"&&P!=="P-521")throw new Error("unsupported curve name for JWT: "+P);var R=F.getPublicKeyXYHex();C.kty="EC";C.crv=P;C.x=hextob64u(R.x);C.y=hextob64u(R.y);C.d=hextob64u(F.prvKeyHex)}else if(F instanceof nt.crypto.ECDSA&&F.isPublic){P=F.getShortNISTPCurveName();if(P!=="P-256"&&P!=="P-384"&&P!=="P-521")throw new Error("unsupported curve name for JWT: "+P);R=F.getPublicKeyXYHex();C.kty="EC";C.crv=P;C.x=hextob64u(R.x);C.y=hextob64u(R.y)}if(C.kty==void 0)throw new Error("unsupported keyinfo");F.isPrivate||p==true||(C.kid=nt.jws.JWS.getJWKthumbprint(C));B!=void 0&&y!=true&&(C.x5c=[hex2b64(B)]);B!=void 0&&S!=true&&(C.x5t=b64tob64u(hex2b64(D(B,"sha1"))));B!=void 0&&E!=true&&(C["x5t#S256"]=b64tob64u(hex2b64(D(B,"sha256"))));return C};ot.getJWKFromKey=function(v){return ot.getJWK(v,true,true,true,true)};RSAKey.getPosArrayOfChildrenFromHex=function(v){return it.getChildIdx(v,0)};RSAKey.getHexValueArrayOfChildrenFromHex=function(v){var p=it;var y=p.getV;var S=RSAKey.getPosArrayOfChildrenFromHex(v);var E=y(v,S[0]);var F=y(v,S[1]);var C=y(v,S[2]);var B=y(v,S[3]);var D=y(v,S[4]);var P=y(v,S[5]);var R=y(v,S[6]);var T=y(v,S[7]);var N=y(v,S[8]);S=new Array;S.push(E,F,C,B,D,P,R,T,N);return S};RSAKey.prototype.readPrivateKeyFromPEMString=function(v){var p=pemtohex(v);var y=RSAKey.getHexValueArrayOfChildrenFromHex(p);this.setPrivateEx(y[1],y[2],y[3],y[4],y[5],y[6],y[7],y[8])};RSAKey.prototype.readPKCS5PrvKeyHex=function(v){var p=RSAKey.getHexValueArrayOfChildrenFromHex(v);this.setPrivateEx(p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8])};RSAKey.prototype.readPKCS8PrvKeyHex=function(v){var p,y,S,E,F,C,B,D;var P=it;var R=P.getVbyListEx;if(P.isASN1HEX(v)===false)throw new Error("not ASN.1 hex string");try{p=R(v,0,[2,0,1],"02");y=R(v,0,[2,0,2],"02");S=R(v,0,[2,0,3],"02");E=R(v,0,[2,0,4],"02");F=R(v,0,[2,0,5],"02");C=R(v,0,[2,0,6],"02");B=R(v,0,[2,0,7],"02");D=R(v,0,[2,0,8],"02")}catch(v){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(p,y,S,E,F,C,B,D)};RSAKey.prototype.readPKCS5PubKeyHex=function(v){var p=it;var y=p.getV;if(p.isASN1HEX(v)===false)throw new Error("keyHex is not ASN.1 hex string");var S=p.getChildIdx(v,0);if(S.length!==2||v.substr(S[0],2)!=="02"||v.substr(S[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var E=y(v,S[0]);var F=y(v,S[1]);this.setPublic(E,F)};RSAKey.prototype.readPKCS8PubKeyHex=function(v){var p=it;if(p.isASN1HEX(v)===false)throw new Error("not ASN.1 hex string");if(p.getTLVbyListEx(v,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var y=p.getTLVbyListEx(v,0,[1,0]);this.readPKCS5PubKeyHex(y)};RSAKey.prototype.readCertPubKeyHex=function(v,p){var y,S;y=new X509;y.readCertHex(v);S=y.getPublicKeyHex();this.readPKCS8PubKeyHex(S)};new RegExp("[^0-9a-f]","gi");function _zeroPaddingOfSignature(v,p){var y="";var S=p/4-v.length;for(var E=0;E<S;E++)y+="0";return y+v}RSAKey.prototype.sign=function(v,p){var b=function(v){return nt.crypto.Util.hashString(v,p)};var y=b(v);return this.signWithMessageHash(y,p)};RSAKey.prototype.signWithMessageHash=function(v,y){var S=nt.crypto.Util.getPaddedDigestInfoHex(v,y,(this||p).n.bitLength());var E=parseBigInt(S,16);var F=this.doPrivate(E);var C=F.toString(16);return _zeroPaddingOfSignature(C,(this||p).n.bitLength())};function pss_mgf1_str(v,p,y){var S="",E=0;while(S.length<p){S+=hextorstr(y(rstrtohex(v+String.fromCharCode.apply(String,[(E&4278190080)>>24,(E&16711680)>>16,(E&65280)>>8,E&255]))));E+=1}return S}RSAKey.prototype.signPSS=function(v,p,y){var c=function(v){return nt.crypto.Util.hashHex(v,p)};var S=c(rstrtohex(v));y===void 0&&(y=-1);return this.signWithMessageHashPSS(S,p,y)};RSAKey.prototype.signWithMessageHashPSS=function(v,y,S){var E=hextorstr(v);var F=E.length;var C=(this||p).n.bitLength()-1;var B=Math.ceil(C/8);var D;var o=function(v){return nt.crypto.Util.hashHex(v,y)};if(S===-1||S===void 0)S=F;else if(S===-2)S=B-F-2;else if(S<-2)throw new Error("invalid salt length");if(B<F+S+2)throw new Error("data too long");var P="";if(S>0){P=new Array(S);(new SecureRandom).nextBytes(P);P=String.fromCharCode.apply(String,P)}var R=hextorstr(o(rstrtohex("\0\0\0\0\0\0\0\0"+E+P)));var T=[];for(D=0;D<B-S-F-2;D+=1)T[D]=0;var N=String.fromCharCode.apply(String,T)+""+P;var O=pss_mgf1_str(R,N.length,o);var V=[];for(D=0;D<N.length;D+=1)V[D]=N.charCodeAt(D)^O.charCodeAt(D);var L=65280>>8*B-C&255;V[0]&=~L;for(D=0;D<F;D++)V.push(R.charCodeAt(D));V.push(188);return _zeroPaddingOfSignature(this.doPrivate(new BigInteger(V)).toString(16),(this||p).n.bitLength())};function _rsasign_getAlgNameAndHashFromHexDisgestInfo(v){for(var p in nt.crypto.Util.DIGESTINFOHEAD){var y=nt.crypto.Util.DIGESTINFOHEAD[p];var S=y.length;if(v.substring(0,S)==y){var E=[p,v.substring(S)];return E}}return[]}RSAKey.prototype.verify=function(v,y){y=y.toLowerCase();if(y.match(/^[0-9a-f]+$/)==null)return false;var S=parseBigInt(y,16);var E=(this||p).n.bitLength();if(S.bitLength()>E)return false;var F=this.doPublic(S);var C=F.toString(16);if(C.length+3!=E/4)return false;var B=C.replace(/^1f+00/,"");var D=_rsasign_getAlgNameAndHashFromHexDisgestInfo(B);if(D.length==0)return false;var P=D[0];var R=D[1];var a=function(v){return nt.crypto.Util.hashString(v,P)};var T=a(v);return R==T};RSAKey.prototype.verifyWithMessageHash=function(v,y){if(y.length!=Math.ceil((this||p).n.bitLength()/4))return false;var S=parseBigInt(y,16);if(S.bitLength()>(this||p).n.bitLength())return 0;var E=this.doPublic(S);var F=E.toString(16).replace(/^1f+00/,"");var C=_rsasign_getAlgNameAndHashFromHexDisgestInfo(F);if(C.length==0)return false;C[0];var B=C[1];return B==v};RSAKey.prototype.verifyPSS=function(v,p,y,S){var e=function(v){return nt.crypto.Util.hashHex(v,y)};var E=e(rstrtohex(v));S===void 0&&(S=-1);return this.verifyWithMessageHashPSS(E,p,y,S)};RSAKey.prototype.verifyWithMessageHashPSS=function(v,y,S,E){if(y.length!=Math.ceil((this||p).n.bitLength()/4))return false;var F=new BigInteger(y,16);var r=function(v){return nt.crypto.Util.hashHex(v,S)};var C=hextorstr(v);var B=C.length;var D=(this||p).n.bitLength()-1;var P=Math.ceil(D/8);var R;if(E===-1||E===void 0)E=B;else if(E===-2)E=P-B-2;else if(E<-2)throw new Error("invalid salt length");if(P<B+E+2)throw new Error("data too long");var T=this.doPublic(F).toByteArray();for(R=0;R<T.length;R+=1)T[R]&=255;while(T.length<P)T.unshift(0);if(T[P-1]!==188)throw new Error("encoded message does not end in 0xbc");T=String.fromCharCode.apply(String,T);var N=T.substr(0,P-B-1);var O=T.substr(N.length,B);var V=65280>>8*P-D&255;if((N.charCodeAt(0)&V)!==0)throw new Error("bits beyond keysize not zero");var L=pss_mgf1_str(O,N.length,r);var M=[];for(R=0;R<N.length;R+=1)M[R]=N.charCodeAt(R)^L.charCodeAt(R);M[0]&=~V;var _=P-B-E-2;for(R=0;R<_;R+=1)if(M[R]!==0)throw new Error("leftmost octets not zero");if(M[_]!==1)throw new Error("0x01 marker not found");return O===hextorstr(r(rstrtohex("\0\0\0\0\0\0\0\0"+C+String.fromCharCode.apply(String,M.slice(-E)))))};RSAKey.SALT_LEN_HLEN=-1;RSAKey.SALT_LEN_MAX=-2;RSAKey.SALT_LEN_RECOVER=-2;function X509(v){var y,S=it,E=S.getChildIdx,F=S.getV,C=(S.dump,S.parse),B=S.getTLV,D=S.getVbyList,P=S.getVbyListEx,R=S.getTLVbyList,T=S.getTLVbyListEx,N=S.getIdxbyList,O=S.getIdxbyListEx,V=S.getVidx,L=S.getInt,M=S.oidname,_=S.hextooidstr,U=pemtohex,G=Error;try{y=nt.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(v){}(this||p).HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"};(this||p).hex=null;(this||p).version=0;(this||p).foffset=0;(this||p).aExtInfo=null;(this||p).getVersion=function(){if((this||p).hex===null||(this||p).version!==0)return(this||p).version;var v=R((this||p).hex,0,[0,0]);if(v.substr(0,2)=="a0"){var y=R(v,0,[0]);var S=L(y,0);if(S<0||2<S)throw new Error("malformed version field");(this||p).version=S+1;return(this||p).version}(this||p).version=1;(this||p).foffset=-1;return 1};(this||p).getSerialNumberHex=function(){return P((this||p).hex,0,[0,0],"02")};(this||p).getSignatureAlgorithmField=function(){var v=T((this||p).hex,0,[0,1]);return this.getAlgorithmIdentifierName(v)};(this||p).getAlgorithmIdentifierName=function(v){for(var p in y)if(v===y[p])return p;return M(P(v,0,[0],"06"))};(this||p).getIssuer=function(v,p){return this.getX500Name(this.getIssuerHex(),v,p)};(this||p).getIssuerHex=function(){return R((this||p).hex,0,[0,3+(this||p).foffset],"30")};(this||p).getIssuerString=function(){var v=this.getIssuer();return v.str};(this||p).getSubject=function(v,p){return this.getX500Name(this.getSubjectHex(),v,p)};(this||p).getSubjectHex=function(){return R((this||p).hex,0,[0,5+(this||p).foffset],"30")};(this||p).getSubjectString=function(){var v=this.getSubject();return v.str};(this||p).getNotBefore=function(){var v=D((this||p).hex,0,[0,4+(this||p).foffset,0]);v=v.replace(/(..)/g,"%$1");v=decodeURIComponent(v);return v};(this||p).getNotAfter=function(){var v=D((this||p).hex,0,[0,4+(this||p).foffset,1]);v=v.replace(/(..)/g,"%$1");v=decodeURIComponent(v);return v};(this||p).getPublicKeyHex=function(){return this.getSPKI()};(this||p).getSPKI=function(){return R((this||p).hex,0,[0,6+(this||p).foffset],"30")};(this||p).getSPKIValue=function(){var v=this.getSPKI();return v==null?null:D(v,0,[1],"03",true)};(this||p).getPublicKeyIdx=function(){return N((this||p).hex,0,[0,6+(this||p).foffset],"30")};(this||p).getPublicKeyContentIdx=function(){var v=this.getPublicKeyIdx();return N((this||p).hex,v,[1,0],"30")};(this||p).getPublicKey=function(){return ot.getKey(this.getPublicKeyHex(),null,"pkcs8pub")};(this||p).getSignatureAlgorithmName=function(){var v=R((this||p).hex,0,[1],"30");return this.getAlgorithmIdentifierName(v)};(this||p).getSignatureValueHex=function(){return D((this||p).hex,0,[2],"03",true)};(this||p).verifySignature=function(v){var y=this.getSignatureAlgorithmField();var S=this.getSignatureValueHex();var E=R((this||p).hex,0,[0],"30");var F=new nt.crypto.Signature({alg:y});F.init(v);F.updateHex(E);return F.verify(S)};(this||p).parseExt=function(v){var y,C,B;if(v===void 0){B=(this||p).hex;if((this||p).version!==3)return-1;y=N(B,0,[0,7,0],"30");C=E(B,y)}else{B=pemtohex(v);var P=N(B,0,[0,3,0,0],"06");if(F(B,P)!="2a864886f70d01090e"){(this||p).aExtInfo=new Array;return}y=N(B,0,[0,3,0,1,0],"30");C=E(B,y);(this||p).hex=B}(this||p).aExtInfo=new Array;for(var R=0;R<C.length;R++){var T={};T.critical=false;var O=E(B,C[R]);var L=0;if(O.length===3){T.critical=true;L=1}T.oid=S.hextooidstr(D(B,C[R],[0],"06"));var M=N(B,C[R],[1+L]);T.vidx=V(B,M);(this||p).aExtInfo.push(T)}};(this||p).getExtInfo=function(v){var y=(this||p).aExtInfo;var S=v;v.match(/^[0-9.]+$/)||(S=nt.asn1.x509.OID.name2oid(v));if(S!=="")for(var E=0;E<y.length;E++)if(y[E].oid===S)return y[E]};(this||p).getCriticalExtV=function(v,y,S){if(y!=void 0)return[y,S];var E=this.getExtInfo(v);return E==void 0?[null,null]:[B((this||p).hex,E.vidx),E.critical]};(this||p).getExtBasicConstraints=function(v,y){if(v===void 0&&y===void 0){var S=this.getExtInfo("basicConstraints");if(S===void 0)return;v=B((this||p).hex,S.vidx);y=S.critical}var E={extname:"basicConstraints"};y&&(E.critical=true);if(v==="3000")return E;if(v==="30030101ff"){E.cA=true;return E}if(v.substr(0,12)==="30060101ff02"){var C=F(v,10);var D=parseInt(C,16);E.cA=true;E.pathLen=D;return E}throw new Error("hExtV parse error: "+v)};(this||p).getExtNameConstraints=function(v,p){var y=this.getCriticalExtV("nameConstraints",v,p);v=y[0];p=y[1];if(v!=null){var S={extname:"nameConstraints"};p&&(S.critical=true);var F=E(v,0);for(var C=0;C<F.length;C++){var D=[];var P=E(v,F[C]);for(var R=0;R<P.length;R++){var T=B(v,P[R]);var N=this.getGeneralSubtree(T);D.push(N)}var O=v.substr(F[C],2);O=="a0"?S.permit=D:O=="a1"&&(S.exclude=D)}return S}};(this||p).getGeneralSubtree=function(v){var p=E(v,0);var y=p.length;if(y<1||2<y)throw new Error("wrong num elements");var S=this.getGeneralName(B(v,p[0]));for(var C=1;C<y;C++){var D=v.substr(p[C],2);var P=F(v,p[C]);var R=parseInt(P,16);D=="80"&&(S.min=R);D=="81"&&(S.max=R)}return S};(this||p).getExtKeyUsage=function(v,p){var y=this.getCriticalExtV("keyUsage",v,p);v=y[0];p=y[1];if(v!=null){var S={extname:"keyUsage"};p&&(S.critical=true);S.names=this.getExtKeyUsageString(v).split(",");return S}};(this||p).getExtKeyUsageBin=function(v){if(v===void 0){var y=this.getExtInfo("keyUsage");if(y===void 0)return"";v=B((this||p).hex,y.vidx)}if(v.length!=8&&v.length!=10)throw new Error("malformed key usage value: "+v);var S="000000000000000"+parseInt(v.substr(6),16).toString(2);v.length==8&&(S=S.slice(-8));v.length==10&&(S=S.slice(-16));S=S.replace(/0+$/,"");S==""&&(S="0");return S};(this||p).getExtKeyUsageString=function(v){var p=this.getExtKeyUsageBin(v);var y=new Array;for(var S=0;S<p.length;S++)p.substr(S,1)=="1"&&y.push(X509.KEYUSAGE_NAME[S]);return y.join(",")};(this||p).getExtSubjectKeyIdentifier=function(v,y){if(v===void 0&&y===void 0){var S=this.getExtInfo("subjectKeyIdentifier");if(S===void 0)return;v=B((this||p).hex,S.vidx);y=S.critical}var E={extname:"subjectKeyIdentifier"};y&&(E.critical=true);var C=F(v,0);E.kid={hex:C};return E};(this||p).getExtAuthorityKeyIdentifier=function(v,y){if(v===void 0&&y===void 0){var S=this.getExtInfo("authorityKeyIdentifier");if(S===void 0)return;v=B((this||p).hex,S.vidx);y=S.critical}var C={extname:"authorityKeyIdentifier"};y&&(C.critical=true);var D=E(v,0);for(var P=0;P<D.length;P++){var R=v.substr(D[P],2);R==="80"&&(C.kid={hex:F(v,D[P])});if(R==="a1"){var T=B(v,D[P]);var N=this.getGeneralNames(T);C.issuer=N[0].dn}R==="82"&&(C.sn={hex:F(v,D[P])})}return C};(this||p).getExtExtKeyUsage=function(v,y){if(v===void 0&&y===void 0){var S=this.getExtInfo("extKeyUsage");if(S===void 0)return;v=B((this||p).hex,S.vidx);y=S.critical}var C={extname:"extKeyUsage",array:[]};y&&(C.critical=true);var D=E(v,0);for(var P=0;P<D.length;P++)C.array.push(M(F(v,D[P])));return C};(this||p).getExtExtKeyUsageName=function(){var v=this.getExtInfo("extKeyUsage");if(v===void 0)return v;var y=new Array;var S=B((this||p).hex,v.vidx);if(S==="")return y;var C=E(S,0);for(var D=0;D<C.length;D++)y.push(M(F(S,C[D])));return y};(this||p).getExtSubjectAltName=function(v,y){if(v===void 0&&y===void 0){var S=this.getExtInfo("subjectAltName");if(S===void 0)return;v=B((this||p).hex,S.vidx);y=S.critical}var E={extname:"subjectAltName",array:[]};y&&(E.critical=true);E.array=this.getGeneralNames(v);return E};(this||p).getExtIssuerAltName=function(v,y){if(v===void 0&&y===void 0){var S=this.getExtInfo("issuerAltName");if(S===void 0)return;v=B((this||p).hex,S.vidx);y=S.critical}var E={extname:"issuerAltName",array:[]};y&&(E.critical=true);E.array=this.getGeneralNames(v);return E};(this||p).getGeneralNames=function(v){var p=E(v,0);var y=[];for(var S=0;S<p.length;S++){var F=this.getGeneralName(B(v,p[S]));F!==void 0&&y.push(F)}return y};(this||p).getGeneralName=function(v){var p=v.substr(0,2);var y=F(v,0);var S=hextorstr(y);return p=="81"?{rfc822:S}:p=="82"?{dns:S}:p=="86"?{uri:S}:p=="87"?{ip:hextoip(y)}:p=="a4"?{dn:this.getX500Name(y)}:p=="a0"?{other:this.getOtherName(v)}:void 0};(this||p).getExtSubjectAltName2=function(){var v,y,S;var C=this.getExtInfo("subjectAltName");if(C===void 0)return C;var D=new Array;var P=B((this||p).hex,C.vidx);var R=E(P,0);for(var T=0;T<R.length;T++){S=P.substr(R[T],2);v=F(P,R[T]);if(S==="81"){y=hextoutf8(v);D.push(["MAIL",y])}if(S==="82"){y=hextoutf8(v);D.push(["DNS",y])}if(S==="84"){y=X509.hex2dn(v,0);D.push(["DN",y])}if(S==="86"){y=hextoutf8(v);D.push(["URI",y])}if(S==="87"){y=hextoip(v);D.push(["IP",y])}}return D};(this||p).getExtCRLDistributionPoints=function(v,y){if(v===void 0&&y===void 0){var S=this.getExtInfo("cRLDistributionPoints");if(S===void 0)return;v=B((this||p).hex,S.vidx);y=S.critical}var F={extname:"cRLDistributionPoints",array:[]};y&&(F.critical=true);var C=E(v,0);for(var D=0;D<C.length;D++){var P=B(v,C[D]);F.array.push(this.getDistributionPoint(P))}return F};(this||p).getDistributionPoint=function(v){var p={};var y=E(v,0);for(var S=0;S<y.length;S++){var F=v.substr(y[S],2);var C=B(v,y[S]);F=="a0"&&(p.dpname=this.getDistributionPointName(C))}return p};(this||p).getDistributionPointName=function(v){var p={};var y=E(v,0);for(var S=0;S<y.length;S++){var F=v.substr(y[S],2);var C=B(v,y[S]);F=="a0"&&(p.full=this.getGeneralNames(C))}return p};(this||p).getExtCRLDistributionPointsURI=function(){var v=this.getExtCRLDistributionPoints();if(v==void 0)return v;var p=v.array;var y=[];for(var S=0;S<p.length;S++)try{p[S].dpname.full[0].uri!=void 0&&y.push(p[S].dpname.full[0].uri)}catch(v){}return y};(this||p).getExtAIAInfo=function(){var v=this.getExtInfo("authorityInfoAccess");if(v===void 0)return v;var y={ocsp:[],caissuer:[]};var S=E((this||p).hex,v.vidx);for(var F=0;F<S.length;F++){var C=D((this||p).hex,S[F],[0],"06");var B=D((this||p).hex,S[F],[1],"86");C==="2b06010505073001"&&y.ocsp.push(hextoutf8(B));C==="2b06010505073002"&&y.caissuer.push(hextoutf8(B))}return y};(this||p).getExtAuthorityInfoAccess=function(v,y){if(v===void 0&&y===void 0){var S=this.getExtInfo("authorityInfoAccess");if(S===void 0)return;v=B((this||p).hex,S.vidx);y=S.critical}var F={extname:"authorityInfoAccess",array:[]};y&&(F.critical=true);var C=E(v,0);for(var R=0;R<C.length;R++){var T=P(v,C[R],[0],"06");var N=D(v,C[R],[1],"86");var O=hextoutf8(N);if(T=="2b06010505073001")F.array.push({ocsp:O});else{if(T!="2b06010505073002")throw new Error("unknown method: "+T);F.array.push({caissuer:O})}}return F};(this||p).getExtCertificatePolicies=function(v,y){if(v===void 0&&y===void 0){var S=this.getExtInfo("certificatePolicies");if(S===void 0)return;v=B((this||p).hex,S.vidx);y=S.critical}var F={extname:"certificatePolicies",array:[]};y&&(F.critical=true);var C=E(v,0);for(var D=0;D<C.length;D++){var P=B(v,C[D]);var R=this.getPolicyInformation(P);F.array.push(R)}return F};(this||p).getPolicyInformation=function(v){var p={};var y=D(v,0,[0],"06");p.policyoid=M(y);var S=O(v,0,[1],"30");if(S!=-1){p.array=[];var F=E(v,S);for(var C=0;C<F.length;C++){var P=B(v,F[C]);var R=this.getPolicyQualifierInfo(P);p.array.push(R)}}return p};(this||p).getOtherName=function(v){var p={};var y=E(v,0);var S=D(v,y[0],[],"06");var F=D(v,y[1],[]);p.oid=M(S);p.value=C(F);return p};(this||p).getPolicyQualifierInfo=function(v){var p={};var y=D(v,0,[0],"06");if(y==="2b06010505070201"){var S=P(v,0,[1],"16");p.cps=hextorstr(S)}else if(y==="2b06010505070202"){var E=R(v,0,[1],"30");p.unotice=this.getUserNotice(E)}return p};(this||p).getUserNotice=function(v){var p=null;try{p=S.parse(v);var y=this._asn1ToUnotice(p);return y}catch(v){return}};(this||p)._asn1ToUnotice=function(v){try{var p={};var y=aryval(v,"seq");for(var S=0;S<y.length;S++){var E=this._asn1ToNoticeRef(y[S]);E!=void 0&&(p.noticeref=E);var F=this.asn1ToDisplayText(y[S]);F!=void 0&&(p.exptext=F)}return Object.keys(p).length>0?p:void 0}catch(v){return}};(this||p)._asn1ToNoticeRef=function(v){try{var p={};var y=aryval(v,"seq");for(var S=0;S<y.length;S++){var E=this._asn1ToNoticeNum(y[S]);E!=void 0&&(p.noticenum=E);var F=this.asn1ToDisplayText(y[S]);F!=void 0&&(p.org=F)}return Object.keys(p).length>0?p:void 0}catch(v){return}};(this||p)._asn1ToNoticeNum=function(v){try{var p=aryval(v,"seq");var y=[];for(var S=0;S<p.length;S++){var E=p[S];y.push(parseInt(aryval(E,"int.hex"),16))}return y}catch(v){return}};(this||p).getDisplayText=function(v){var p={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"};var y={};y.type=p[v.substr(0,2)];y.str=hextorstr(F(v,0));return y};(this||p).asn1ToDisplayText=function(v){return v.utf8str!=void 0?{type:"utf8",str:v.utf8str.str}:v.ia5str!=void 0?{type:"ia5",str:v.ia5str.str}:v.visstr!=void 0?{type:"vis",str:v.visstr.str}:v.bmpstr!=void 0?{type:"bmp",str:v.bmpstr.str}:v.prnstr!=void 0?{type:"prn",str:v.prnstr.str}:void 0};(this||p).getExtPolicyMappings=function(v,p){var y=this.getCriticalExtV("policyMappings",v,p);v=y[0];p=y[1];if(v!=null){var S={extname:"policyMappings"};p&&(S.critical=true);try{var E=C(v);var F=E.seq;var B=[];for(var D=0;D<F.length;D++){var P=F[D].seq;B.push([P[0].oid,P[1].oid])}S.array=B}catch(v){throw new G("malformed policyMappings")}return S}};(this||p).getExtPolicyConstraints=function(v,p){var y=this.getCriticalExtV("policyConstraints",v,p);v=y[0];p=y[1];if(v!=null){var S={extname:"policyConstraints"};p&&(S.critical=true);var E=C(v);try{var F=E.seq;for(var B=0;B<F.length;B++){var D=F[B].tag;if(D.explicit==false){D.tag=="80"&&(S.reqexp=parseInt(D.hex,16));D.tag=="81"&&(S.inhibit=parseInt(D.hex,16))}}}catch(v){return new G("malformed policyConstraints value")}return S}};(this||p).getExtInhibitAnyPolicy=function(v,p){var y=this.getCriticalExtV("inhibitAnyPolicy",v,p);v=y[0];p=y[1];if(v!=null){var S={extname:"inhibitAnyPolicy"};p&&(S.critical=true);var E=L(v,0);if(E==-1)return new G("wrong value");S.skip=E;return S}};(this||p).getExtCRLNumber=function(v,p){var y={extname:"cRLNumber"};p&&(y.critical=true);if(v.substr(0,2)=="02"){y.num={hex:F(v,0)};return y}throw new G("hExtV parse error: "+v)};(this||p).getExtCRLReason=function(v,p){var y={extname:"cRLReason"};p&&(y.critical=true);if(v.substr(0,2)=="0a"){y.code=parseInt(F(v,0),16);return y}throw new Error("hExtV parse error: "+v)};(this||p).getExtOcspNonce=function(v,p){var y={extname:"ocspNonce"};p&&(y.critical=true);var S=F(v,0);y.hex=S;return y};(this||p).getExtOcspNoCheck=function(v,p){var y={extname:"ocspNoCheck"};p&&(y.critical=true);return y};(this||p).getExtAdobeTimeStamp=function(v,y){if(v===void 0&&y===void 0){var S=this.getExtInfo("adobeTimeStamp");if(S===void 0)return;v=B((this||p).hex,S.vidx);y=S.critical}var F={extname:"adobeTimeStamp"};y&&(F.critical=true);var C=E(v,0);if(C.length>1){var D=B(v,C[1]);var P=this.getGeneralName(D);P.uri!=void 0&&(F.uri=P.uri)}if(C.length>2){var R=B(v,C[2]);R=="0101ff"&&(F.reqauth=true);R=="010100"&&(F.reqauth=false)}return F};(this||p).getExtSubjectDirectoryAttributes=function(v,y){if(v===void 0&&y===void 0){var S=this.getExtInfo("subjectDirectoryAttributes");if(S===void 0)return;v=B((this||p).hex,S.vidx);y=S.critical}var E={extname:"subjectDirectoryAttributes"};y&&(E.critical=true);try{var F=C(v);var D=[];for(var P=0;P<F.seq.length;P++){var R=F.seq[P];var T=aryval(R,"seq.0.oid");var N=aryval(R,"seq.1.set");if(T==void 0||N==void 0)throw"error";D.push({attr:T,array:N})}E.array=D;return E}catch(v){throw new Error("malformed subjectDirectoryAttributes extension value")}};var e=function(v){var p={};try{var y=v.seq[0].oid;var S=nt.asn1.x509.OID.name2oid(y);p.type=nt.asn1.x509.OID.oid2atype(S);var E=v.seq[1];if(E.utf8str!=void 0){p.ds="utf8";p.value=E.utf8str.str}else if(E.numstr!=void 0){p.ds="num";p.value=E.numstr.str}else if(E.telstr!=void 0){p.ds="tel";p.value=E.telstr.str}else if(E.prnstr!=void 0){p.ds="prn";p.value=E.prnstr.str}else if(E.ia5str!=void 0){p.ds="ia5";p.value=E.ia5str.str}else if(E.visstr!=void 0){p.ds="vis";p.value=E.visstr.str}else{if(E.bmpstr==void 0)throw"error";p.ds="bmp";p.value=E.bmpstr.str}return p}catch(v){throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}};var i=function(v){try{return v.set.map((function(v){return e(v)}))}catch(v){throw new Error("improper ASN.1 parsed RDN: "+v)}};var h=function(v){try{return v.seq.map((function(v){return i(v)}))}catch(v){throw new Error("improper ASN.1 parsed X500Name: "+v)}};(this||p).getX500NameRule=function(v){var p="";var y="";var S=null;var E=[];for(var F=0;F<v.length;F++){var C=v[F];for(var B=0;B<C.length;B++)E.push(C[B])}for(F=0;F<E.length;F++){var D=E[F];var P=D.ds;var R=D.value;var T=D.type;p+=":"+P;if(P!="prn"&&P!="utf8"&&P!="ia5")return"mixed";if(P=="ia5"){if(T!="CN")return"mixed";if(nt.lang.String.isMail(R))continue;return"mixed"}if(T=="C"){if(P=="prn")continue;return"mixed"}y+=":"+P;if(S==null)S=P;else if(S!==P)return"mixed"}return S==null?"prn":S};(this||p).getAttrTypeAndValue=function(v){var p=C(v);return e(p)};(this||p).getRDN=function(v){var p=C(v);return i(p)};(this||p).getX500NameArray=function(v){var p=C(v);return h(p)};(this||p).getX500Name=function(v,p,y){var S=this.getX500NameArray(v);var E=this.dnarraytostr(S);var F={str:E};F.array=S;y==true&&(F.hex=v);p==true&&(F.canon=this.c14nRDNArray(S));return F};(this||p).readCertPEM=function(v){this.readCertHex(U(v))};(this||p).readCertHex=function(v){(this||p).hex=v;this.getVersion();try{N((this||p).hex,0,[0,7],"a3");this.parseExt()}catch(v){}};(this||p).getParam=function(v){var y={};v==void 0&&(v={});y.version=this.getVersion();y.serial={hex:this.getSerialNumberHex()};y.sigalg=this.getSignatureAlgorithmField();y.issuer=this.getIssuer(v.dncanon,v.dnhex);y.notbefore=this.getNotBefore();y.notafter=this.getNotAfter();y.subject=this.getSubject(v.dncanon,v.dnhex);y.sbjpubkey=hextopem(this.getPublicKeyHex(),"PUBLIC KEY");(this||p).aExtInfo!=void 0&&(this||p).aExtInfo.length>0&&(y.ext=this.getExtParamArray());y.sighex=this.getSignatureValueHex();v.tbshex==true&&(y.tbshex=R((this||p).hex,0,[0]));if(v.nodnarray==true){delete y.issuer.array;delete y.subject.array}return y};(this||p).getExtParamArray=function(v){if(v==void 0){var y=O((this||p).hex,0,[0,"[3]"]);y!=-1&&(v=T((this||p).hex,0,[0,"[3]",0],"30"))}var S=[];var F=E(v,0);for(var C=0;C<F.length;C++){var D=B(v,F[C]);var P=this.getExtParam(D);P!=null&&S.push(P)}return S};(this||p).getExtParam=function(v){var p=E(v,0);var y=p.length;if(y!=2&&y!=3)throw new Error("wrong number elements in Extension: "+y+" "+v);var S=_(D(v,0,[0],"06"));var F=false;y==3&&R(v,0,[1])=="0101ff"&&(F=true);var B=R(v,0,[y-1,0]);var P=void 0;S=="2.5.29.14"?P=this.getExtSubjectKeyIdentifier(B,F):S=="2.5.29.15"?P=this.getExtKeyUsage(B,F):S=="2.5.29.17"?P=this.getExtSubjectAltName(B,F):S=="2.5.29.18"?P=this.getExtIssuerAltName(B,F):S=="2.5.29.19"?P=this.getExtBasicConstraints(B,F):S=="2.5.29.30"?P=this.getExtNameConstraints(B,F):S=="2.5.29.31"?P=this.getExtCRLDistributionPoints(B,F):S=="2.5.29.32"?P=this.getExtCertificatePolicies(B,F):S=="2.5.29.33"?P=this.getExtPolicyMappings(B,F):S=="2.5.29.35"?P=this.getExtAuthorityKeyIdentifier(B,F):S=="2.5.29.36"?P=this.getExtPolicyConstraints(B,F):S=="2.5.29.37"?P=this.getExtExtKeyUsage(B,F):S=="2.5.29.54"?P=this.getExtInhibitAnyPolicy(B,F):S=="1.3.6.1.5.5.7.1.1"?P=this.getExtAuthorityInfoAccess(B,F):S=="2.5.29.20"?P=this.getExtCRLNumber(B,F):S=="2.5.29.21"?P=this.getExtCRLReason(B,F):S=="2.5.29.9"?P=this.getExtSubjectDirectoryAttributes(B,F):S=="1.3.6.1.5.5.7.48.1.2"?P=this.getExtOcspNonce(B,F):S=="1.3.6.1.5.5.7.48.1.5"?P=this.getExtOcspNoCheck(B,F):S=="1.2.840.113583.1.1.9.1"?P=this.getExtAdobeTimeStamp(B,F):X509.EXT_PARSER[S]!=void 0&&(P=X509.EXT_PARSER[S](S,F,B));if(P!=void 0)return P;var T={extname:S,extn:B};try{T.extn=C(B)}catch(v){}F&&(T.critical=true);return T};(this||p).findExt=function(v,p){for(var y=0;y<v.length;y++)if(v[y].extname==p)return v[y];return null};(this||p).updateExtCDPFullURI=function(v,p){var y=this.findExt(v,"cRLDistributionPoints");if(y!=null&&y.array!=void 0){var S=y.array;for(var E=0;E<S.length;E++)if(S[E].dpname!=void 0&&S[E].dpname.full!=void 0){var F=S[E].dpname.full;for(var C=0;C<F.length;C++){var B=F[E];B.uri!=void 0&&(B.uri=p)}}}};(this||p).updateExtAIAOCSP=function(v,p){var y=this.findExt(v,"authorityInfoAccess");if(y!=null&&y.array!=void 0){var S=y.array;for(var E=0;E<S.length;E++)S[E].ocsp!=void 0&&(S[E].ocsp=p)}};(this||p).updateExtAIACAIssuer=function(v,p){var y=this.findExt(v,"authorityInfoAccess");if(y!=null&&y.array!=void 0){var S=y.array;for(var E=0;E<S.length;E++)S[E].caissuer!=void 0&&(S[E].caissuer=p)}};(this||p).dnarraytostr=function(v){function z(v){return v.map((function(v){return A(v).replace(/\+/,"\\+")})).join("+")}function A(v){return v.type+"="+v.value}return"/"+v.map((function(v){return z(v).replace(/\//,"\\/")})).join("/")};(this||p).setCanonicalizedDN=function(v){var p;if(v.str!=void 0&&v.array==void 0){var y=new nt.asn1.x509.X500Name({str:v.str});var S=y.tohex();p=this.getX500NameArray(S)}else p=v.array;v.canon==void 0&&(v.canon=this.c14nRDNArray(p))};(this||p).c14nRDNArray=function(v){var p=[];for(var y=0;y<v.length;y++){var S=v[y];var E=[];for(var F=0;F<S.length;F++){var C=S[F];var B=C.value;B=B.replace(/^\s*/,"");B=B.replace(/\s*$/,"");B=B.replace(/\s+/g," ");B=B.toLowerCase();E.push(C.type.toLowerCase()+"="+B)}p.push(E.join("+"))}return"/"+p.join("/")};(this||p).getInfo=function(){var A=function(v){var p="";var y="    ";var S="\n";var E=v.array;for(var F=0;F<E.length;F++){var C=E[F];C.dn!=void 0&&(p+=y+"dn: "+C.dn.str+S);C.ip!=void 0&&(p+=y+"ip: "+C.ip+S);C.rfc822!=void 0&&(p+=y+"rfc822: "+C.rfc822+S);C.dns!=void 0&&(p+=y+"dns: "+C.dns+S);C.uri!=void 0&&(p+=y+"uri: "+C.uri+S);if(C.other!=void 0){var B=C.other.oid;var D=JSON.stringify(C.other.value).replace(/\"/g,"");p+=y+"other: "+B+"="+D+S}}p=p.replace(/\n$/,"");return p};var H=function(v){var p="";var y=v.array;for(var S=0;S<y.length;S++){var E=y[S];p+="    policy oid: "+E.policyoid+"\n";if(E.array!==void 0)for(var F=0;F<E.array.length;F++){var C=E.array[F];C.cps!==void 0&&(p+="    cps: "+C.cps+"\n")}}return p};var K=function(v){var p="";var y=v.array;for(var S=0;S<y.length;S++){var E=y[S];try{E.dpname.full[0].uri!==void 0&&(p+="    "+E.dpname.full[0].uri+"\n")}catch(v){}try{E.dname.full[0].dn.hex!==void 0&&(p+="    "+X509.hex2dn(E.dpname.full[0].dn.hex)+"\n")}catch(v){}}return p};var I=function(v){var p="";var y=v.array;for(var S=0;S<y.length;S++){var E=y[S];E.caissuer!==void 0&&(p+="    caissuer: "+E.caissuer+"\n");E.ocsp!==void 0&&(p+="    ocsp: "+E.ocsp+"\n")}return p};var v,y,S;v="Basic Fields\n";v+="  serial number: "+this.getSerialNumberHex()+"\n";v+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n";v+="  issuer: "+this.getIssuerString()+"\n";v+="  notBefore: "+this.getNotBefore()+"\n";v+="  notAfter: "+this.getNotAfter()+"\n";v+="  subject: "+this.getSubjectString()+"\n";v+="  subject public key info: \n";y=this.getPublicKey();v+="    key algorithm: "+y.type+"\n";if(y.type==="RSA"){v+="    n="+hextoposhex(y.n.toString(16)).substr(0,16)+"...\n";v+="    e="+hextoposhex(y.e.toString(16))+"\n"}S=(this||p).aExtInfo;if(S!==void 0&&S!==null){v+="X509v3 Extensions:\n";for(var E=0;E<S.length;E++){var F=S[E];var C=nt.asn1.x509.OID.oid2name(F.oid);C===""&&(C=F.oid);var B="";F.critical===true&&(B="CRITICAL");v+="  "+C+" "+B+":\n";if(C==="basicConstraints"){var D=this.getExtBasicConstraints();if(D.cA===void 0)v+="    {}\n";else{v+="    cA=true";D.pathLen!==void 0&&(v+=", pathLen="+D.pathLen);v+="\n"}}else if(C=="policyMappings"){var P=this.getExtPolicyMappings().array;var R=P.map((function(v){var p=v;return p[0]+":"+p[1]})).join(", ");v+="    "+R+"\n"}else if(C=="policyConstraints"){var T=this.getExtPolicyConstraints();v+="    ";T.reqexp!=void 0&&(v+=" reqexp="+T.reqexp);T.inhibit!=void 0&&(v+=" inhibit="+T.inhibit);v+="\n"}else if(C=="inhibitAnyPolicy"){T=this.getExtInhibitAnyPolicy();v+="    skip="+T.skip+"\n"}else if(C=="keyUsage")v+="    "+this.getExtKeyUsageString()+"\n";else if(C=="subjectKeyIdentifier")v+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if(C=="authorityKeyIdentifier"){var N=this.getExtAuthorityKeyIdentifier();N.kid!==void 0&&(v+="    kid="+N.kid.hex+"\n")}else if(C=="extKeyUsage"){var O=this.getExtExtKeyUsage().array;v+="    "+O.join(", ")+"\n"}else if(C=="subjectAltName"){var V=A(this.getExtSubjectAltName());v+=V+"\n"}else if(C=="cRLDistributionPoints"){var L=this.getExtCRLDistributionPoints();v+=K(L)}else if(C=="authorityInfoAccess"){var M=this.getExtAuthorityInfoAccess();v+=I(M)}else C=="certificatePolicies"&&(v+=H(this.getExtCertificatePolicies()))}}v+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n";v+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n";return v};typeof v=="string"&&(v.indexOf("-----BEGIN")!=-1?this.readCertPEM(v):nt.lang.String.isHex(v)&&this.readCertHex(v))}X509.EXT_PARSER={};X509.registExtParser=function(v,p){X509.EXT_PARSER[v]=p};X509.hex2dn=function(v,p){p===void 0&&(p=0);var y=new X509;it.getTLV(v,p);var S=y.getX500Name(v);return S.str};X509.hex2rdn=function(v,p){p===void 0&&(p=0);if(v.substr(p,2)!=="31")throw new Error("malformed RDN");var y=new Array;var S=it.getChildIdx(v,p);for(var E=0;E<S.length;E++)y.push(X509.hex2attrTypeValue(v,S[E]));y=y.map((function(v){return v.replace("+","\\+")}));return y.join("+")};X509.hex2attrTypeValue=function(v,p){var y=it;var S=y.getV;p===void 0&&(p=0);if(v.substr(p,2)!=="30")throw new Error("malformed attribute type and value");var E=y.getChildIdx(v,p);E.length===2&&v.substr(E[0],2)==="06"||"malformed attribute type and value";var F=S(v,E[0]);var C=nt.asn1.ASN1Util.oidHexToInt(F);var B=nt.asn1.x509.OID.oid2atype(C);var D=S(v,E[1]);var P=hextorstr(D);return B+"="+P};X509.getPublicKeyFromCertHex=function(v){var p=new X509;p.readCertHex(v);return p.getPublicKey()};X509.getPublicKeyFromCertPEM=function(v){var p=new X509;p.readCertPEM(v);return p.getPublicKey()};X509.getPublicKeyInfoPropOfCertPEM=function(v){var p=it;var y=p.getVbyList;var S={};var E,F;S.algparam=null;E=new X509;E.readCertPEM(v);F=E.getPublicKeyHex();S.keyhex=y(F,0,[1],"03").substr(2);S.algoid=y(F,0,[0,0],"06");S.algoid==="2a8648ce3d0201"&&(S.algparam=y(F,0,[0,1],"06"));return S};X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var X509CRL=function(v){var y=nt,S=y.lang.String.isHex,E=it,F=E.getV,C=E.getTLV,B=E.getVbyList,D=E.getTLVbyList,P=E.getTLVbyListEx,R=E.getIdxbyList,T=E.getIdxbyListEx,N=E.getChildIdx,O=new X509;(this||p).hex=null;(this||p).posSigAlg=null;(this||p).posRevCert=null;(this||p).parsed=null;(this||p)._setPos=function(){var v=R((this||p).hex,0,[0,0]);var y=(this||p).hex.substr(v,2);if(y=="02")(this||p).posSigAlg=1;else{if(y!="30")throw new Error("malformed 1st item of TBSCertList: "+y);(this||p).posSigAlg=0}var S=R((this||p).hex,0,[0,(this||p).posSigAlg+3]);var E=(this||p).hex.substr(S,2);if(E=="17"||E=="18"){var F,C;F=R((this||p).hex,0,[0,(this||p).posSigAlg+4]);(this||p).posRevCert=null;if(F!=-1){C=(this||p).hex.substr(F,2);C=="30"&&((this||p).posRevCert=(this||p).posSigAlg+4)}}else if(E=="30")(this||p).posRevCert=(this||p).posSigAlg+3;else{if(E!="a0")throw new Error("malformed nextUpdate or revCert tag: "+E);(this||p).posRevCert=null}};(this||p).getVersion=function(){return(this||p).posSigAlg==0?null:parseInt(B((this||p).hex,0,[0,0],"02"),16)+1};(this||p).getSignatureAlgorithmField=function(){var v=D((this||p).hex,0,[0,(this||p).posSigAlg],"30");return O.getAlgorithmIdentifierName(v)};(this||p).getIssuer=function(){return O.getX500Name(this.getIssuerHex())};(this||p).getIssuerHex=function(){return D((this||p).hex,0,[0,(this||p).posSigAlg+1],"30")};(this||p).getThisUpdate=function(){var v=B((this||p).hex,0,[0,(this||p).posSigAlg+2]);return p.result=hextorstr(v)};(this||p).getNextUpdate=function(){var v=R((this||p).hex,0,[0,(this||p).posSigAlg+3]);var y=(this||p).hex.substr(v,2);return y!="17"&&y!="18"?null:hextorstr(F((this||p).hex,v))};(this||p).getRevCertArray=function(){if((this||p).posRevCert==null)return null;var v=[];var y=R((this||p).hex,0,[0,(this||p).posRevCert]);var S=N((this||p).hex,y);for(var E=0;E<S.length;E++){var F=C((this||p).hex,S[E]);v.push(this.getRevCert(F))}return v};(this||p).getRevCert=function(v){var p={};var y=N(v,0);p.sn={hex:B(v,0,[0],"02")};p.date=hextorstr(B(v,0,[1]));y.length==3&&(p.ext=O.getExtParamArray(D(v,0,[2])));return p};(this||p).findRevCert=function(v){var p=new X509(v);var y=p.getSerialNumberHex();return this.findRevCertBySN(y)};(this||p).findRevCertBySN=function(v){(this||p).parsed==null&&this.getParam();if((this||p).parsed.revcert==null)return null;var y=(this||p).parsed.revcert;for(var S=0;S<y.length;S++)if(v==y[S].sn.hex)return y[S];return null};(this||p).getSignatureValueHex=function(){return B((this||p).hex,0,[2],"03",true)};(this||p).verifySignature=function(v){var y=this.getSignatureAlgorithmField();var S=this.getSignatureValueHex();var E=D((this||p).hex,0,[0],"30");var F=new nt.crypto.Signature({alg:y});F.init(v);F.updateHex(E);return F.verify(S)};(this||p).getParam=function(v){var y={};var S=this.getVersion();S!=null&&(y.version=S);y.sigalg=this.getSignatureAlgorithmField();y.issuer=this.getIssuer();y.thisupdate=this.getThisUpdate();var E=this.getNextUpdate();E!=null&&(y.nextupdate=E);var F=this.getRevCertArray();F!=null&&(y.revcert=F);var C=T((this||p).hex,0,[0,"[0]"]);if(C!=-1){var B=P((this||p).hex,0,[0,"[0]",0]);y.ext=O.getExtParamArray(B)}y.sighex=this.getSignatureValueHex();(this||p).parsed=y;if(typeof v=="object"){v.tbshex==true&&(y.tbshex=D((this||p).hex,0,[0]));v.nodnarray==true&&delete y.issuer.array}return y};if(typeof v=="string"){S(v)?(this||p).hex=v:v.match(/-----BEGIN X509 CRL/)&&((this||p).hex=pemtohex(v));this._setPos()}};typeof nt!="undefined"&&nt||(nt={});typeof nt.jws!="undefined"&&nt.jws||(nt.jws={});nt.jws.JWS=function(){var v=nt,y=v.jws.JWS,S=y.isSafeJSONString;(this||p).parseJWS=function(v,y){if((this||p).parsedJWS===void 0||!y&&(this||p).parsedJWS.sigvalH===void 0){var E=v.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(E==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var F=E[1];var C=E[2];var B=E[3];var D=F+"."+C;(this||p).parsedJWS={};(this||p).parsedJWS.headB64U=F;(this||p).parsedJWS.payloadB64U=C;(this||p).parsedJWS.sigvalB64U=B;(this||p).parsedJWS.si=D;if(!y){var P=b64utohex(B);var R=parseBigInt(P,16);(this||p).parsedJWS.sigvalH=P;(this||p).parsedJWS.sigvalBI=R}var T=at(F);var N=at(C);(this||p).parsedJWS.headS=T;(this||p).parsedJWS.payloadS=N;if(!S(T,(this||p).parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+T}}};nt.jws.JWS.sign=function(v,p,y,S,E){var F=nt,C=F.jws,B=C.JWS,D=B.readSafeJSONString,P=B.isSafeJSONString,R=F.crypto,T=(R.ECDSA,R.Mac),N=R.Signature,O=JSON;var V,L,M;if(typeof p!="string"&&typeof p!="object")throw"spHeader must be JSON string or object: "+p;if(typeof p=="object"){L=p;V=O.stringify(L)}if(typeof p=="string"){V=p;if(!P(V))throw"JWS Head is not safe JSON string: "+V;L=D(V)}M=y;typeof y=="object"&&(M=O.stringify(y));v!=""&&v!=null||L.alg===void 0||(v=L.alg);if(v!=""&&v!=null&&L.alg===void 0){L.alg=v;V=O.stringify(L)}if(v!==L.alg)throw"alg and sHeader.alg doesn't match: "+v+"!="+L.alg;var _=null;if(B.jwsalg2sigalg[v]===void 0)throw"unsupported alg name: "+v;_=B.jwsalg2sigalg[v];var U=st(V);var G=st(M);var X=U+"."+G;var W="";if(_.substr(0,4)=="Hmac"){if(S===void 0)throw"mac key shall be specified for HS* alg";var J=new T({alg:_,prov:"cryptojs",pass:S});J.updateString(X);W=J.doFinal()}else if(_.indexOf("withECDSA")!=-1){var $=new N({alg:_});$.init(S,E);$.updateString(X);var Y=$.sign();W=nt.crypto.ECDSA.asn1SigToConcatSig(Y)}else if(_!="none"){$=new N({alg:_});$.init(S,E);$.updateString(X);W=$.sign()}var Z=hextob64u(W);return X+"."+Z};nt.jws.JWS.verify=function(v,p,y){var S,E=nt,F=E.jws,C=F.JWS,B=C.readSafeJSONString,D=E.crypto,P=D.ECDSA,R=D.Mac,T=D.Signature;typeof RSAKey!==void 0&&(S=RSAKey);if(!isBase64URLDot(v))return false;var N=v.split(".");if(N.length!==3)return false;var O=N[0];var V=N[1];var L=O+"."+V;var M=b64utohex(N[2]);var _=B(at(N[0]));var U=null;var G=null;if(_.alg===void 0)throw"algorithm not specified in header";U=_.alg;G=U.substr(0,2);if(y!=null&&Object.prototype.toString.call(y)==="[object Array]"&&y.length>0){var X=":"+y.join(":")+":";if(X.indexOf(":"+U+":")==-1)throw"algorithm '"+U+"' not accepted in the list"}if(U!="none"&&p===null)throw"key shall be specified to verify.";typeof p=="string"&&p.indexOf("-----BEGIN ")!=-1&&(p=ot.getKey(p));if((G=="RS"||G=="PS")&&!(p instanceof S))throw"key shall be a RSAKey obj for RS* and PS* algs";if(G=="ES"&&!(p instanceof P))throw"key shall be a ECDSA obj for ES* algs";U=="none";var W=null;if(C.jwsalg2sigalg[_.alg]===void 0)throw"unsupported alg name: "+U;W=C.jwsalg2sigalg[U];if(W=="none")throw"not supported";if(W.substr(0,4)=="Hmac"){var J=null;if(p===void 0)throw"hexadecimal key shall be specified for HMAC";var $=new R({alg:W,pass:p});$.updateString(L);J=$.doFinal();return M==J}if(W.indexOf("withECDSA")!=-1){var Y=null;try{Y=P.concatSigToASN1Sig(M)}catch(v){return false}var Z=new T({alg:W});Z.init(p);Z.updateString(L);return Z.verify(Y)}Z=new T({alg:W});Z.init(p);Z.updateString(L);return Z.verify(M)};nt.jws.JWS.parse=function(v){var p=v.split(".");var y={};var S,E,F;if(p.length!=2&&p.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";S=p[0];E=p[1];p.length==3&&(F=p[2]);y.headerObj=nt.jws.JWS.readSafeJSONString(at(S));y.payloadObj=nt.jws.JWS.readSafeJSONString(at(E));y.headerPP=JSON.stringify(y.headerObj,null,"  ");y.payloadObj==null?y.payloadPP=at(E):y.payloadPP=JSON.stringify(y.payloadObj,null,"  ");F!==void 0&&(y.sigHex=b64utohex(F));return y};nt.jws.JWS.verifyJWT=function(v,p,y){var S=nt,E=S.jws,F=E.JWS,C=F.readSafeJSONString,B=F.inArray,D=F.includedArray;if(!isBase64URLDot(v))return false;var P=v.split(".");if(P.length!=3)return false;var R=P[0];var T=P[1];b64utohex(P[2]);var N=C(at(R));var O=C(at(T));if(N.alg===void 0)return false;if(y.alg===void 0)throw"acceptField.alg shall be specified";if(!B(N.alg,y.alg))return false;if(O.iss!==void 0&&typeof y.iss==="object"&&!B(O.iss,y.iss))return false;if(O.sub!==void 0&&typeof y.sub==="object"&&!B(O.sub,y.sub))return false;if(O.aud!==void 0&&typeof y.aud==="object")if(typeof O.aud=="string"){if(!B(O.aud,y.aud))return false}else if(typeof O.aud=="object"&&!D(O.aud,y.aud))return false;var V=E.IntDate.getNow();y.verifyAt!==void 0&&typeof y.verifyAt==="number"&&(V=y.verifyAt);y.gracePeriod!==void 0&&typeof y.gracePeriod==="number"||(y.gracePeriod=0);return!(O.exp!==void 0&&typeof O.exp=="number"&&O.exp+y.gracePeriod<V)&&(!(O.nbf!==void 0&&typeof O.nbf=="number"&&V<O.nbf-y.gracePeriod)&&(!(O.iat!==void 0&&typeof O.iat=="number"&&V<O.iat-y.gracePeriod)&&((O.jti===void 0||y.jti===void 0||O.jti===y.jti)&&!!F.verify(v,p,y.alg))))};nt.jws.JWS.includedArray=function(v,p){var y=nt.jws.JWS.inArray;if(v===null)return false;if(typeof v!=="object")return false;if(typeof v.length!=="number")return false;for(var S=0;S<v.length;S++)if(!y(v[S],p))return false;return true};nt.jws.JWS.inArray=function(v,p){if(p===null)return false;if(typeof p!=="object")return false;if(typeof p.length!=="number")return false;for(var y=0;y<p.length;y++)if(p[y]==v)return true;return false};nt.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"};nt.jws.JWS.isSafeJSONString=function(v,p,y){var S=null;try{S=rt(v);if(typeof S!="object")return 0;if(S.constructor===Array)return 0;p&&(p[y]=S);return 1}catch(v){return 0}};nt.jws.JWS.readSafeJSONString=function(v){var p=null;try{p=rt(v);return typeof p!="object"||p.constructor===Array?null:p}catch(v){return null}};nt.jws.JWS.getEncodedSignatureValueFromJWS=function(v){var p=v.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(p==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return p[1]};nt.jws.JWS.getJWKthumbprint=function(v){if(v.kty!=="RSA"&&v.kty!=="EC"&&v.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var p="{";if(v.kty==="RSA"){if(typeof v.n!="string"||typeof v.e!="string")throw"wrong n and e value for RSA key";p+='"e":"'+v.e+'",';p+='"kty":"'+v.kty+'",';p+='"n":"'+v.n+'"}'}else if(v.kty==="EC"){if(typeof v.crv!="string"||typeof v.x!="string"||typeof v.y!="string")throw"wrong crv, x and y value for EC key";p+='"crv":"'+v.crv+'",';p+='"kty":"'+v.kty+'",';p+='"x":"'+v.x+'",';p+='"y":"'+v.y+'"}'}else if(v.kty==="oct"){if(typeof v.k!="string")throw"wrong k value for oct(symmetric) key";p+='"kty":"'+v.kty+'",';p+='"k":"'+v.k+'"}'}var y=rstrtohex(p);var S=nt.crypto.Util.hashHex(y,"sha256");var E=hextob64u(S);return E};nt.jws.IntDate={};nt.jws.IntDate.get=function(v){var p=nt.jws.IntDate,y=p.getNow,S=p.getZulu;if(v=="now")return y();if(v=="now + 1hour")return y()+3600;if(v=="now + 1day")return y()+86400;if(v=="now + 1month")return y()+2592e3;if(v=="now + 1year")return y()+31536e3;if(v.match(/Z$/))return S(v);if(v.match(/^[0-9]+$/))return parseInt(v);throw"unsupported format: "+v};nt.jws.IntDate.getZulu=function(v){return zulutosec(v)};nt.jws.IntDate.getNow=function(){var v=~~(new Date/1e3);return v};nt.jws.IntDate.intDate2UTCString=function(v){var p=new Date(v*1e3);return p.toUTCString()};nt.jws.IntDate.intDate2Zulu=function(v){var p=new Date(v*1e3),y=("0000"+p.getUTCFullYear()).slice(-4),S=("00"+(p.getUTCMonth()+1)).slice(-2),E=("00"+p.getUTCDate()).slice(-2),F=("00"+p.getUTCHours()).slice(-2),C=("00"+p.getUTCMinutes()).slice(-2),B=("00"+p.getUTCSeconds()).slice(-2);return y+S+E+F+C+B+"Z"};typeof nt!="undefined"&&nt||(nt={});typeof nt.jws!="undefined"&&nt.jws||(nt.jws={});nt.jws.JWSJS=function(){var v=nt,y=v.jws,S=y.JWS,E=S.readSafeJSONString;(this||p).aHeader=[];(this||p).sPayload="";(this||p).aSignature=[];(this||p).init=function(){(this||p).aHeader=[];(this||p).sPayload=void 0;(this||p).aSignature=[]};(this||p).initWithJWS=function(v){this.init();var y=v.split(".");if(y.length!=3)throw"malformed input JWS";(this||p).aHeader.push(y[0]);(this||p).sPayload=y[1];(this||p).aSignature.push(y[2])};(this||p).addSignature=function(v,y,S,E){if((this||p).sPayload===void 0||(this||p).sPayload===null)throw"there's no JSON-JS signature to add.";var F=(this||p).aHeader.length;if((this||p).aHeader.length!=(this||p).aSignature.length)throw"aHeader.length != aSignature.length";try{var C=nt.jws.JWS.sign(v,y,(this||p).sPayload,S,E);var B=C.split(".");B[0];B[2];(this||p).aHeader.push(B[0]);(this||p).aSignature.push(B[2])}catch(v){(this||p).aHeader.length>F&&(this||p).aHeader.pop();(this||p).aSignature.length>F&&(this||p).aSignature.pop();throw"addSignature failed: "+v}};(this||p).verifyAll=function(v){if((this||p).aHeader.length!==v.length||(this||p).aSignature.length!==v.length)return false;for(var y=0;y<v.length;y++){var S=v[y];if(S.length!==2)return false;var E=this.verifyNth(y,S[0],S[1]);if(E===false)return false}return true};(this||p).verifyNth=function(v,y,E){if((this||p).aHeader.length<=v||(this||p).aSignature.length<=v)return false;var F=(this||p).aHeader[v];var C=(this||p).aSignature[v];var B=F+"."+(this||p).sPayload+"."+C;var D=false;try{D=S.verify(B,y,E)}catch(v){return false}return D};(this||p).readJWSJS=function(v){if(typeof v==="string"){var y=E(v);if(y==null)throw"argument is not safe JSON object string";(this||p).aHeader=y.headers;(this||p).sPayload=y.payload;(this||p).aSignature=y.signatures}else try{if(!(v.headers.length>0))throw"malformed header";(this||p).aHeader=v.headers;if(typeof v.payload!=="string")throw"malformed signatures";(this||p).sPayload=v.payload;if(!(v.signatures.length>0))throw"malformed signatures";(this||p).aSignature=v.signatures}catch(v){throw"malformed JWS-JS JSON object: "+v}};(this||p).getJSON=function(){return{headers:(this||p).aHeader,payload:(this||p).sPayload,signatures:(this||p).aSignature}};(this||p).isEmpty=function(){return(this||p).aHeader.length==0?1:0}};y.SecureRandom=SecureRandom;y.rng_seed_time=rng_seed_time;y.BigInteger=BigInteger;y.RSAKey=RSAKey;y.ECDSA=nt.crypto.ECDSA;y.DSA=nt.crypto.DSA;y.Signature=nt.crypto.Signature;y.MessageDigest=nt.crypto.MessageDigest;y.Mac=nt.crypto.Mac;y.KEYUTIL=ot;y.ASN1HEX=it;y.X509=X509;y.X509CRL=X509CRL;y.CryptoJS=D;y.b64tohex=b64tohex;y.b64toBA=b64toBA;y.ECFieldElementFp=ECFieldElementFp;y.ECPointFp=ECPointFp;y.ECCurveFp=ECCurveFp;y.stoBA=stoBA;y.BAtos=BAtos;y.BAtohex=BAtohex;y.stohex=stohex;y.stob64=stob64;y.stob64u=stob64u;y.b64utos=b64utos;y.b64tob64u=b64tob64u;y.b64utob64=b64utob64;y.hex2b64=hex2b64;y.hextob64u=hextob64u;y.b64utohex=b64utohex;y.utf8tob64u=st;y.b64utoutf8=at;y.utf8tob64=utf8tob64;y.b64toutf8=b64toutf8;y.utf8tohex=utf8tohex;y.hextoutf8=hextoutf8;y.hextorstr=hextorstr;y.rstrtohex=rstrtohex;y.hextob64=hextob64;y.hextob64nl=hextob64nl;y.b64nltohex=b64nltohex;y.hextopem=hextopem;y.pemtohex=pemtohex;y.hextoArrayBuffer=hextoArrayBuffer;y.ArrayBuffertohex=ArrayBuffertohex;y.zulutomsec=zulutomsec;y.msectozulu=msectozulu;y.zulutosec=zulutosec;y.zulutodate=zulutodate;y.datetozulu=datetozulu;y.uricmptohex=uricmptohex;y.hextouricmp=hextouricmp;y.ipv6tohex=ipv6tohex;y.hextoipv6=hextoipv6;y.hextoip=hextoip;y.iptohex=iptohex;y.ucs2hextoutf8=ucs2hextoutf8;y.encodeURIComponentAll=encodeURIComponentAll;y.newline_toUnix=newline_toUnix;y.newline_toDos=newline_toDos;y.hextoposhex=hextoposhex;y.intarystrtohex=intarystrtohex;y.strdiffidx=strdiffidx;y.oidtohex=oidtohex;y.hextooid=hextooid;y.strpad=strpad;y.bitstrtoint=bitstrtoint;y.inttobitstr=inttobitstr;y.bitstrtobinstr=bitstrtobinstr;y.binstrtobitstr=binstrtobitstr;y.isBase64URLDot=isBase64URLDot;y.namearraytobinstr=namearraytobinstr;y.extendClass=extendClass;y.foldnl=foldnl;y.b64topem=b64topem;y.pemtob64=pemtob64;y.timeogen=timetogen;y.aryval=aryval;y.inttohex=inttohex;y.twoscompl=twoscompl;y.KJUR=nt;y.crypto=nt.crypto;y.asn1=nt.asn1;y.jws=nt.jws;y.lang=nt.lang;y.VERSION=C;y.VERSION_FULL=B;const ht=y.ECDSA,ut=y.DSA,ct=y.Signature,lt=y.MessageDigest,ft=y.Mac,vt=y.timeogen,gt=y.asn1,pt=y.jws,dt=y.lang;const mt=y.SecureRandom,yt=y.rng_seed_time,xt=y.BigInteger,St=y.RSAKey,bt=y.KEYUTIL,Et=y.ASN1HEX,wt=y.X509,Ft=y.X509CRL,At=y.CryptoJS,Ct=y.b64tohex,It=y.b64toBA,Bt=y.ECFieldElementFp,Dt=y.ECPointFp,Pt=y.ECCurveFp,Rt=y.stoBA,Tt=y.BAtos,Nt=y.BAtohex,Ht=y.stohex,Ot=y.stob64,jt=y.stob64u,Vt=y.b64utos,Kt=y.b64tob64u,Lt=y.b64utob64,kt=y.hex2b64,qt=y.hextob64u,Mt=y.b64utohex,_t=y.utf8tob64u,Ut=y.b64utoutf8,zt=y.utf8tob64,Gt=y.b64toutf8,Xt=y.utf8tohex,Wt=y.hextoutf8,Jt=y.hextorstr,$t=y.rstrtohex,Yt=y.hextob64,Zt=y.hextob64nl,Qt=y.b64nltohex,te=y.hextopem,ee=y.pemtohex,re=y.hextoArrayBuffer,ie=y.ArrayBuffertohex,ne=y.zulutomsec,se=y.msectozulu,ae=y.zulutosec,oe=y.zulutodate,he=y.datetozulu,ue=y.uricmptohex,ce=y.hextouricmp,le=y.ipv6tohex,fe=y.hextoipv6,ve=y.hextoip,ge=y.iptohex,pe=y.ucs2hextoutf8,de=y.encodeURIComponentAll,me=y.newline_toUnix,ye=y.newline_toDos,xe=y.hextoposhex,Se=y.intarystrtohex,be=y.strdiffidx,Ee=y.oidtohex,we=y.hextooid,Fe=y.strpad,Ae=y.bitstrtoint,Ce=y.inttobitstr,Ie=y.bitstrtobinstr,Be=y.binstrtobitstr,De=y.isBase64URLDot,Pe=y.namearraytobinstr,Re=y.extendClass,Te=y.foldnl,Ne=y.b64topem,He=y.pemtob64,Oe=y.aryval,je=y.inttohex,Ve=y.twoscompl,Ke=y.KJUR,Le=y.crypto,ke=y.VERSION,qe=y.VERSION_FULL;export{Et as ASN1HEX,ie as ArrayBuffertohex,Nt as BAtohex,Tt as BAtos,xt as BigInteger,At as CryptoJS,ut as DSA,Pt as ECCurveFp,ht as ECDSA,Bt as ECFieldElementFp,Dt as ECPointFp,bt as KEYUTIL,Ke as KJUR,ft as Mac,lt as MessageDigest,St as RSAKey,mt as SecureRandom,ct as Signature,ke as VERSION,qe as VERSION_FULL,wt as X509,Ft as X509CRL,Oe as aryval,gt as asn1,Qt as b64nltohex,It as b64toBA,Kt as b64tob64u,Ct as b64tohex,Ne as b64topem,Gt as b64toutf8,Lt as b64utob64,Mt as b64utohex,Vt as b64utos,Ut as b64utoutf8,Be as binstrtobitstr,Ie as bitstrtobinstr,Ae as bitstrtoint,Le as crypto,he as datetozulu,y as default,de as encodeURIComponentAll,Re as extendClass,Te as foldnl,kt as hex2b64,re as hextoArrayBuffer,Yt as hextob64,Zt as hextob64nl,qt as hextob64u,ve as hextoip,fe as hextoipv6,we as hextooid,te as hextopem,xe as hextoposhex,Jt as hextorstr,ce as hextouricmp,Wt as hextoutf8,Se as intarystrtohex,Ce as inttobitstr,je as inttohex,ge as iptohex,le as ipv6tohex,De as isBase64URLDot,pt as jws,dt as lang,se as msectozulu,Pe as namearraytobinstr,ye as newline_toDos,me as newline_toUnix,Ee as oidtohex,He as pemtob64,ee as pemtohex,yt as rng_seed_time,$t as rstrtohex,Rt as stoBA,Ot as stob64,jt as stob64u,Ht as stohex,be as strdiffidx,Fe as strpad,vt as timeogen,Ve as twoscompl,pe as ucs2hextoutf8,ue as uricmptohex,zt as utf8tob64,_t as utf8tob64u,Xt as utf8tohex,oe as zulutodate,ne as zulutomsec,ae as zulutosec};

